window.__require=function t(e,n,o){function r(a,s){if(!n[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){return r(e[a][1][t]||t)},u,u.exports,t,e,n,o)}return n[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<o.length;a++)r(o[a]);return r}({AbilityConfig:[function(t,e,n){"use strict";cc._RF.push(e,"45e0fazgstH9Ij7dgwMHcUT","AbilityConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.AbilityLayerType=n.AbilityAttackType=n.AbilityRangeType=n.AbilityTargetType=n.AbilityType=void 0,function(t){t.Normal="Normal",t.Aura="Aura",t.Bullet="Bullet"}(n.AbilityType||(n.AbilityType={})),function(t){t.Player="Player",t.Guard="Guard",t.Enemy="Enemy"}(n.AbilityTargetType||(n.AbilityTargetType={})),function(t){t.Rect="Rect",t.Circle="Circle",t.Fan="Fan",t.Preset="Preset",t.None="None"}(n.AbilityRangeType||(n.AbilityRangeType={})),function(t){t.Once="Once",t.Hit="Hit"}(n.AbilityAttackType||(n.AbilityAttackType={})),function(t){t.Ground="Ground",t.Top="Top",t.Dynamic="Dynamic"}(n.AbilityLayerType||(n.AbilityLayerType={})),cc._RF.pop()},{}],Ability:[function(t,e,n){"use strict";cc._RF.push(e,"447e7xmzA5CsJl0Y1MYTcj6","Ability");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.Ability=void 0;var c=s(t("lodash")),l=s(t("../../Component/Gameplay/EntityCollector")),u=s(t("../../Component/Gameplay/EntityTag")),p=t("../../Interface/Config/AbilityConfig"),f=t("../../Module/ConfigManager"),h=s(t("../../Utils/Path")),d=s(t("../../Utils/Utils")),y=s(t("../GameDefine")),_=t("./AvatarEntity"),g=t("./BattleEntity"),v=t("../../Utils/Timer"),m=function(t){function e(e,n){var o,r,a=t.call(this,e,n)||this;if(a._prevTick=0,a._tick=0,a._isInEffect=!1,a._hurtedEnemy=new Set,a._validTargets=new Set,a._areaBuffMap=new Map,a._hurtTimes=0,a._directHurted=!1,a._timers=[],a.config=f.ConfigManager.instance.getAbilityConfig(n),a._totalDuration=a.config.duration,a.config.subAbilities){var s=function(t){var e=new v.CountdownTimer(function(){a.castSubAbility(t)},t.delay);c._timers.push(e)},c=this;try{for(var l=i(a.config.subAbilities),u=l.next();!u.done;u=l.next())s(u.value)}catch(p){o={error:p}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(o)throw o.error}}}return a}return r(e,t),e.prototype.onAvatarReady=function(){var t,n=this;this.avatar.angle=0,!this.direction&&this.target&&(this.direction=this.target.position.sub(this.owner.position)),null===(t=this.direction)||void 0===t||t.normalizeSelf();var o=null,r=this.config.range;switch(r.type){case p.AbilityRangeType.Rect:o=d.default.setBoxCollider(this.avatar,cc.size(r.width,r.height),cc.v2(0,r.height/2));break;case p.AbilityRangeType.Circle:o=d.default.setCircleCollider(this.avatar,r.radius,cc.Vec2.ZERO);break;case p.AbilityRangeType.Fan:var i=e.InitRotation-r.rangeAngle/2;o=d.default.setFanCollider(this.avatar,r.radius,i,r.rangeAngle,30,cc.Vec2.ZERO);case p.AbilityRangeType.Preset:o=d.default.getComponentInChildren(this.avatar,cc.Collider)}if(y.default.DebugAblity&&o&&d.default.drawCollider(o),o&&(o.enabled=!0,o.node.group="bullet",d.default.getOrAddComponent(o.node,u.default).entity=this,this._entityCollector=d.default.getOrAddComponent(o.node,l.default),this._entityCollector.clear(),this._entityCollector.predict=function(t){if(t instanceof g.BattleEntity){var e=t;if(e.isAlive()&&e.targetType==n.config.targetType)return!0}return!1}),this.config.rotateView){var a=d.default.directionToAngle(this.direction);this.avatar.angle=a-e.InitRotation}this.playAnim(null),this.isTeleportMove()&&this.target&&(this.position=this.target.position),this.config.layer==p.AbilityLayerType.Ground?this.avatar.zIndex=-1e4:this.config.layer==p.AbilityLayerType.Top&&(this.avatar.zIndex=1e4)},e.prototype.getAssetPath=function(){return h.default.getEntityPath(this.config.asset)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.removeAllAreaBuff()},e.prototype.isTeleportMove=function(){return this.config.moveSpeed>=99999},e.prototype.update=function(t){var e,n;if(this.avatar&&(!this._entityCollector||this._entityCollector.isCollisionValid())){if(this._prevTick=this._tick,this._tick+=t,this.config.type===p.AbilityType.Aura)this.owner&&this.owner.avatar&&(this.position=this.owner.position);else if(this.config.moveSpeed>0&&!this.isTeleportMove()){if(!this.direction)return void cc.error("[Ability] \u53ef\u79fb\u52a8\u6280\u80fd\u6ca1\u6709\u6307\u5b9a\u79fb\u52a8\u65b9\u5411, ability: "+this+", owner: "+this.owner);var o=this.position;o.addSelf(this.direction.mul(this.config.moveSpeed*t)),this.position=o}try{for(var r=i(this._timers),a=r.next();!a.done;a=r.next())a.value.step(t)}catch(s){e={error:s}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}!this._isInEffect&&this._tick>=this.config.attackDelay&&(this._isInEffect=!0),this._isInEffect&&(this.updateValidTargets(),this.config.attackType===p.AbilityAttackType.Once?this._directHurted||this.attackDirect():this.config.attackType===p.AbilityAttackType.Hit&&this.attackDirect(),this.attackDOT(),this.updateAreaBuff(),this.config.layer==p.AbilityLayerType.Dynamic&&(this.avatar.zIndex=-this._avatar.getPosition().y),this.checkDestroy())}},e.prototype.updateValidTargets=function(){var t,e;if(this._validTargets.clear(),this._entityCollector)try{for(var n=i(this._entityCollector.getEntities()),o=n.next();!o.done;o=n.next()){var r=o.value;this._validTargets.add(r)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}else this._validTargets.add(this.target)},e.prototype.attackDirect=function(){var t,e;try{for(var n=i(this._validTargets),o=n.next();!o.done;o=n.next()){var r=o.value;this._hurtedEnemy.has(r)||this.hurtEntity(r)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this._directHurted=!0},e.prototype.attackDOT=function(){var t,e;if(this.config.attackInterval>0){var n=Math.floor((this._prevTick-this.config.attackDelay)/this.config.attackInterval),o=Math.floor((this._tick-this.config.attackDelay)/this.config.attackInterval);if(o>n&&o>0)for(var r=n;r<o;++r)try{for(var a=(t=void 0,i(this._hurtedEnemy)),s=a.next();!s.done;s=a.next()){var c=s.value;this._validTargets.has(c)&&this.hurtEntity(c)}}catch(l){t={error:l}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}}},e.prototype.checkDestroy=function(){this._totalDuration>0&&this._tick>=this._totalDuration&&this._entityContext.removeAbility(this.uid),this.config.hurtTimes>0&&this._hurtTimes>=this.config.hurtTimes&&this._entityContext.removeAbility(this.uid),this.config.type===p.AbilityType.Aura&&(this.owner.isAlive()||this._entityContext.removeAbility(this.uid))},e.prototype.hurtEntity=function(t){if(!(this.config.hurtTimes>0&&this._hurtTimes>=this.config.hurtTimes)){var e=this.owner.getAttack(),n=d.default.isInRate(this.owner.getCritRate());n&&(e+=this.owner.getCritExtraDamage()),e-=t.getDefense(),t.hurt(e,this.owner,n),this._hurtTimes++,this.tryAddOnceBuff(t),this._hurtedEnemy.add(t)}},e.prototype.tryAddOnceBuff=function(t){var e=this;c.default.isEmpty(this.config.onceBuffIds)||this._hurtedEnemy.has(t)||(this._hurtedEnemy.add(t),this.config.onceBuffIds.forEach(function(n){e._context.entityManager.createBuff(n,t,e.owner)}))},e.prototype.hasAreaBuff=function(){return!c.default.isEmpty(this.config.areaBuffIds)},e.prototype.tryAddAreaBuff=function(t){var e,n;if(this.hasAreaBuff()&&!this._areaBuffMap.has(t)){var o=[];try{for(var r=i(this.config.areaBuffIds),a=r.next();!a.done;a=r.next()){var s=a.value,c=this._context.entityManager.createBuff(s,t,this.owner);c&&o.push(c.uid)}}catch(l){e={error:l}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this._areaBuffMap.set(t,o)}},e.prototype.updateAreaBuff=function(){var t,e,n,o,r=this;if(this.hasAreaBuff())if(this._entityCollector){var s=this._entityCollector.getEntities();try{for(var c=i(this._areaBuffMap),l=c.next();!l.done;l=c.next()){var u=a(l.value,2),p=u[0],f=u[1];s.has(p)||(f.forEach(function(t){r._context.entityManager.removeBuff(t)}),this._areaBuffMap.delete(p))}}catch(_){t={error:_}}finally{try{l&&!l.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}try{for(var h=i(s),d=h.next();!d.done;d=h.next()){var y=d.value;this.tryAddAreaBuff(y)}}catch(g){n={error:g}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(n)throw n.error}}}else cc.error("[Ability] \u6280\u80fd\u6ca1\u6709Collider\uff0c\u533a\u57dfBuff\u65e0\u6548\uff01")},e.prototype.removeAllAreaBuff=function(){var t,e,n=this;try{for(var o=i(this._areaBuffMap.values()),r=o.next();!r.done;r=o.next())r.value.forEach(function(t){n._context.entityManager.removeBuff(t)})}catch(a){t={error:a}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this._areaBuffMap.clear()},e.prototype.castSubAbility=function(t){this.owner.castAbility(t.id,this.target,this.position)},e.prototype.toString=function(){return"Ability: "+this.config.id+"["+this.uid+"]"},e.InitRotation=90,e}(_.AvatarEntity);n.Ability=m,cc._RF.pop()},{"../../Component/Gameplay/EntityCollector":"EntityCollector","../../Component/Gameplay/EntityTag":"EntityTag","../../Interface/Config/AbilityConfig":"AbilityConfig","../../Module/ConfigManager":"ConfigManager","../../Utils/Path":"Path","../../Utils/Timer":"Timer","../../Utils/Utils":"Utils","../GameDefine":"GameDefine","./AvatarEntity":"AvatarEntity","./BattleEntity":"BattleEntity",lodash:13}],AchievementStatus:[function(t,e,n){"use strict";cc._RF.push(e,"377c8p9LOZCEagSm3Gw9KEk","AchievementStatus"),Object.defineProperty(n,"__esModule",{value:!0}),n.AchievementStatus=void 0,function(t){t[t.New=0]="New",t[t.Finish=1]="Finish",t[t.GetReward=2]="GetReward"}(n.AchievementStatus||(n.AchievementStatus={})),cc._RF.pop()},{}],Action:[function(t,e,n){"use strict";cc._RF.push(e,"75033kg3tJHrbYe4hNpS6Tm","Action");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(n,"__esModule",{value:!0}),n.Action3=n.Action2=n.Action1=n.Action=n.CallBack=void 0;var s=function(){function t(t,e){this.dirty=!1,this.fun=t,this.thisArg=e}return t.prototype.call=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(!this.dirty){if(null!=this.thisArg)return(t=this.fun).call.apply(t,a([this.thisArg],e));this.fun.apply(this,a(e))}},t.prototype.isOriginFrom=function(t,e){return this.fun==t&&this.thisArg==e},Object.defineProperty(t.prototype,"originFun",{get:function(){return this.fun},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originThisArg",{get:function(){return this.thisArg},enumerable:!1,configurable:!0}),t}();n.CallBack=s;var c=function(){function t(){this.callBackList=[],this.callingRemNum=-1}return t.prototype.add=function(t,e){null!=t&&-1==this.getFunIndex(t,e)&&this.callBackList.push(new s(t,e))},t.prototype.remove=function(t,e){if(null!=t)if(this.callingRemNum>=0){this.callingRemNum++;var n=this.getCallBack(t,e);null!=n&&(n.dirty=!0)}else{var o=this.getFunIndex(t,e);-1!=o&&this.callBackList.splice(o,1)}},t.prototype.call=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(0!=this.callBackList.length){this.callingRemNum=0;for(var o=0;o<this.callBackList.length;o++)(t=this.callBackList[o]).call.apply(t,a(e));if(this.callingRemNum>0)for(o=0;o<this.callBackList.length;)this.callBackList[o].dirty?this.callBackList.splice(o,1):o++;this.callingRemNum=-1}},t.prototype.includes=function(t,e){return null!=t&&-1!=this.getFunIndex(t,e)},t.prototype.clear=function(){this.callBackList.length>0&&(this.callBackList.length=0)},Object.defineProperty(t.prototype,"count",{get:function(){return this.callBackList.length},enumerable:!1,configurable:!0}),t.prototype.getFunIndex=function(t,e){for(var n=0;n<this.callBackList.length;n++)if(this.callBackList[n].isOriginFrom(t,e))return n;return-1},t.prototype.getCallBack=function(t,e){for(var n=0;n<this.callBackList.length;n++)if(this.callBackList[n].isOriginFrom(t,e))return this.callBackList[n];return null},t}();n.Action=c;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.add=function(e,n){t.prototype.add.call(this,e,n)},e.prototype.remove=function(e,n){t.prototype.remove.call(this,e,n)},e.prototype.call=function(e){t.prototype.call.call(this,e)},e}(c);n.Action1=l;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.add=function(e,n){t.prototype.add.call(this,e,n)},e.prototype.remove=function(e,n){t.prototype.remove.call(this,e,n)},e.prototype.call=function(e,n){t.prototype.call.call(this,e,n)},e}(c);n.Action2=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.add=function(e,n){t.prototype.add.call(this,e,n)},e.prototype.remove=function(e,n){t.prototype.remove.call(this,e,n)},e.prototype.call=function(e,n,o){t.prototype.call.call(this,e,n,o)},e}(c);n.Action3=p,cc._RF.pop()},{}],AdData:[function(t,e,n){"use strict";cc._RF.push(e,"2e756a0UeREqZ7cWriiZTfq","AdData"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],AdSystem:[function(t,e,n){"use strict";cc._RF.push(e,"714a0rBS+BD1JDEbTURyGDY","AdSystem");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.AdSystem=void 0;var a,s,c=i(t("../../Component/View/BusyView/BusyView")),l=t("../../Enum/WatchAdStatus"),u=t("../../Module/Statistics"),p=i(t("../../Utils/Platform")),f=i(t("../../Utils/Utils")),h=i(t("../Game")),d=window.wx||window.qq||window.tt;(function(t){t[t.Bottom=0]="Bottom",t[t.Top=1]="Top"})(a||(a={})),function(t){t[t.LeftTop=0]="LeftTop",t[t.RightTop=1]="RightTop",t[t.LeftBottom=2]="LeftBottom",t[t.RightBottom=3]="RightBottom"}(s||(s={}));var y=["adunit-cb64c7519047bf9b","adunit-d9ba532529f7253a","adunit-28a93ffd22f5e0b6"],_=["d9298a9cda8267bb8c992362f3fa725b"],g=["t3rfli7j2e11521gk7"],v=function(){function t(){this._currentAdIdPlayCount=0,this._userAdData=null,this._tooFreqVideoTimes=0,this._banVideo=!1,this._banSec=0,this._insertAd=null,this._insertAdReady=!1,this.name="AdSystem"}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.init=function(){return o(this,void 0,void 0,function(){return r(this,function(){return this._videoCloseCallbacks=[],p.default.isWx()?(this.AD_UNIT_IDS=y,this.BANNER_UNIT_ID="adunit-718b1ee1ee29d4de",this.INSERT_UNIT_ID="adunit-5c469a4740b245a2"):p.default.isQQ()?(this.AD_UNIT_IDS=_,this.BANNER_UNIT_ID="b267d396b718f42e17a170fb179d5ae4",this.INSERT_UNIT_ID="f801dc59ee5188231adad844e50dee6c"):p.default.isBytedance()?(this.AD_UNIT_IDS=g,this.BANNER_UNIT_ID="422789hidi56439b7k",this.INSERT_UNIT_ID="27eb4hji0ek5jnkeef"):this.AD_UNIT_IDS=[],this.supportVideoAd()&&(this.prepareVideoAd(),this.prepareBannerAd()),this.supportInsertAd&&this.prepareInsertAd(),this._initInsertAd(),[2]})})},t.prototype._initInsertAd=function(){var t=this;this.supportInsertAd()&&cc.game.on(cc.game.EVENT_SHOW,function(){t.showInsertAd()},this)},t.prototype.logicUpdate=function(t){this._banVideo&&(this._banSec-=t,this._banSec<=0&&(this._banSec=0,this._banVideo=!1))},t.prototype.destroy=function(){this._videoAd&&(this._videoAd.destroy(),this._videoAd=null),this._bannerAd&&(this._bannerAd.destroy(),this._bannerAd=null),this._customAd&&(this._customAd.destroy(),this._customAd=null),t._instance=null},t.prototype.supportVideoAd=function(){return!!p.default.isTest()||(p.default.isMiniGame()?null!=d.createRewardedVideoAd:!!p.default.isMobile())},t.prototype.supportInsertAd=function(){return!1},t.prototype.supportBannerAd=function(){return!!p.default.isTest()||(p.default.isMiniGame()?null!=d.createBannerAd&&!p.default.isBytedance():!!p.default.isMobile())},t.prototype.supportCustomAd=function(){return!!p.default.isWx()&&null!=wx.createCustomAd},t.prototype.getVideoAdId=function(){return this.AD_UNIT_IDS[this._videoAdIdIndex]},t.prototype.prepareVideoAd=function(){var t=this;if(this.supportVideoAd())if(p.default.isTest())this._videoReady=!0;else if(p.default.isWx()||p.default.isBytedance()){this._videoAd&&(console.warn("[AdSystem] video ad already exists, id '"+this.getVideoAdId()+"', destroy it"),this._videoAd.destroy()),null==this._videoAdIdIndex?this._videoAdIdIndex=Math.floor(Math.random()*this.AD_UNIT_IDS.length):this._videoAdIdIndex=(this._videoAdIdIndex+1)%this.AD_UNIT_IDS.length;var e=this.getVideoAdId();this._currentAdIdPlayCount=0,this._videoReady=!1,this._videoAd=d.createRewardedVideoAd({adUnitId:e}),this._videoAd.onLoad(function(){t._videoReady=!0}),this._videoAd.onError(function(e){console.warn("[AdSystem] video '"+t.getVideoAdId()+"' load failed! errMsg: "+e.errMsg+", errCode: "+e.errCode)}),this._videoAd.onClose(function(e){e&&e.isEnded||void 0===e?t.dispatchVideoClose(l.WatchAdStatus.Success):t.dispatchVideoClose(l.WatchAdStatus.Cancel)})}},t.prototype.onVideoClose=function(t){this._videoCloseCallbacks.push(t)},t.prototype.dispatchVideoClose=function(t){this._videoCloseCallbacks.forEach(function(e){return e(t)}),this._videoCloseCallbacks.splice(0)},t.prototype.isVideoAdReady=function(){return p.default.isWx()||p.default.isBytedance()?this._videoReady:!!p.default.isMobile()||!!p.default.isQQ()},t.prototype.showVideoAd=function(t,e){var n=this;return void 0===e&&(e=!1),this._videoCloseCallbacks.length=0,new Promise(function(i){return o(n,void 0,void 0,function(){var n=this;return r(this,function(){return!e&&this._banVideo?(f.default.formatTimeText(1e3*this._banSec),i(l.WatchAdStatus.TooFreq),[2]):(c.default.show(),this.onVideoClose(function(o){if(c.default.hide(),o===l.WatchAdStatus.Success){u.Statistic.instance.addLog(u.LogEvent.WATCH_AD,{area:t,result:u.AD_RESULT.SUCCESS},!0);var r=h.default.instance.time();n._lastVideoTs?(r-n._lastVideoTs<15e3&&(e||n._tooFreqVideoTimes++,n._tooFreqVideoTimes>=10&&(n._banVideo=!0,n._tooFreqVideoTimes=0)),n._lastVideoTs=r):n._lastVideoTs=r}else o===l.WatchAdStatus.Cancel?u.Statistic.instance.addLog(u.LogEvent.WATCH_AD,{area:t,result:u.AD_RESULT.CANCEL},!0):o===l.WatchAdStatus.Failed&&u.Statistic.instance.addLog(u.LogEvent.WATCH_AD,{area:t,result:u.AD_RESULT.FAILED},!0);i(o)}),this.isVideoAdReady()&&(p.default.isTest()?this.dispatchVideoClose(l.WatchAdStatus.Success):p.default.isWx()||p.default.isBytedance()?this._videoAd.show().catch(function(t){console.warn("[AdSystem] showVideoAd: '"+n.getVideoAdId()+"', failed first time, retry, errMsg: "+t.errMsg+", errCode: "+t.errCode),n._videoAd.load().then(function(){return n._videoAd.show()}).catch(function(t){console.warn("[AdSystem] showVideoAd: '"+n.getVideoAdId()+"', failed second time, errMsg: "+t.errMsg+", errCode: "+t.errCode),n.dispatchVideoClose(l.WatchAdStatus.Failed),n.prepareVideoAd()})}):p.default.isMobile()||p.default.isQQ()),[2])})})})},t.prototype.prepareInsertAd=function(){var t=this;if(this.supportInsertAd()&&p.default.isMiniGame()){this._insertAd&&this._insertAd.destroy();var e=this.INSERT_UNIT_ID;if(this._insertAdReady=!1,this._insertAd=d.createInterstitialAd({adUnitId:e}),!this._insertAd)return;this._insertAd.onLoad(function(){t._insertAdReady=!0,console.log("[AdSystem] insertad load success")}),this._insertAd.onError(function(e){console.warn("[AdSystem] video '"+t.getVideoAdId()+"' load failed! errMsg: "+e.errMsg+", errCode: "+e.errCode)}),this._insertAd.onClose(function(e){e&&e.isEnded||void 0===e?t.dispatchVideoClose(l.WatchAdStatus.Success):t.dispatchVideoClose(l.WatchAdStatus.Cancel)})}},t.prototype.prepareBannerAd=function(){var t=this;if(this.supportBannerAd()&&p.default.isMiniGame()){this._bannerAd&&(this._bannerAd.hide(),this._bannerAd.destroy()),this._bannerShowing=!1,this._bannerSize=null;var e=d.getSystemInfoSync(),n=e.screenWidth,o=e.screenHeight,r=n;this._bannerAd=d.createBannerAd({adUnitId:this.BANNER_UNIT_ID,style:{left:0,top:o,width:r,height:void 0}}),this._bannerAd.onResize(function(e){t._bannerSize=e}),this._bannerAd.onLoad(function(){}),this._bannerAd.onError(function(t){t.errMsg,t.errCode})}},t.prototype.showInsertAd=function(){var t=this;if(this.isMainGuideDone())return new Promise(function(e){t.supportInsertAd()?(t._insertAdShowing&&t.prepareInsertAd(),t._insertAdShowing=!0,t._insertAd&&t._insertAd.show().then(function(){u.Statistic.instance.addLog(u.LogEvent.SHOW_INSERT_AD,{area:"area_insertAd",result:u.AD_RESULT.SUCCESS},!0),e(l.WatchAdStatus.Success)}).catch(function(){u.Statistic.instance.addLog(u.LogEvent.SHOW_INSERT_AD,{area:"area_insertAd",result:u.AD_RESULT.FAILED},!0),e(l.WatchAdStatus.Failed)})):e(l.WatchAdStatus.NotSupported)})},t.prototype.hideInsertAd=function(){this._insertAd&&(this._insertAdShowing=!1,p.default.isMiniGame()&&this.prepareInsertAd())},t.prototype.showBannerAd=function(t,e){var n=this;if(this.isMainGuideDone())return new Promise(function(t){if(n.supportBannerAd())if(n._bannerShowing&&n.prepareBannerAd(),n._bannerShowing=!0,p.default.isMiniGame()){if(e===a.Bottom){var o=d.getSystemInfoSync().screenHeight;n._bannerSize?n._bannerAd.style.top=o-n._bannerSize.height:n._bannerAd.onResize(function(t){n._bannerAd.style.top=o-t.height})}else n._bannerAd.style.top=0;n._bannerAd.show().then(function(){u.Statistic.instance.addLog(u.LogEvent.SHOW_BANNER_AD),t(l.WatchAdStatus.Success)}).catch(function(){return t(l.WatchAdStatus.Failed)})}else cc.sys.platform,cc.sys.ANDROID;else t(l.WatchAdStatus.NotSupported)})},t.prototype.isMainGuideDone=function(){return!0},t.prototype.hideBannerAd=function(){this._bannerShowing&&(this._bannerShowing=!1,p.default.isMiniGame()?this.prepareBannerAd():cc.sys.platform===cc.sys.ANDROID&&SDKBridge.getInstance().hideBannerAd())},t.prototype.showCustomAd=function(t){var e=this;return new Promise(function(n){if(e.supportCustomAd()){e.hideCustomAd();var o=30,r=50,i=wx.getSystemInfoSync(),a=i.screenWidth,c=i.screenHeight;switch(t){case s.LeftTop:o=30,r=50;break;case s.RightTop:o=a-68-30,r=50;break;case s.LeftBottom:o=30,r=c-106-50;break;case s.RightBottom:o=a-68-30,r=c-106-50}e._customAd=wx.createCustomAd({adUnitId:"adunit-e4da9a81c84b239a",adIntervals:30,style:{left:o,top:r,fixed:!1}}),e._customAd.onLoad(function(){console.log("[AdSystem] custom load success")}),e._customAd.onError(function(t){var e=t.errMsg,n=t.errCode;console.warn("[AdSystem] custom load failed! errMsg: "+e+", errCode: "+n)}),e._customAd.show().then(function(){return n(l.WatchAdStatus.Success)}).catch(function(){return n(l.WatchAdStatus.Failed)})}else n(l.WatchAdStatus.NotSupported)})},t.prototype.hideCustomAd=function(){p.default.isWx()&&this._customAd&&(this._customAd.destroy(),this._customAd=null)},t.prototype.showSplashAd=function(){cc.sys.platform===cc.sys.ANDROID&&SDKBridge.getInstance().showSplashAd(function(t,e){if(console.log("splash",t,e),0===t){var n=e.status;u.Statistic.instance.addLog(u.LogEvent.SHOW_SPLASH_AD,{status:n},!0)}})},t.prototype.showSplashIfNotFirstTime=function(){cc.sys.platform,cc.sys.ANDROID},t._instance=null,t.BannerLayoutType=a,t.CustomAdLayoutType=s,t.WatchAdStatus=l.WatchAdStatus,t}();n.AdSystem=v,cc._RF.pop()},{"../../Component/View/BusyView/BusyView":"BusyView","../../Enum/WatchAdStatus":"WatchAdStatus","../../Module/Statistics":"Statistics","../../Utils/Platform":"Platform","../../Utils/Utils":"Utils","../Game":"Game"}],AdType:[function(t,e,n){"use strict";cc._RF.push(e,"e66abjYpu5HuJkAV9BtaBp0","AdType"),Object.defineProperty(n,"__esModule",{value:!0}),n.AdType=void 0,function(t){t[t.AdStore=0]="AdStore"}(n.AdType||(n.AdType={})),cc._RF.pop()},{}],Animator:[function(t,e,n){"use strict";cc._RF.push(e,"ed283wz92BMFIZR/4Tg3G6y","Animator");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Module/FFComponent")),c=cc._decorator,l=c.ccclass,u=(c.property,c.requireComponent),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._anim=null,e._states=new Set,e._stateLoaded=new Map,e}return r(e,t),e.prototype.onLoad=function(){this.init()},e.prototype.init=function(){var t=this;this._anim||(this._anim=this.getComponent(cc.Animation),this._anim.getClips().forEach(function(e){var n=e.name;t._states.add(n),t._stateLoaded.set(n,!0)}))},e.prototype.getState=function(){return this._state},e.prototype.register=function(t,e,n){var o=this;void 0===n&&(n=!1),n&&(this._defaultState=t,this._state=t),this._states.add(t),this._stateLoaded.set(t,!1),this.loadAutoRes(e,cc.AnimationClip,function(e){o.init(),o._anim.addClip(e,t),o._stateLoaded.set(t,!0),o._state&&o._state===t&&o._tryPlay(t,o._playParams)},this)},e.prototype.play=function(t,e){return void 0===e&&(e=null),!this._anim&&this.init(),this._state=t,this._playParams=e,this._tryPlay(t,e)},e.prototype.stop=function(){this._state=null,this._playParams=null,this._anim&&this._anim.stop()},e.prototype.setSpeed=function(t,e){this._animState&&(e?this._state===e&&(this._animState.speed=t):this._animState.speed=t)},e.prototype._tryPlay=function(t,e){var n,o=this;if(this._stateLoaded.get(t))return this.init(),e&&e.reload||this._anim.pause(),this._anim.targetOff(this),this._animState=this._anim.play(t),this._animState.speed=null!==(n=null==e?void 0:e.speed)&&void 0!==n?n:1,e&&e.repeat&&(this._animState.repeatCount=e.repeat),this._anim.once(cc.Animation.EventType.FINISHED,function(){o._defaultState&&o.play(o._defaultState),e&&e.onFinish&&e.onFinish()},this),this._animState},i([l,u(cc.Animation)],e)}(s.default);n.default=p,cc._RF.pop()},{"../../Module/FFComponent":"FFComponent"}],AppUpdater:[function(t,e,n){"use strict";cc._RF.push(e,"10583s2q3xAmYlUS78vaasT","AppUpdater");var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var r=o(t("../Gameplay/GameDefine")),i=o(t("./Platform")),a=o(t("./Utils")),s=function(){function t(){}return t.checkUpdate=function(){if(i.default.isMiniGame()){var t=window.wx||window.qq||window.tt;if(console.log("[AppUpdater] support UpdateManager: "+!!t.getUpdateManager),t.getUpdateManager){var e=t.getUpdateManager();e.onCheckForUpdate(function(t){console.log("[AppUpdater] onCheckForUpdate: "+t.hasUpdate)}),e.onUpdateReady(function(){console.log("[AppUpdater] onUpdateReady"),t.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u65b0\u7248\u672c\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u662f\u5426\u91cd\u542f\u5e94\u7528\uff1f",success:function(t){console.log("[AppUpdater] onUpdateReady, confirm? "+t.confirm),t.confirm&&e.applyUpdate()}})}),e.onUpdateFailed(function(){console.log("[AppUpdater] onUpdateFailed")})}}},t.checkPackageUpdate=function(t){var e=this;if(i.default.isIOS())return console.log("ios, no new version"),void(t.onNoNeedUpdate&&t.onNoNeedUpdate());var n=new XMLHttpRequest;n.responseType="json",n.open("GET","https://island-1253189677.cos.ap-guangzhou.myqcloud.com/apks/version.json",!0),n.setRequestHeader("content-type","application/json"),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var o=n.response;if(o){var i=o.version,s=o.url;a.default.compareVersion(r.default.VERSION,i)<0?(console.log("has new version"),e.startDownloadApk(s,i),t.onNeedUpdate&&t.onNeedUpdate()):(console.log("no new version"),t.onNoNeedUpdate&&t.onNoNeedUpdate())}else console.error("res invaild")}},n.send()},t.startDownloadApk=function(t,e){t&&SDKBridge.getInstance().downloadApk({url:t,fileName:"WonderIsland_"+e+".apk",notify:!1},null)},t}();n.default=s,cc._RF.pop()},{"../Gameplay/GameDefine":"GameDefine","./Platform":"Platform","./Utils":"Utils"}],Audio:[function(t,e,n){"use strict";cc._RF.push(e,"1e35aOjGm5Iv54Fk3OYkaFq","Audio");var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var r=o(t("../Utils/Path")),i=o(t("./Loader")),a=function(){function t(){this.maxAudioInstance=4,this.audioUrl2count=cc.js.createMap(),this.musicMap={},this.stopEffects=!1}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.init=function(){},t.prototype.playEffect=function(t,e,n,o){var r=this;if(e=!!e,n="number"==typeof n?n:this.effectsVolume(),"string"==typeof t)t=this.getRealAudioPath(t,o),i.default.loadRes(t,cc.AudioClip,function(t){r.playEffect(t,e,n,o)},null);else{var a=t.nativeUrl,s=this.audioUrl2count[a]||0;if(s>=this.maxAudioInstance)return;var c=cc.audioEngine.play(t,e,n);this.audioUrl2count[a]=s+1,cc.audioEngine.setFinishCallback(c,function(){r.audioUrl2count[a]-=1})}},t.prototype.playMusic=function(t,e,n,o){var r=this;if(null==n&&(n=!0),"string"==typeof t)t=this.getRealAudioPath(t,e),i.default.loadRes(t,cc.AudioClip,function(t){var e=cc.audioEngine.playMusic(t,n);r.musicMap[e]||(r.musicMap[e]=!0),o&&cc.audioEngine.setFinishCallback(e,function(){setTimeout(function(){o()},100)})},null);else{var a=cc.audioEngine.playMusic(t,n);this.musicMap[a]||(this.musicMap[a]=!0)}},t.prototype.getRealAudioPath=function(t,e){return e||(e=r.default.AUDIO_BUNDLE),e&&(t=r.default.getBundlePath(t,e)),t},t.prototype.stopMusic=function(){for(var t in this.musicMap){var e=parseInt(t);this.musicMap[e]&&(cc.audioEngine.stop(e),this.musicMap[t]=!1)}},t.prototype.musicVolume=function(){return cc.audioEngine.getMusicVolume()},t.prototype.effectsVolume=function(){return cc.audioEngine.getEffectsVolume()},t.prototype.setMusicVolume=function(t){this.musicVolume()!=t&&cc.audioEngine.setMusicVolume(t)},t.prototype.setEffectsVolume=function(t){this.effectsVolume()!==t&&cc.audioEngine.setEffectsVolume(t)},t.prototype.pauseMusic=function(){for(var t in this.musicMap){var e=parseInt(t);this.musicMap[e]&&(cc.audioEngine.pause(e),this.musicMap[t]=!1)}},t.prototype.resumeMusic=function(){for(var t in this.musicMap){var e=parseInt(t);this.musicMap[e]||(cc.audioEngine.resume(e),this.musicMap[t]=!0)}},t.prototype.pauseEffects=function(){this.stopEffects=!0},t.prototype.resumeEffects=function(){this.stopEffects=!1},t._instance=null,t}();n.default=a,cc._RF.pop()},{"../Utils/Path":"Path","./Loader":"Loader"}],AutoDecomposeView:[function(t,e,n){"use strict";cc._RF.push(e,"4f5c1NeLEJPBb6ANYXfALmo","AutoDecomposeView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../Module/ViewHandler")),c=a(t("../Utils/Utils")),l=cc._decorator,u=l.ccclass,p=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.labelConfirm=null,e.labelCancel=null,e}return r(e,t),e.prototype.initiateView=function(){c.default.localize(this.labelTitle,"ui_decompose"),c.default.localize(this.labelConfirm,"ui_confirm"),c.default.localize(this.labelCancel,"ui_cancel")},e.prototype.onConfirm=function(){this.close()},e.prototype.onCancel=function(){this.close()},i([p(cc.Label)],e.prototype,"labelTitle",void 0),i([p(cc.Label)],e.prototype,"labelConfirm",void 0),i([p(cc.Label)],e.prototype,"labelCancel",void 0),i([u],e)}(s.default);n.default=f,cc._RF.pop()},{"../Module/ViewHandler":"ViewHandler","../Utils/Utils":"Utils"}],AutoRelease:[function(t,e,n){"use strict";cc._RF.push(e,"f36c6VWTpFCpoymRUusi9x9","AutoRelease");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefab=null,e}return r(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(t){this.prefab=t},e.prototype.onDestroy=function(){},i([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],AvatarEntity:[function(t,e,n){"use strict";cc._RF.push(e,"b06f6FyxJFLLaCbOIgyORv5","AvatarEntity");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.AvatarEntity=n.EntityAnimType=void 0;var c,l=s(t("../../Module/Loader")),u=t("../../Utils/NodePool"),p=s(t("../../Utils/Utils")),f=t("./BaseEntity");(function(t){t[t.Idle=0]="Idle",t[t.Walk=1]="Walk",t[t.Attack=2]="Attack",t[t.Death=3]="Death"})(c=n.EntityAnimType||(n.EntityAnimType={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._animSpeed=1,e._animTypeMap=new Map,e}return r(e,t),Object.defineProperty(e.prototype,"avatar",{get:function(){return this._avatar},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._avatar.getPosition(cc.v2())},set:function(t){this._avatar.setPosition(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anim",{get:function(){return this._anim},enumerable:!1,configurable:!0}),e.prototype.setInitPos=function(t){this._initPos=t},e.prototype.createAvatar=function(t){return i(this,void 0,void 0,function(){var e,n,o,r;return a(this,function(i){switch(i.label){case 0:return e=this.getAssetPath(),n=u.NodePool.instance,(o=n.getNode(e))?(this._avatar=o,[3,3]):[3,1];case 1:return[4,l.default.loadResAsync(e,cc.Prefab,null)];case 2:r=i.sent(),n.tryCreatePool(e,r),this._avatar=n.getNode(e),i.label=3;case 3:return t&&t.parent&&(this._avatar.parent=t.parent),this._initPos&&this._avatar.setPosition(this._initPos),this._anim=p.default.getComponentInChildren(this.avatar,cc.Animation),this._animState=null,this._anim&&(this._animTypeMap.clear(),this._animTypeMap.set(c.Idle,p.default.findClip(this._anim,function(t){return t.name.endsWith("_idle")})),this._animTypeMap.set(c.Walk,p.default.findClip(this._anim,function(t){return t.name.endsWith("_walk")})),this._animTypeMap.set(c.Attack,p.default.findClip(this._anim,function(t){return t.name.endsWith("_attack")})),this._animTypeMap.set(c.Death,p.default.findClip(this._anim,function(t){return t.name.endsWith("_death")}))),this.onAvatarReady(),[2]}})})},e.prototype.destroy=function(){t.prototype.destroy.call(this),null!=this._avatar&&(u.NodePool.instance.putNode(this._avatar),this._avatar=null,this._anim=null,this._animState=null)},e.prototype.setContext=function(e){var n=this;t.prototype.setContext.call(this,e),this._context.battleSpeed.onValueChange.add(function(t){n._animState&&(n._animState.speed=n._animSpeed*t)})},e.prototype.playAnim=function(t,e,n){void 0===e&&(e=1),this._anim?(this._animSpeed=e,this._animState=this._anim.play(t),this._animState&&(this._animState.speed=e*this._context.battleSpeed.value),n&&this._anim.on("finished",function(){n&&n()})):n&&n()},e.prototype.stopAnim=function(){this._anim&&(this._anim.stop(),this._animState=null)},e.prototype.playAnimByType=function(t,e,n){void 0===e&&(e=1);var o=this._animTypeMap.get(t);o?this.playAnim(o.name,e,n):n&&n()},e.prototype.getClipByType=function(t){return this._animTypeMap.get(t)},e}(f.BaseEntity);n.AvatarEntity=h,cc._RF.pop()},{"../../Module/Loader":"Loader","../../Utils/NodePool":"NodePool","../../Utils/Utils":"Utils","./BaseEntity":"BaseEntity"}],BagCompareView:[function(t,e,n){"use strict";cc._RF.push(e,"a5e04d4s5tKf4aJbv/X/v94","BagCompareView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../Gameplay/System/WeaponSystem"),c=t("../Module/ConfigManager"),l=a(t("../Module/ViewHandler")),u=a(t("../Utils/Path")),p=a(t("../Utils/Utils")),f=cc._decorator,h=f.ccclass,d=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.labelConfirm=null,e.labelDecompose=null,e.labelOriGemName=null,e.labelNewGemName=null,e.newGemSp=null,e.oldGemSp=null,e.newGemLightSp=null,e.oldGemLightSp=null,e.labelNode=null,e.oldEntryNode=null,e.newEntryNode=null,e.labelNewScore=null,e.labelOldScore=null,e._callback=null,e._partIndex=null,e._newGem=null,e._oldGem=null,e}return r(e,t),e.prototype.initiateView=function(t){this._callback=t.cb,this._partIndex=t.gemData.index,this._newGem=t.gemData,this._oldGem=s.WeaponSystem.instance.getSlots()[this._partIndex].gem;var e=p.default.replaceStr("ui_slotIndex",this._newGem.index+1),n=c.ConfigManager.instance.getLanConfig("ui_gemQuality_"+this._newGem.quality);this.labelTitle.string=n+e,p.default.localize(this.labelConfirm,"ui_replace"),p.default.localize(this.labelDecompose,"ui_decompose"),p.default.localize(this.labelNewGemName,"gem_"+this._partIndex+"_name"),p.default.localize(this.labelOriGemName,"gem_"+this._partIndex+"_name"),this.labelNewScore.string=p.default.replaceStr("ui_score",this._newGem.score),this.labelOldScore.string=p.default.replaceStr("ui_score",this._oldGem.score);var o=u.default.getItemLightPath(this._newGem.quality),r=u.default.getItemLightPath(this._oldGem.quality);p.default.loadImg(this.newGemLightSp,o,200),p.default.loadImg(this.oldGemLightSp,r,200);var i=u.default.getGemPath(this._newGem.id),a=u.default.getGemPath(this._oldGem.id);p.default.loadImg(this.newGemSp,i,80),p.default.loadImg(this.oldGemSp,a,80),this.initLabelNodes()},e.prototype.initLabelNodes=function(){this.oldEntryNode.removeAllChildren(),this.newEntryNode.removeAllChildren();for(var t=function(t,e){t.getChildByName("labelContent").getComponent(cc.Label).string=p.default.getEntryInfoDesc(e),t.getChildByName("labelStar").getComponent(cc.Label).string=p.default.replaceStr("ui_entry",e.quality);var n=t.getChildByName("labelProgress").getComponent(cc.Label),o=Math.round(100*e.progress);n.node.color=p.default.getLabelColor(o),n.string=o+"%"},e=0;e<this._oldGem.entryInfo.length;e++){var n=this._oldGem.entryInfo[e];(o=cc.instantiate(this.labelNode)).parent=this.oldEntryNode,t(o,n)}for(e=0;e<this._newGem.entryInfo.length;e++){var o;n=this._newGem.entryInfo[e],(o=cc.instantiate(this.labelNode)).parent=this.newEntryNode,t(o,n)}},e.prototype.onConfirm=function(){this.close(),this._callback&&this._callback(!0)},e.prototype.onDecompose=function(){this.close(),this._callback&&this._callback(!1)},e.prototype.onClose=function(){this.close()},i([d(cc.Label)],e.prototype,"labelTitle",void 0),i([d(cc.Label)],e.prototype,"labelConfirm",void 0),i([d(cc.Label)],e.prototype,"labelDecompose",void 0),i([d(cc.Label)],e.prototype,"labelOriGemName",void 0),i([d(cc.Label)],e.prototype,"labelNewGemName",void 0),i([d(cc.Sprite)],e.prototype,"newGemSp",void 0),i([d(cc.Sprite)],e.prototype,"oldGemSp",void 0),i([d(cc.Sprite)],e.prototype,"newGemLightSp",void 0),i([d(cc.Sprite)],e.prototype,"oldGemLightSp",void 0),i([d(cc.Prefab)],e.prototype,"labelNode",void 0),i([d(cc.Node)],e.prototype,"oldEntryNode",void 0),i([d(cc.Node)],e.prototype,"newEntryNode",void 0),i([d(cc.Label)],e.prototype,"labelNewScore",void 0),i([d(cc.Label)],e.prototype,"labelOldScore",void 0),i([h],e)}(l.default);n.default=y,cc._RF.pop()},{"../Gameplay/System/WeaponSystem":"WeaponSystem","../Module/ConfigManager":"ConfigManager","../Module/ViewHandler":"ViewHandler","../Utils/Path":"Path","../Utils/Utils":"Utils"}],BagData:[function(t,e,n){"use strict";cc._RF.push(e,"b9ff8vwDqxFtJoJgtXMSy2b","BagData"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],BagSystem:[function(t,e,n){"use strict";cc._RF.push(e,"fe8813fX39D86IoBJ+ddCHw","BagSystem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.BagSystem=void 0;var l=t("../../Enum/ItemType"),u=c(t("../../Module/Database/Db")),p=c(t("../../Module/ViewModule")),f=t("./Common/DataSaver"),h=t("./WeaponSystem"),d=c(t("lodash")),y={ItemChanged:"ItemChanged",GemChanged:"GemChanged",UseGem:"UseGem",UpdateBagSlots:"UpdateBagSlots"},_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="BagSystem",e._saver=new f.DataSaver,e}return r(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.init=function(){return i(this,void 0,void 0,function(){return a(this,function(){return this._data=u.default.instance.getData("bag"),this._data||(this._data={version:1,magic:1,gemCapacity:100,itemCapacity:100,items:{},gems:[]},this.setDirty()),this._saver.init("bag",this._data),[2]})})},e.prototype.setDirty=function(){this._saver.setDirty()},e.prototype.destroy=function(){this._saver.save()},e.prototype.logicUpdate=function(){},e.prototype.getItemCount=function(t){var e=this._data.items[t];return e?e.count:0},e.prototype.setItemCount=function(t,e,n){var o=this._data.items[t];o?o.count=n:this._data.items[t]={count:n},this.setDirty(),this.emit(y.ItemChanged,t,e,n)},e.prototype.addItemCount=function(t,e){var n=this.getItemCount(t),o=Math.max(0,n+e),r=e;this.setItemCount(t,r,o)},e.prototype.isGemCapacityEnough=function(t){var e=this._data.gems;return!(this._data.gemCapacity<e.length+t)},e.prototype.addGem=function(t,e){this._data.gems.push(e),this.emit(y.GemChanged),this.setDirty()},e.prototype.sellGem=function(t){var e,n,o=t,r=this._data.gems,i=0,a=function(t){var e=d.default.findIndex(r,function(e){return e.tag==t.tag});e>=0&&(i+=Math.floor(t.score/10),r.splice(e,1))};try{for(var c=s(o),u=c.next();!u.done;u=c.next())a(u.value)}catch(p){e={error:p}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}this.addItemCount(l.ItemType.Coin,i),this.emit(y.GemChanged),this.setDirty()},e.prototype.useGem=function(t,e){for(var n=this._data.gems,o=null,r=0;r<n.length;r++)if(n[r].tag==t){o=n.splice(r,1);break}this.setDirty();var i=h.WeaponSystem.instance.getSlots()[e];this.addGem(1,i.gem),i.gem=o[0],h.WeaponSystem.instance.setSlotData(i),this.emit(y.UpdateBagSlots)},e.prototype.getGems=function(){return this._data.gems},e.prototype.getItem=function(t){return this._data.items[t]},e.prototype.isItemEnough=function(t,e){return this.getItemCount(t)>=e},e.prototype.showConditionView=function(t,e,n){var o=this;p.default.instance.pushView("ConditionView",{conditions:t,contentKey:e,cb:function(e,r){if(e){for(var i=0;i<t.length;i++){var a=t[i];o.addItemCount(a.id,-a.count)}n&&n(!0)}else r&&p.default.instance.toast(r),n&&n(!1)}})},e._instance=null,e.Events=y,e}(cc.EventTarget);n.BagSystem=_,cc._RF.pop()},{"../../Enum/ItemType":"ItemType","../../Module/Database/Db":"Db","../../Module/ViewModule":"ViewModule","./Common/DataSaver":"DataSaver","./WeaponSystem":"WeaponSystem",lodash:13}],BagView:[function(t,e,n){"use strict";cc._RF.push(e,"1bba3sfegVC8bs28YtKTJbn","BagView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.BagTabType=void 0;var p,f=u(t("../../Component/Utils/TableView/TableView")),h=u(t("../../Enum/ViewType")),d=t("../../Gameplay/System/BagSystem"),y=t("../../Gameplay/System/WeaponSystem"),_=t("../../Interface/SaveData/WeaponData"),g=t("../../Module/ConfigManager"),v=u(t("../../Module/Loader")),m=u(t("../../Module/ViewHandler")),b=u(t("../../Module/ViewModule")),w=u(t("../../Utils/Path")),S=u(t("../../Utils/Utils")),C=u(t("lodash")),A=cc._decorator,M=A.ccclass,P=A.property;(function(t){t[t.Gem=1]="Gem",t[t.Weapon=2]="Weapon"})(p=n.BagTabType||(n.BagTabType={}));var E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewType=h.default.BaseView,e.labelBtnGem=null,e.labelBtnWeapon=null,e.labelNoGem=null,e.gemView=null,e.weaponView=null,e.btnGemNode=null,e.btnWeaponNode=null,e.slotRoot=null,e.weaponRoot=null,e.weaponInfoNode=null,e.labelWeapomName=null,e.labelSkillName=null,e.labelSkillDesc=null,e.labelCd=null,e.labelEquipt=null,e.labelRandomGem=null,e.labelAttack=null,e.labelAttackRange=null,e.labelAttackSpeed=null,e.labelMoveSpeed=null,e.labelCrit=null,e.labelCritDamage=null,e.lightBg=null,e._curTabType=null,e._viewNodeMap=new Map,e._btnNodeMap=new Map,e._selectWeaponId=null,e.selectSlot=null,e.selectSlotNode=null,e}return r(e,t),e.prototype.initiateView=function(t){var e=this;S.default.localize(this.labelBtnWeapon,"ui_weapon"),S.default.localize(this.labelBtnGem,"ui_gem"),S.default.localize(this.labelNoGem,"warn_noGem"),S.default.localize(this.labelEquipt,"ui_equip"),S.default.localize(this.labelRandomGem,"ui_randomGem"),this._viewNodeMap.set(p.Gem,this.gemView.node),this._viewNodeMap.set(p.Weapon,this.weaponView.node),this._btnNodeMap.set(p.Gem,this.btnGemNode),this._btnNodeMap.set(p.Weapon,this.btnWeaponNode),this.gemView.setLinesData(this._handleGemData()),this.weaponView.setLinesData(this._handleWeaponData()),this.initShowBox(p.Weapon),this.initSlotData(),this.onTab(null,t),y.WeaponSystem.instance.targetOff(this),y.WeaponSystem.instance.on(y.WeaponSystem.Events.UpdateSlot,function(){e.initSlotData()},this),d.BagSystem.instance.targetOff(this),d.BagSystem.instance.on(d.BagSystem.Events.GemChanged,function(){e.gemView.setLinesData(e._handleGemData())},this),d.BagSystem.instance.on(d.BagSystem.Events.UpdateBagSlots,function(){e.initSlotData()},this)},e.prototype.initShowBox=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a,c,l,u;return s(this,function(s){switch(s.label){case 0:return t==p.Weapon&&(this.weaponRoot.removeAllChildren(),this._selectWeaponId||(this._selectWeaponId=y.WeaponSystem.instance.getCurWeaponId()),e=w.default.getWeapon(this._selectWeaponId),n=this.weaponRoot,o=g.ConfigManager.instance.getWeaponConfig(this._selectWeaponId),r=o.guardId,i=g.ConfigManager.instance.getGuardConfig(r),S.default.localize(this.labelWeapomName,"weapon_"+this._selectWeaponId+"_name"),S.default.localize(this.labelSkillName,"ability_"+o.ability+"_name"),S.default.localize(this.labelSkillDesc,"ability_"+o.ability+"_desc"),a=w.default.getItemLightPath(o.quality),S.default.loadImg(this.lightBg,a),this.labelCd.string="\u51b7\u5374:10\u79d2",this.labelAttack.string=""+i.attack,this.labelAttackRange.string=""+i.attackDistance,this.labelAttackSpeed.string=""+i.attackSpeed,this.labelMoveSpeed.string=""+i.moveSpeed,this.labelCrit.string=100*i.crit+"%",this.labelCritDamage.string=100*i.critDamage+"%"),[4,v.default.loadResAsync(e,cc.Prefab,null)];case 1:return c=s.sent(),(l=cc.instantiate(c)).parent=n,t==p.Weapon&&(l.position.y=0,l.stopAllActions(),u=cc.tween(l).by(1,{y:20}).by(1,{y:-20}).start(),cc.tween(l).repeatForever(u).start()),[2]}})})},e.prototype.initSlotData=function(){var t=y.WeaponSystem.instance.getSlots(),e=function(e){var o=t[e],r="slot"+o.index,i=n.slotRoot.getChildByName(r),a=i.getComponent(cc.Button);a.node.targetOff(n);var s=i.getChildByName("img_lock"),c=i.getChildByName("focus");c.active=!1;var l=i.getChildByName("img").getComponent(cc.Sprite),u=i.getChildByName("light").getComponent(cc.Sprite);if(o.status==_.ISlotStatus.Unlock){if(s.active=!1,o.gem){var p=w.default.getGemPath(o.gem.id);S.default.loadImg(l,p,40);var f=w.default.getItemLightPath(o.gem.quality);S.default.loadImg(u,f,110),c.active=!0,a.node.on("click",function(){b.default.instance.pushView("WashEntryView",{gem:o.gem,cb:function(t,e,n){t?y.WeaponSystem.instance.updateGemEntry(e,n):b.default.instance.toast("toast_user_cancel")}})},n)}}else s.active=!0,a.node.on("click",function(){b.default.instance.toast("toast_lock")},n)},n=this;for(var o in t)e(o)},e.prototype.onAnimateFinish=function(){},e.prototype._handleWeaponData=function(){var t=g.ConfigManager.instance.getConfig("Weapon"),e=y.WeaponSystem.instance.getAllWeapon(),n=[],o=[];for(var r in t){var i=t[r],a={id:i.id,quality:i.quality,isUnlock:!1,manager:this};if(e[i.id]){var s=e[i.id];a.isUnlock=s.status!=_.IWeaponStatus.Lock}o.push(a)}return o.sort(function(t,e){return t.quality-e.quality}),n.push({data:o}),n},e.prototype._handleGemData=function(){this.labelNoGem.node.active=d.BagSystem.instance.getGems().length<=0;for(var t=d.BagSystem.instance.getGems(),e=[],n=[],o=0;o<t.length;o++)n.push(t[o]);return n=C.default.orderBy(n,["index","score"],["asc","desc"]),e.push({data:n}),e},e.prototype.onTab=function(t,e){var n,o,r,i;if(this._curTabType!=e){this._curTabType=e;try{for(var a=c(this._viewNodeMap),s=a.next();!s.done;s=a.next()){var u=l(s.value,2),p=u[0];(d=u[1]).active=p==e}}catch(v){n={error:v}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}try{for(var f=c(this._btnNodeMap),h=f.next();!h.done;h=f.next()){var d,y=l(h.value,2),_=(p=y[0],(d=y[1]).getChildByName("off")),g=d.getChildByName("on");g.active=p==e,_.active=!g.active}}catch(m){r={error:m}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}},e.prototype.onChangeSelectId=function(t){this._selectWeaponId=t.id,this.initShowBox(p.Weapon)},e.prototype.onEquipt=function(){y.WeaponSystem.instance.EquiptWeapon(this._selectWeaponId)},e.prototype.onRandomGem=function(){var t=this;y.WeaponSystem.instance.randomGem(function(e){var n=e.index,o=e.gem,r=y.WeaponSystem.instance.getSlots()[n];if(r.gem){var i=r.gem,a=o;y.WeaponSystem.instance.compareTwoGems(i,a),b.default.instance.pushView("CompareView",{info:{oldGem:i,newGem:a},index:n,cb:function(e){e&&(r.gem=o,y.WeaponSystem.instance.setSlotData(r),t.initSlotData(),d.BagSystem.instance.addGem(1,i))}})}else r.gem=o,y.WeaponSystem.instance.setSlotData(r),t.initSlotData()})},e.prototype._closeTableViews=function(){this.weaponView.clear(),this.gemView.clear()},e.prototype.onClose=function(){this._closeTableViews(),b.default.instance.popView(this)},i([P(cc.Label)],e.prototype,"labelBtnGem",void 0),i([P(cc.Label)],e.prototype,"labelBtnWeapon",void 0),i([P(cc.Label)],e.prototype,"labelNoGem",void 0),i([P(f.default)],e.prototype,"gemView",void 0),i([P(f.default)],e.prototype,"weaponView",void 0),i([P(cc.Node)],e.prototype,"btnGemNode",void 0),i([P(cc.Node)],e.prototype,"btnWeaponNode",void 0),i([P(cc.Node)],e.prototype,"slotRoot",void 0),i([P(cc.Node)],e.prototype,"weaponRoot",void 0),i([P(cc.Node)],e.prototype,"weaponInfoNode",void 0),i([P(cc.Label)],e.prototype,"labelWeapomName",void 0),i([P(cc.Label)],e.prototype,"labelSkillName",void 0),i([P(cc.Label)],e.prototype,"labelSkillDesc",void 0),i([P(cc.Label)],e.prototype,"labelCd",void 0),i([P(cc.Label)],e.prototype,"labelEquipt",void 0),i([P(cc.Label)],e.prototype,"labelRandomGem",void 0),i([P(cc.Label)],e.prototype,"labelAttack",void 0),i([P(cc.Label)],e.prototype,"labelAttackRange",void 0),i([P(cc.Label)],e.prototype,"labelAttackSpeed",void 0),i([P(cc.Label)],e.prototype,"labelMoveSpeed",void 0),i([P(cc.Label)],e.prototype,"labelCrit",void 0),i([P(cc.Label)],e.prototype,"labelCritDamage",void 0),i([P(cc.Sprite)],e.prototype,"lightBg",void 0),i([M],e)}(m.default);n.default=E,cc._RF.pop()},{"../../Component/Utils/TableView/TableView":"TableView","../../Enum/ViewType":"ViewType","../../Gameplay/System/BagSystem":"BagSystem","../../Gameplay/System/WeaponSystem":"WeaponSystem","../../Interface/SaveData/WeaponData":"WeaponData","../../Module/ConfigManager":"ConfigManager","../../Module/Loader":"Loader","../../Module/ViewHandler":"ViewHandler","../../Module/ViewModule":"ViewModule","../../Utils/Path":"Path","../../Utils/Utils":"Utils",lodash:13}],BaseEntity:[function(t,e,n){"use strict";cc._RF.push(e,"a7d56TwhqxPZZEwLIpp0ZKp","BaseEntity");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0}),n.BaseEntity=void 0;var i=function(t){function e(e,n){var o=t.call(this)||this;return o.uid=e,o.id=n,o}return r(e,t),e.prototype.destroy=function(){},e.prototype.setContext=function(t){this._context=t,this._entityContext=t.entityManager},e}(cc.EventTarget);n.BaseEntity=i,cc._RF.pop()},{}],BaseSystem:[function(t,e,n){"use strict";cc._RF.push(e,"45fd9d1EhtJZqiy+D6TwR6T","BaseSystem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0}),n.BaseSystem=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.createInitData=function(t,e){return void 0===e&&(e=1),t.version=e,t.magic=1,t},e}(cc.EventTarget);n.BaseSystem=i,cc._RF.pop()},{}],BattleData:[function(t,e,n){"use strict";cc._RF.push(e,"c0a30UQTc5LPIDIfrq1srdv","BattleData"),Object.defineProperty(n,"__esModule",{value:!0}),n.IEnemyStatus=void 0,function(t){t[t.Lock=0]="Lock",t[t.Unlock=1]="Unlock"}(n.IEnemyStatus||(n.IEnemyStatus={})),cc._RF.pop()},{}],BattleEndView:[function(t,e,n){"use strict";cc._RF.push(e,"3255fysJppGGpyIfnMkJ0fS","BattleEndView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../Module/ConfigManager"),u=c(t("../Utils/Path")),p=c(t("../Utils/Utils")),f=c(t("../Module/ViewHandler")),h=c(t("../Module/Loader")),d=c(t("../Gameplay/GameDefine")),y=cc._decorator,_=y.ccclass,g=y.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.labelTime=null,e.labelAbilityDmg=null,e.labelScore=null,e.rewardNodes=null,e.perfectNode=null,e.rewardNode=null,e.dpsNodes=null,e.dpsNode=null,e._callback=null,e._guards=null,e._rewards=null,e}return r(e,t),e.prototype.initiateView=function(t){var e=t.battleResult,n=t.progress,o=t.cb;this.perfectNode.active=e.isPerfect&&n>=1,this._callback=o,this._guards=e.damageStats,this._rewards=e.rewards;var r=0;this._guards[d.default.PlayerId]&&(r=this._guards[d.default.PlayerId].damage);var i,a=e.timeSec;i=a>60?p.default.formatMinutesText(1e3*a):a+l.ConfigManager.instance.getLanConfig("ui_second"),this.labelTime.string=p.default.replaceStr("ui_battleTime",i),this.labelScore.string=p.default.replaceStr("ui_battleScore",e.score),this.labelAbilityDmg.string=p.default.replaceStr("ui_abilityDmg",r);var s=1==e.success?"ui_success":"ui_failed";p.default.localize(this.labelTitle,s),this.initGuardNode(),this.initRewardNode()},e.prototype.createGuard=function(t,e){return a(this,void 0,void 0,function(){var n,o,r;return s(this,function(i){switch(i.label){case 0:return n=l.ConfigManager.instance.getGuardConfig(e),o=u.default.getEntityPath(n.asset),[4,h.default.loadResAsync(o,cc.Prefab,null)];case 1:return r=i.sent(),cc.instantiate(r).parent=t,[2]}})})},e.prototype.initGuardNode=function(){this.dpsNodes.removeAllChildren();for(var t=Math.min(3,this._guards.length),e=0;e<t;e++){var n=this._guards[e].id;if(n!=d.default.PlayerId){var o=cc.instantiate(this.dpsNode);o.parent=this.dpsNodes;var r="guard_"+n+"_name";o.getChildByName("labelName").getComponent(cc.Label).string=l.ConfigManager.instance.getLanConfig(r),o.getChildByName("labelDps").getComponent(cc.Label).string=""+this._guards[e].damage;var i=o.getChildByName("animNode");this.createGuard(i,n)}}},e.prototype.initRewardNode=function(){this.rewardNodes.removeAllChildren();for(var t=0;t<this._rewards.length;t++){var e=this._rewards[t],n=cc.instantiate(this.rewardNode);n.parent=this.rewardNodes,n.getChildByName("labelNum").getComponent(cc.Label).string=""+e.count;var o=n.getChildByName("img").getComponent(cc.Sprite),r=n.getChildByName("imgOutline").getComponent(cc.Sprite),i=u.default.getItemPath(e.id),a=u.default.getItemOutlinePath(e.quality);p.default.loadImg(o,i,80),p.default.loadImg(r,a,100)}},e.prototype.onConfirm=function(){this.close(),this._callback()},i([g(cc.Label)],e.prototype,"labelTitle",void 0),i([g(cc.Label)],e.prototype,"labelTime",void 0),i([g(cc.Label)],e.prototype,"labelAbilityDmg",void 0),i([g(cc.Label)],e.prototype,"labelScore",void 0),i([g(cc.Node)],e.prototype,"rewardNodes",void 0),i([g(cc.Node)],e.prototype,"perfectNode",void 0),i([g(cc.Prefab)],e.prototype,"rewardNode",void 0),i([g(cc.Node)],e.prototype,"dpsNodes",void 0),i([g(cc.Prefab)],e.prototype,"dpsNode",void 0),i([_],e)}(f.default);n.default=v,cc._RF.pop()},{"../Gameplay/GameDefine":"GameDefine","../Module/ConfigManager":"ConfigManager","../Module/Loader":"Loader","../Module/ViewHandler":"ViewHandler","../Utils/Path":"Path","../Utils/Utils":"Utils"}],BattleEntity:[function(t,e,n){"use strict";cc._RF.push(e,"0702brx3opNz7kdDwqs4oWN","BattleEntity");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.BattleEntity=n.PropertyContainer=void 0;var a=i(t("../../Utils/Utils")),s=t("./AvatarEntity"),c=t("./BattleProperty"),l=t("../Common/BattleHelper"),u=t("../../Interface/Config/AbilityConfig"),p=t("../../Module/ConfigManager"),f=i(t("../GameDefine")),h=function(){this.hp=0,this.maxHp=new c.BattleProperty(0,!0),this.attack=new c.BattleProperty(0,!0),this.attackSpeed=new c.BattleProperty(100),this.attackDistance=new c.BattleProperty(0),this.hurt=new c.BattleProperty(0),this.defense=new c.BattleProperty(0,!0),this.moveSpeed=new c.BattleProperty(0),this.bulletNum=new c.BattleProperty(0,!0),this.critRate=new c.BattleProperty(0),this.critDamage=new c.BattleProperty(1.5)};n.PropertyContainer=h;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._prop=new h,e._buffs=[],e.followers=new Set,e._attackCd=0,e}return r(e,t),Object.defineProperty(e.prototype,"prop",{get:function(){return this._prop},enumerable:!1,configurable:!0}),e.prototype.getHp=function(){return this._prop.hp},e.prototype.getMaxHp=function(){return this._prop.maxHp.get()},e.prototype.getAttack=function(){return this._prop.attack.get()},e.prototype.getAttackSpeed=function(){return this._prop.attackSpeed.get()},e.prototype.getAttackInterval=function(){return 1/(1/this.getRawAttackCd()*(this.getAttackSpeed()/100))},e.prototype.getAttackDistance=function(){return this._prop.attackDistance.get()},e.prototype.getDefense=function(){return this._prop.defense.get()},e.prototype.getMoveSpeed=function(){return this._prop.moveSpeed.get()},e.prototype.getCritRate=function(){return this._prop.critRate.get()},e.prototype.getCritDamage=function(){return this._prop.critDamage.get()},e.prototype.getCritExtraDamage=function(){var t=this._prop.attack;return(t.getInit()+t.getBase())*Math.max(0,this._prop.critDamage.get()-1)},e.prototype.addBuff=function(t){if(t.config.stack>0){var e=this._buffs.filter(function(e){return e.config.type==t.config.type});if(e.length>=t.config.stack){var n=e[0];cc.log("[BattleEntity] buff stack overflow, buff: "+t.id+", target: "+this),this._entityContext.removeBuff(n.uid)}}return t.target=this,this._buffs.push(t),!0},e.prototype.removeBuff=function(t){t.target=null,a.default.arrayRemove(this._buffs,t)},e.prototype.hasBuff=function(t){return this._buffs.some(function(e){return e.config.type===t})},e.prototype.isAlive=function(){return this.prop.hp>0},e.prototype.setTarget=function(t){this.target!==t&&(this.target&&(this.target.followers.delete(this),this.target=null),this.target=t,this.target&&this.target.followers.add(this))},e.prototype.canAttack=function(){return this._attackCd<=0},e.prototype.onAttackOnce=function(){this._attackCd+=this.getAttackInterval()},e.prototype.getCurrentAttackCd=function(){return Math.max(0,this._attackCd)},e.prototype.castAbility=function(t,e,n){var o,r,i=p.ConfigManager.instance.getAbilityConfig(t);null==e&&(e=this.findTarget(i.targetType));var a=n||this.position;if(i.type===u.AbilityType.Bullet){var s=(null===(o=i.typeParam)||void 0===o?void 0:o.count)||1;s+=this.prop.bulletNum.get();var c=(null===(r=i.typeParam)||void 0===r?void 0:r.angle)||f.default.DefaultScatterAngle;if(1===s)return void this.castAbilityOnce(t,a,null,e);var l=e.position.sub(a);l.normalizeSelf(),this.castAbilityOnce(t,a,null,e);for(var h=s-1,d=Math.ceil((s-1)/2),y=Math.random()<.5?-1:1,_=1;_<=d&&h>0;++_){var g=_*y*c,v=l.rotate(cc.misc.degreesToRadians(g));this.castAbilityOnce(t,a,v,null),--h>0&&(g=_*-y*c,v=l.rotate(cc.misc.degreesToRadians(g)),this.castAbilityOnce(t,a,v,null),h--)}}else this.castAbilityOnce(t,a,null,e)},e.prototype.castAbilityOnce=function(t,e,n,o){var r=this._entityContext.createAbility(t,{pos:e});return r.owner=this,r.target=o,r.direction=n,r.createAvatar({parent:this._context.terrain.node}),r},e.prototype.getNeareastEntity=function(t){var e=this;return l.BattleHelper.getNearestEntity(this.position,t,function(t){return t.isAlive()&&t!=e})},e.prototype.getNeareastEntityWithCondition=function(t,e){var n=this.getNeareastEntity(t.filter(e));return null==n&&(n=this.getNeareastEntity(t)),n},e.prototype.fullHp=function(){this._prop.hp=this.getMaxHp()},e.prototype.heal=function(t,e){t<=0||(this.prop.hp=Math.min(this.prop.hp+t,this.prop.maxHp.get()),this.onHeal(t,e))},e.prototype.hurt=function(t,e,n){void 0===n&&(n=!1);var o=this.getHp(),r=Math.min(o,t);r<=0||(this.prop.hp-=r,this.onHurt(r,e,n))},e.prototype.onHurt=function(){},e.prototype.onHeal=function(){},e.prototype.update=function(t){this._attackCd>0&&(this._attackCd=Math.max(0,this._attackCd-t))},e}(s.AvatarEntity);n.BattleEntity=d,cc._RF.pop()},{"../../Interface/Config/AbilityConfig":"AbilityConfig","../../Module/ConfigManager":"ConfigManager","../../Utils/Utils":"Utils","../Common/BattleHelper":"BattleHelper","../GameDefine":"GameDefine","./AvatarEntity":"AvatarEntity","./BattleProperty":"BattleProperty"}],BattleFlow:[function(t,e,n){"use strict";cc._RF.push(e,"31da3gE7f5Jma2feLKjHQ3X","BattleFlow");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.FormationFlow=n.RandomFlow=n.BattleFlow=n.BattleFlowCreator=void 0;var s=a(t("lodash")),c=t("../Interface/Config/LevelConfig"),l=a(t("../Utils/Utils")),u=t("./Common/BattleHelper"),p=t("../Utils/Timer"),f=function(){function t(){}return t.create=function(t,e,n){return t.formation?new y(t,e,n):new d(t,e,n)},t}();n.BattleFlowCreator=f;var h=function(){function t(t,e,n){this.tick=0,this.delay=0,this.waveDuration=0,this.totalDuration=0,this.config=t,this.context=n,this.delay=e,this.waveDuration=this.config.waveDuration,this.totalDuration=this.delay+this.waveDuration}return t.prototype.getHpFactor=function(){return this.config.hpFactor},t.prototype.getAttackFactor=function(){return this.config.atkFactor},t.prototype.getSpeedFactor=function(){return this.config.speedFactor},t.prototype.isFinish=function(){return this.tick>=this.totalDuration},t}();n.BattleFlow=h;var d=function(t){function e(e,n,o){var r=t.call(this,e,n,o)||this;return r.totalSpawnCount=0,r.currentSpawnCount=0,r.totalSpawnCount=r.config.idArray.reduce(function(t,e){return t+e.enemyCount},0),r.toSpawnEnemys=s.default.cloneDeep(r.config.idArray),r}return r(e,t),e.prototype.step=function(t){var e=this.tickToGetGenerateEnemy(t);if(e>0){var n=this.context.entityManager.createEnemy(e,{pos:this.context.terrain.getRandEnemyPos()});n.setConfigFactors(this.getHpFactor()-1,this.getAttackFactor()-1,this.getSpeedFactor()-1),n.createAvatar({parent:this.context.terrain.node})}},e.prototype.tickToGetGenerateEnemy=function(t){return this.tick+=t,this.tick>this.delay&&this.currentSpawnCount<this.totalSpawnCount&&this.tick-this.delay>=this.currentSpawnCount/this.totalSpawnCount*this.waveDuration?this.getRandEnemyId():0},e.prototype.getRandEnemyId=function(){var t=l.default.randomRangeInt(0,this.toSpawnEnemys.length),e=this.toSpawnEnemys[t],n=e.enemyId;return e.enemyCount-=1,e.enemyCount<=0&&this.toSpawnEnemys.splice(t,1),this.currentSpawnCount++,n},e}(h);n.RandomFlow=d;var y=function(t){function e(e,n,o){var r=t.call(this,e,n,o)||this,i=r.config.formationIds.length;switch(r.config.formation){case c.FormationType.Rect:r.offset=r.genRectOffset(i);break;case c.FormationType.Line:r.offset=r.genLineOffset(i);break;case c.FormationType.Tri:r.offset=r.genTriOffset(i)}return r.timer=new p.CountdownTimer(r.genEnemy.bind(r),r.delay),r}return r(e,t),e.prototype.genRectOffset=function(t){var e=cc.v2(0,0),n=u.Direction.Down,o=[];o.push(e);var r=cc.v2(this.config.formationParam.gapX,this.config.formationParam.gapY),i=2;for(e=u.BattleHelper.movePt(e,n,r.y),n=u.BattleHelper.rotateDir(n);o.length<t;){o.push(e);for(var a=1;a<i;++a)e=u.BattleHelper.movePt(e,n,r.x),o.push(e);for(n=u.BattleHelper.rotateDir(n),e=u.BattleHelper.movePt(e,n,r.y),o.push(e),a=1;a<i;++a)e=u.BattleHelper.movePt(e,n,r.y),o.push(e);for(n=u.BattleHelper.rotateDir(n),e=u.BattleHelper.movePt(e,n,r.x),o.push(e),a=1;a<i;++a)e=u.BattleHelper.movePt(e,n,r.x),o.push(e);for(n=u.BattleHelper.rotateDir(n),e=u.BattleHelper.movePt(e,n,r.y),o.push(e),a=1;a<i;++a)e=u.BattleHelper.movePt(e,n,r.y),o.push(e);n=u.BattleHelper.rotateDir(n),e=u.BattleHelper.movePt(e,n,r.x),i+=1}return o},e.prototype.genLineOffset=function(t){var e=cc.v2(0,0),n=[];n.push(e);for(var o=1,r=cc.v2(this.config.formationParam.gapX,this.config.formationParam.gapY);n.length<t&&(n.push(e.add(cc.v2(r.x*o,0))),!(n.length>=t));)n.push(e.add(cc.v2(r.x*-o,0))),o+=1;return n},e.prototype.genTriOffset=function(t){var e=cc.v2(0,0),n=[];n.push(e);var o=1,r=cc.v2(this.config.formationParam.gapX,this.config.formationParam.gapY);t:for(;n.length<t;){for(var i=2*o+1,a=-r.x*o,s=r.y*o,c=0;c<i;++c)if(n.push(e.add(cc.v2(a+c*r.x,s))),n.length>=t)break t;o+=1}return n},e.prototype.step=function(t){this.tick+=t,this.timer.step(t)},e.prototype.genEnemy=function(){var t,e,n,o=this.context.terrain.enemySpawnPos.children[0].getPosition(),r=Number.MAX_VALUE;try{for(var a=i(this.offset),s=a.next();!s.done;s=a.next())(h=s.value).y<r&&(r=h.y,n=h)}catch(y){t={error:y}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}for(var c=this.offset[0].y-n.y,l=cc.v2(0,c),u=this.config.formationIds,p=0;p<u.length;++p){var f=u[p],h=this.offset[p].add(o).add(l),d=this.context.entityManager.createEnemy(f,{pos:h});d.setConfigFactors(this.getHpFactor()-1,this.getAttackFactor()-1,this.getSpeedFactor()-1),d.createAvatar({parent:this.context.terrain.node})}},e}(h);n.FormationFlow=y,cc._RF.pop()},{"../Interface/Config/LevelConfig":"LevelConfig","../Utils/Timer":"Timer","../Utils/Utils":"Utils","./Common/BattleHelper":"BattleHelper",lodash:13}],BattleHelper:[function(t,e,n){"use strict";cc._RF.push(e,"78d27XOisNH4aGzcXYKQwSl","BattleHelper");var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.BattleHelper=n.Direction=void 0;var i,a=t("../../Enum/EntryType"),s=t("../../Module/ConfigManager"),c=t("../../Enum/TagType"),l=r(t("../../Utils/Utils"));(function(t){t[t.Up=0]="Up",t[t.Right=1]="Right",t[t.Down=2]="Down",t[t.Left=3]="Left"})(i=n.Direction||(n.Direction={}));var u=function(){function t(){}return t.attackSpeedToInterval=function(e){return 2*t.InitAttackInterval/(1+e/100)},t.attackIntervalToSpeed=function(e){return 100*(2*t.InitAttackInterval/e-1)},t.genPlayerEntry=function(t){var e,n,r=[];try{for(var i=o(t),a=i.next();!a.done;a=i.next()){var l=a.value,u=s.ConfigManager.instance.getEntryConfig(l.id).applyTags;u&&u.includes(c.TagType.Player)&&r.push(l)}}catch(p){e={error:p}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},t.genGuardEntryMap=function(t){var e,n,r,i,a=new Map,c=s.ConfigManager.instance.getGuardConfigs();try{for(var u=o(c.values()),p=u.next();!p.done;p=u.next()){var f=p.value,h=f.tags,d=f.id,y=[];a.set(d,y);try{for(var _=(r=void 0,o(t)),g=_.next();!g.done;g=_.next()){var v=g.value,m=s.ConfigManager.instance.getEntryConfig(v.id).applyTags,b=v.influenceGuardIds;m&&m.length&&h&&l.default.isIntersect(m,h)?y.push(v):b&&b.includes(d)&&y.push(v)}}catch(w){r={error:w}}finally{try{g&&!g.done&&(i=_.return)&&i.call(_)}finally{if(r)throw r.error}}}}catch(S){e={error:S}}finally{try{p&&!p.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return a},t.addPlayerEntry=function(t,e){this.addEntityEntry(t,e)},t.addGuardEntry=function(t,e){var n=e.get(t.id);n&&this.addEntityEntry(t,n)},t.addEntityEntry=function(t,e){var n,r;try{for(var i=o(e),c=i.next();!c.done;c=i.next()){var l=c.value,u=l.num,p=s.ConfigManager.instance.getEntryConfig(l.id);switch(p.type){case a.EntryType.AddHp:t.prop.maxHp.addValue(p.modType,u),t.fullHp();break;case a.EntryType.AddAttack:t.prop.attack.addValue(p.modType,u);break;case a.EntryType.AddMoveSpeed:t.prop.moveSpeed.addValue(p.modType,u);break;case a.EntryType.AddAttackSpped:t.prop.attackSpeed.addValue(p.modType,u);break;case a.EntryType.BulletNum:t.prop.bulletNum.addValue(p.modType,u)}}}catch(f){n={error:f}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.dirToVec=function(t){switch(t){case i.Up:return cc.v2(0,1);case i.Right:return cc.v2(1,0);case i.Down:return cc.v2(0,-1);case i.Left:return cc.v2(-1,0)}},t.rotateDir=function(t,e){return void 0===e&&(e=!0),e?(t+1)%4:((t-=1)<=0&&(t+=4),t)},t.movePt=function(e,n,o){var r=t.dirToVec(n);return e.add(r.mul(o))},t.getNearestEntity=function(t,e,n){var o=e.filter(function(t){return null!=t.avatar&&(!n||n(t))});return l.default.findMin(o,function(e){return cc.Vec2.squaredDistance(t,e.avatar.getPosition())})},t.InitAttackSpeed=100,t.InitAttackInterval=2,t}();n.BattleHelper=u,cc._RF.pop()},{"../../Enum/EntryType":"EntryType","../../Enum/TagType":"TagType","../../Module/ConfigManager":"ConfigManager","../../Utils/Utils":"Utils"}],BattleProperty:[function(t,e,n){"use strict";cc._RF.push(e,"87a8f+05dNJnI0eIG9NqRsw","BattleProperty"),Object.defineProperty(n,"__esModule",{value:!0}),n.BattleProperty=void 0;var o=t("../../Interface/Config/BuffConfig"),r=function(){function t(t,e){void 0===e&&(e=!1),this._initValue=0,this._baseAdd=0,this._percentAdd=0,this._externalAdd=0,this._dirty=!1,this._finalValue=0,this._mustBeInteger=!1,this._minValue=null,this._maxValue=null,this._finalValue=this._initValue=t,this._mustBeInteger=e}return t.prototype.setMinMax=function(t,e){this._minValue=t,this._maxValue=e},t.prototype.setDirty=function(){this._dirty=!0},t.prototype.calculate=function(){var t=(this._initValue+this._baseAdd)*(1+this._percentAdd)+this._externalAdd;null!=this._minValue&&(t=Math.max(t,this._minValue)),null!=this._maxValue&&(t=Math.min(t,this._maxValue)),this._mustBeInteger&&(t=Math.floor(t)),this._finalValue=t},t.prototype.setFinalValue=function(t){this.addExternal(t-this.get())},t.prototype.setInit=function(t){this._initValue=t,this.setDirty()},t.prototype.getInit=function(){return this._initValue},t.prototype.setBase=function(t){this._baseAdd=t,this.setDirty()},t.prototype.addBase=function(t){this._baseAdd+=t,this.setDirty()},t.prototype.getBase=function(){return this._baseAdd},t.prototype.setPercent=function(t){this._percentAdd=t,this.setDirty()},t.prototype.addPercent=function(t){this._percentAdd+=t,this.setDirty()},t.prototype.getPercent=function(){return this._percentAdd},t.prototype.setExternal=function(t){this._externalAdd=t,this.setDirty()},t.prototype.addExternal=function(t){this._externalAdd+=t,this.setDirty()},t.prototype.getExternal=function(){return this._externalAdd},t.prototype.addValue=function(t,e){switch(t){case o.PropertyModType.Base:this.addBase(e);break;case o.PropertyModType.Percent:this.addPercent(e);break;case o.PropertyModType.External:this.addExternal(e)}},t.prototype.get=function(){return this._dirty&&this.calculate(),this._finalValue},t}();n.BattleProperty=r,cc._RF.pop()},{"../../Interface/Config/BuffConfig":"BuffConfig"}],BattleStats:[function(t,e,n){"use strict";cc._RF.push(e,"75e5cy7MapP4obU3fFjbg8F","BattleStats");var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a};Object.defineProperty(n,"__esModule",{value:!0}),n.BattleStats=void 0;var i=function(){function t(){this._id2damage=new Map,this._score=0}return t.prototype.addScore=function(t){this._score+=t},t.prototype.getScore=function(){return this._score},t.prototype.recordDamage=function(t,e){var n=this._id2damage.get(t)||0;n+=e,this._id2damage.set(t,n)},t.prototype.clear=function(){this._score=0,this._id2damage.clear()},t.prototype.getDamage=function(t){return this._id2damage.get(t)||0},t.prototype.getAllDamages=function(){var t,e,n=[];try{for(var i=o(this._id2damage.entries()),a=i.next();!a.done;a=i.next()){var s=r(a.value,2),c=s[0],l=s[1];n.push({id:c,damage:l})}}catch(u){t={error:u}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},t}();n.BattleStats=i,cc._RF.pop()},{}],BattleSystem:[function(t,e,n){"use strict";cc._RF.push(e,"55aedCHnDZOKblLTS9rkiyl","BattleSystem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.BattleSystem=void 0;var l=t("../../Interface/SaveData/BattleData"),u=t("../../Module/ConfigManager"),p=c(t("../../Module/Database/Db")),f=c(t("../../Module/ViewModule")),h=c(t("../../Utils/Path")),d=t("../Battle"),y=t("./Common/DataSaver"),_={BattleStart:"BattleStart",BattleEnd:"BattleEnd"},g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="BattleSystem",e._curLevel=1,e._saver=new y.DataSaver,e}return r(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.init=function(){return i(this,void 0,void 0,function(){var t,e,n,o,r,i,c,f,h,d,y;return a(this,function(){this._data=p.default.instance.getData("battle"),this._data||(this._data={magic:1,version:1,curLevel:1,levelData:{},guards:{},enemys:{}},this.setDirty()),t=u.ConfigManager.instance.getGuardConfigs();try{for(e=s(t.keys()),n=e.next();!n.done;n=e.next())c=n.value,this._data.guards[c]||(this._data.guards[c]={summon:0})}catch(a){f={error:a}}finally{try{n&&!n.done&&(h=e.return)&&h.call(e)}finally{if(f)throw f.error}}o=u.ConfigManager.instance.getEnemyConfigs();try{for(r=s(o.keys()),i=r.next();!i.done;i=r.next())c=i.value,this._data.enemys[c]||(this._data.enemys[c]={status:l.IEnemyStatus.Lock,kill:0})}catch(_){d={error:_}}finally{try{i&&!i.done&&(y=r.return)&&y.call(r)}finally{if(d)throw d.error}}return this._saver.init("battle",this._data),[2]})})},e.prototype.setDirty=function(){this._saver.setDirty()},e.prototype.destroy=function(){this._saver.save()},e.prototype.logicUpdate=function(t){this._battle&&this._battle.update(t)},e.prototype.getGuardsInfo=function(){return this._data.guards},e.prototype.getEnemysInfo=function(){return this._data.enemys},e.prototype.unlockEnemy=function(t){var e=this._data.enemys[t];e.status!=l.IEnemyStatus.Unlock&&(e.status=l.IEnemyStatus.Unlock,this.setDirty())},e.prototype.addKillNum=function(t){this._data.enemys[t].kill++,this.setDirty()},e.prototype.getUnlockEnemyNum=function(){var t=0,e=this._data.enemys;for(var n in e)e[n].status==l.IEnemyStatus.Unlock&&t++;return t},e.prototype.getBattle=function(){return this._battle},e.prototype.getCurrentLevel=function(){return this._data.curLevel},e.prototype.setCurrentLevel=function(t){this._data.curLevel!=t&&(this._data.curLevel=t,this.setDirty())},e.prototype.startBattle=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(){return this._battle&&this._battle.destroy(),this._curLevel=t,e=u.ConfigManager.instance.getLevelConfig(this._curLevel),this._battle=new d.Battle(e),this._battle.on(d.Battle.Events.BattleEnd,this.onBattleEnd,this),f.default.instance.pushView("BattleView",this._battle,{bundle:h.default.BATTLE_BUNDLE,onLoaded:this.onBattleViewLoaded.bind(this)}),[2]})})},e.prototype.onBattleViewLoaded=function(t){return i(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this.emit(_.BattleStart,this._curLevel),this._battleView=t,this._battle.setView(t),[4,this._battle.load()];case 1:return e.sent(),this._battle.startBattle(),[2]}})})},e.prototype.onBattleEnd=function(t){this._battleView&&(this._battleView.close(),this._battleView=null),this._battle&&(this._battle.destroy(),this._battle=null),this.emit(_.BattleEnd);var e=this._data.levelData[this._curLevel];e?t.score>e.maxScore&&(e.maxScore=t.score,this.setDirty()):(this._data.levelData[this._curLevel]={level:this._curLevel,maxScore:t.score},this.setDirty())},e._instance=null,e.Events=_,e}(cc.EventTarget);n.BattleSystem=g,cc._RF.pop()},{"../../Interface/SaveData/BattleData":"BattleData","../../Module/ConfigManager":"ConfigManager","../../Module/Database/Db":"Db","../../Module/ViewModule":"ViewModule","../../Utils/Path":"Path","../Battle":"Battle","./Common/DataSaver":"DataSaver"}],BattleUI:[function(t,e,n){"use strict";cc._RF.push(e,"b7d567lHMFEsJYlLRg3HeIz","BattleUI");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../Gameplay/Battle"),c=t("../Gameplay/Entity/EntityManager"),l=t("../Gameplay/Entity/Player"),u=a(t("../Utils/Path")),p=a(t("../Utils/Utils")),f=cc._decorator,h=f.ccclass,d=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnSpeedUp=null,e.hpBar=null,e.hpLabel=null,e.expBar=null,e.expLabel=null,e.levelFlowLabel=null,e.labelSpeed=null,e.rightInfoNode=null,e.guardNode=null,e.btnCastAbility=null,e.abilityCdProgress=null,e._guardNode={},e}return r(e,t),e.prototype.onLoad=function(){this.btnSpeedUp.node.on("click",this.onBtnSpeedUp,this),this.btnCastAbility.node.on("click",this.onBtnCastAbility,this)},e.prototype.init=function(t){var e=this;this.battleContext=t,this.entityManager=t.entityManager;var n=this.entityManager.getPlayer();this.hpBar.progress=1,this.hpLabel.string=n.getHp()+"/"+n.getMaxHp(),n.on(l.Player.Events.Hp,function(t,n){e.hpBar.progress=cc.misc.clamp01(t/n),e.hpLabel.string=t+"/"+n}),this.expBar.progress=0,this.expLabel.string=p.default.replaceStr("ui_level",n.level),n.on(l.Player.Events.Exp,function(t,o){e.expBar.progress=cc.misc.clamp01(t/o),e.expLabel.string=p.default.replaceStr("ui_level",n.level)}),this.levelFlowLabel.string=p.default.replaceStr("ui_wave",this.battleContext.enemyFlowIndex+1),this.battleContext.on(s.Battle.Events.NextFlow,function(t){e.levelFlowLabel.string=p.default.replaceStr("ui_wave",t+1)},this),this.entityManager.on(c.EntityManager.Events.GuardCreate,this.onGuardCreate,this),this.entityManager.on(c.EntityManager.Events.GuardDestroy,this.onGuardDestroy,this)},e.prototype.onGuardCreate=function(t){var e={count:1,type:t.type,node:null};this._guardNode[t.id]?this._guardNode[t.id].count++:this._guardNode[t.id]=e;var n=this._guardNode[t.id],o=null;if(n.node)o=this._guardNode[t.id].node;else{(o=cc.instantiate(this.guardNode)).parent=this.rightInfoNode,n.node=o;var r=u.default.getAvatar(t.config.avatarAsset),i=o.getChildByName("img").getComponent(cc.Sprite);p.default.loadImg(i,r,50)}var a=o.getChildByName("num");a.active=n.count>0,n.count>0&&(a.getComponent(cc.Label).string="x"+n.count)},e.prototype.onGuardDestroy=function(t){this._guardNode[t.id].count--,this._guardNode[t.id].count<=0?(this._guardNode[t.id].node.removeFromParent(),this._guardNode[t.id].node.destroy(),delete this._guardNode[t.id]):this._guardNode[t.id].node.getChildByName("num").getComponent(cc.Label).string="x"+this._guardNode[t.id].count},e.prototype.update=function(){if(this.entityManager){var t=this.entityManager.getPlayer();this.btnCastAbility.interactable=t.canAttack(),this.abilityCdProgress.progress=1-t.getCurrentAttackCd()/t.getAttackInterval()}},e.prototype.onBtnSpeedUp=function(){if(this.battleContext){var t=this.battleContext.battleSpeed.value;(t+=1)>3&&(t=1),this.battleContext.battleSpeed.value=t,this.labelSpeed.string="x"+t}},e.prototype.onBtnCastAbility=function(){if(this.entityManager){var t=this.entityManager.getPlayer();t.canAttack()&&(t.castSelfAbility(),t.onAttackOnce())}},i([d(cc.Button)],e.prototype,"btnSpeedUp",void 0),i([d(cc.ProgressBar)],e.prototype,"hpBar",void 0),i([d(cc.Label)],e.prototype,"hpLabel",void 0),i([d(cc.ProgressBar)],e.prototype,"expBar",void 0),i([d(cc.Label)],e.prototype,"expLabel",void 0),i([d(cc.Label)],e.prototype,"levelFlowLabel",void 0),i([d(cc.Label)],e.prototype,"labelSpeed",void 0),i([d(cc.Node)],e.prototype,"rightInfoNode",void 0),i([d(cc.Prefab)],e.prototype,"guardNode",void 0),i([d(cc.Button)],e.prototype,"btnCastAbility",void 0),i([d(cc.ProgressBar)],e.prototype,"abilityCdProgress",void 0),i([h],e)}(cc.Component);n.default=y,cc._RF.pop()},{"../Gameplay/Battle":"Battle","../Gameplay/Entity/EntityManager":"EntityManager","../Gameplay/Entity/Player":"Player","../Utils/Path":"Path","../Utils/Utils":"Utils"}],BattleView:[function(t,e,n){"use strict";cc._RF.push(e,"1fee5/11r9LKLgHc96Xh8Ju","BattleView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Enum/ViewType")),c=a(t("../../Module/ViewHandler")),l=a(t("../../Module/ViewModule")),u=a(t("../../UI/BattleUI")),p=a(t("../../Utils/Path")),f=a(t("../../Utils/Utils")),h=cc._decorator,d=h.ccclass,y=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewType=s.default.Normal,e.battleRoot=null,e.assignArea=null,e.battleUI=null,e.btnPause=null,e.effectRoot=null,e}return r(e,t),e.prototype.initiateView=function(t){this.battle=t,this.assignArea.on(cc.Node.EventType.TOUCH_START,this.onClickAssignArea,this)},e.prototype.showBattleEndView=function(t,e){var n=this.battle.getBattleProgress();l.default.instance.pushView("BattleEndView",{battleResult:t,progress:n,cb:e},{bundle:p.default.BATTLE_BUNDLE})},e.prototype.showUpgradeView=function(t,e){l.default.instance.pushView("UpgradeView",{battle:this.battle,upgradeConfig:t,onClose:e},{bundle:p.default.BATTLE_BUNDLE})},e.prototype.onPause=function(){var t=this;this.battle.pause(),l.default.instance.pushView("PauseView",{battle:this.battle,cb:function(e){e?t.battle.pauseEndBattle(t.battle.getBattleResult()):t.battle.resume()}},{bundle:p.default.BATTLE_BUNDLE})},e.prototype.onClickAssignArea=function(t){if(this.battle.isPlaying()){var e=f.default.getEventTouchWorldPosition(t),n=this.battle.terrain.node.convertToNodeSpaceAR(e);this.battle.assignGuardsTo(n)}},i([y(cc.Node)],e.prototype,"battleRoot",void 0),i([y(cc.Node)],e.prototype,"assignArea",void 0),i([y(u.default)],e.prototype,"battleUI",void 0),i([y(cc.Node)],e.prototype,"btnPause",void 0),i([y(cc.Node)],e.prototype,"effectRoot",void 0),i([d],e)}(c.default);n.default=_,cc._RF.pop()},{"../../Enum/ViewType":"ViewType","../../Module/ViewHandler":"ViewHandler","../../Module/ViewModule":"ViewModule","../../UI/BattleUI":"BattleUI","../../Utils/Path":"Path","../../Utils/Utils":"Utils"}],Battle:[function(t,e,n){"use strict";cc._RF.push(e,"06a7fEU4HxFHYDug+xd+cR1","Battle");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},l=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.Battle=void 0;var p=u(t("../Component/Terrain/Terrain")),f=t("../Module/ConfigManager"),h=t("../Interface/Config/UpgradeConfig"),d=u(t("../Module/Loader")),y=u(t("../Utils/Utils")),_=u(t("../Utils/Path")),g=t("./BattleFlow"),v=t("./Entity/EntityManager"),m=t("../Utils/ReactProperty"),b=u(t("./GameDefine")),w=t("./BattleStats"),S=t("../Utils/NodePool"),C=t("./System/BagSystem"),A=t("./System/HomeSystem"),M=u(t("lodash")),P=u(t("../Module/ViewModule")),E=t("./System/WeaponSystem"),O=t("./Common/BattleHelper"),R={BattleStart:"BattleStart",BattleEnd:"BattleEnd",NextFlow:"NextFlow"},T=function(t){function e(e){var n=t.call(this)||this;return n.enemyFlowIndex=0,n.battleSpeed=new m.ReactNumber(1),n.playing=!1,n.battleTick=0,n.assignedGuards=[],n.config=e,n}return r(e,t),e.prototype.setView=function(t){this.battleView=t},e.prototype.load=function(){return i(this,void 0,void 0,function(){var t,e,n,o,r,i,s,c,l,u,h,y;return a(this,function(a){switch(a.label){case 0:return this.battleStats=new w.BattleStats,(t=this.entityManager=new v.EntityManager(this)).on(v.EntityManager.Events.GuardCreate,this.onGuardCreate,this),t.on(v.EntityManager.Events.GuardDestroy,this.onGuardDestroy,this),this.allGuardIds=E.WeaponSystem.instance.getEquipedGuardIds(),this.allEntryInfos=E.WeaponSystem.instance.getCurrentAllEntryInfo(),this.playerEntryInfos=O.BattleHelper.genPlayerEntry(this.allEntryInfos),this.guardEntryMap=O.BattleHelper.genGuardEntryMap(this.allEntryInfos),[4,this.preloadLevelAssets()];case 1:return a.sent(),[4,d.default.loadPrefabAsync(_.default.getLevelPath(this.config.asset),this.battleView)];case 2:return e=a.sent(),(n=cc.instantiate(e)).parent=this.battleView.battleRoot,this.terrain=n.getComponent(p.default),this.terrain.init(),[4,this.initHurtNodePool()];case 3:for(s in a.sent(),o=f.ConfigManager.instance.getConfig("Player"),r=Object.keys(o).length,i=[],o)c=o[s].exp,i.push(c);return l=E.WeaponSystem.instance.getCurWeaponId(),u=f.ConfigManager.instance.getWeaponConfig(l),h={hp:b.default.PlayerInitHp,attack:u.attack,maxLevel:r,upgradeExp:i,ability:u.ability},y=this.player=this.entityManager.createPlayer(h,{pos:this.terrain.playerPosition}),O.BattleHelper.addPlayerEntry(y,this.playerEntryInfos),this.battleView.battleUI.init(this),[4,y.createAvatar({parent:n})];case 4:return a.sent(),[2]}})})},e.prototype.preloadLevelAssets=function(){return i(this,void 0,void 0,function(){var t,e,n,o,r,i,c,l,u,p,h,y,g,v,m,b;return a(this,function(){t=[],e=new Set,this.config.waves.forEach(function(t){var n=f.ConfigManager.instance.getLevelFlowConfig(t);n.idArray&&n.idArray.forEach(function(t){return e.add(t.enemyId)}),n.formationIds&&n.formationIds.forEach(function(t){return e.add(t)})});try{for(n=s(e),o=n.next();!o.done;o=n.next())c=o.value,p=f.ConfigManager.instance.getEnemyConfig(c),t.push(d.default.loadPrefabAsync(_.default.getEntityPath(p.asset),this.battleView))}catch(a){h={error:a}}finally{try{o&&!o.done&&(y=n.return)&&y.call(n)}finally{if(h)throw h.error}}try{for(r=s(this.allGuardIds),i=r.next();!i.done;i=r.next())c=i.value,p=f.ConfigManager.instance.getGuardConfig(c),t.push(d.default.loadPrefabAsync(_.default.getEntityPath(p.asset),this.battleView))}catch(w){g={error:w}}finally{try{i&&!i.done&&(v=r.return)&&v.call(r)}finally{if(g)throw g.error}}try{for(l=s(f.ConfigManager.instance.getAbilityConfigs().values()),u=l.next();!u.done;u=l.next())p=u.value,t.push(d.default.loadPrefabAsync(_.default.getEntityPath(p.asset),this.battleView))}catch(S){m={error:S}}finally{try{u&&!u.done&&(b=l.return)&&b.call(l)}finally{if(m)throw m.error}}return t.push(d.default.loadPrefabAsync(_.default.getPlayerEntityPath(),this.battleView)),t.push(d.default.loadPrefabAsync(_.default.getLevelPath(this.config.asset),this.battleView)),t.push(d.default.loadDirAsync(_.default.BATTLE_BUNDLE,"Prefabs",cc.Prefab,this.battleView)),[2,Promise.all(t)]})})},e.prototype.startBattle=function(){this.emit(R.BattleStart),A.HomeSystem.instance.playBgm(b.default.BattleBGM),cc.director.getCollisionManager().enabled=!0,this.playing=!0,this.battleTick=0,this.enemyFlowIndex=0,this.createFlow(),b.default.DisableWeaponGuard||this.createWeaponGuard()},e.prototype.createWeaponGuard=function(){var t=E.WeaponSystem.instance.getCurWeaponId(),e=f.ConfigManager.instance.getWeaponConfig(t);this.entityManager.createGuard(e.guardId,{pos:this.getGuardSpawnPos()})},e.prototype.getPlayer=function(){return this.player},e.prototype.createFlow=function(){var t=f.ConfigManager.instance.getLevelFlowConfig(this.config.waves[this.enemyFlowIndex]),e=this.config.waveDelay[this.enemyFlowIndex];this.currentFlow=g.BattleFlowCreator.create(t,e,this),cc.log("\u5f00\u59cb\u65b0\u6ce2\u6b21\uff1a "+this.enemyFlowIndex),this.emit(R.NextFlow,this.enemyFlowIndex)},e.prototype.pause=function(){this.playing=!1},e.prototype.resume=function(){this.playing=!0},e.prototype.isPlaying=function(){return this.playing},e.prototype.update=function(t){this.playing&&null!=this.player&&(this.player.canUpgrade()&&(this.player.upgrade(),this.showUpgradeAndPause()),t*=this.battleSpeed.value,this.battleTick+=t,this.currentFlow&&(this.currentFlow.step(t),this.currentFlow.isFinish()&&(this.enemyFlowIndex+=1,this.enemyFlowIndex<this.config.waves.length?this.createFlow():this.currentFlow=null)),this.entityManager.update(t),this.validateAssignTarget(),b.default.DebugAssign&&this.drawDebugAssign(),this.player.isAlive()&&(this.currentFlow||0!==this.entityManager.getAllEnemies().size)||this.finishBattle(this.getBattleResult()))},e.prototype.getBattleResult=function(){var t=this.battleStats.getAllDamages();t.sort(function(t,e){return e.damage-t.damage});var e=this.player.isPerfect,n=M.default.cloneDeep(this.config.rewards),o=this.getBattleProgress();e&&o>=1&&n.push(this.config.extraRewards);for(var r=0;r<n.length;r++){var i=n[r];i.count=Math.floor(i.count*o)}return{success:this.player.isAlive()&&o>=1,timeSec:Math.ceil(this.battleTick),score:this.battleStats.getScore(),isPerfect:e,damageStats:t,rewards:n}},e.prototype.showUpgradeAndPause=function(){this.pause(),this.battleView.showUpgradeView(this.randomUpgradeOptions(),this.resume.bind(this))},e.prototype.getBattleProgress=function(){return this.enemyFlowIndex/this.config.waves.length},e.prototype.randomUpgradeOptions=function(){var t,e,n,o,r,i,a,c,u=[],p=Array.from(this.entityManager.getAllGuards().values()),d=y.default.createMultiMap(p,function(t){return[t.id,t]}),_=y.default.createMultiMap(p,function(t){return[t.type,t]}),g=[],v=[];try{for(var m=s(this.allGuardIds),b=m.next();!b.done;b=m.next()){var w=b.value,S=f.ConfigManager.instance.getGuardConfig(w);if(null==S.summonCondition)g.push(S);else{var C=!0;try{for(var A=(n=void 0,s(S.summonCondition)),M=A.next();!M.done;M=A.next()){var P=M.value,E=P.guardId,O=P.guardType,R=P.count;if(E){if(d.has(E)&&d.get(E).length>=R)continue;C=!1;break}if(!(_.has(O)&&_.get(O).length>=R)){C=!1;break}}}catch(F){n={error:F}}finally{try{M&&!M.done&&(o=A.return)&&o.call(A)}finally{if(n)throw n.error}}C&&v.push(S)}}}catch(H){t={error:H}}finally{try{b&&!b.done&&(e=m.return)&&e.call(m)}finally{if(t)throw t.error}}var T=g.concat(v),I=[];if(3==T.length)I=T;else if(T.length>3)for(var N=0;N<3;N++){var D=y.default.randomRangeInt(0,T.length);I.push(T[D]),T.splice(D,1)}else for(I=T;I.length<3;)I.push(y.default.randomSelect(g));try{for(var x=s(I),B=x.next();!B.done;B=x.next()){var L=B.value;if(null==L.summonCondition)u.push({type:h.UpgradeType.SummonGuard,guardId:L.id});else{var k=[];try{for(var U=(a=void 0,s(L.summonCondition)),G=U.next();!G.done;G=U.next()){var j=G.value,V=(w=j.guardId,O=j.guardType,R=j.count,w?d.get(w):_.get(O));if(R===V.length)k.push.apply(k,l(V));else for(N=0;N<R;++N)D=y.default.randomRangeInt(0,V.length),k.push(V[D]),V.splice(D,1)}}catch(W){a={error:W}}finally{try{G&&!G.done&&(c=U.return)&&c.call(U)}finally{if(a)throw a.error}}u.push({type:h.UpgradeType.UpgradeGuard,guardId:L.id,destroyUids:k.map(function(t){return t.uid})})}}}catch(z){r={error:z}}finally{try{B&&!B.done&&(i=x.return)&&i.call(x)}finally{if(r)throw r.error}}return{upgradeOptions:u}},e.prototype.countBattleReward=function(t){this.emit(R.BattleEnd,t),A.HomeSystem.instance.playBgm(b.default.StartBGM);for(var e=0;e<t.rewards.length;e++){var n=t.rewards[e];C.BagSystem.instance.addItemCount(n.id,n.count)}this.getBattleProgress()>=1&&A.HomeSystem.instance.onHurt(1),this.player.recoverPerfect()},e.prototype.finishBattle=function(t){var e=this;this.pause(),cc.director.getCollisionManager().enabled=!1,this.battleView.showBattleEndView(t,function(){e.countBattleReward(t)})},e.prototype.assignGuardsTo=function(t){if(this.assignPoint){var e=cc.Vec2.distance(t,this.assignPoint);if(e<b.default.ReassignPointDistance)return cc.log("\u70b9\u51fb\u8ddd\u79bb\u8fd1: "+e),void this.tryAssignNewGuard();var n=this.findAssignTarget(t);cc.log("\u91cd\u65b0\u6307\u6d3e\uff0c\u76ee\u6807 "+n),n?n==this.assignTargetEnemy?(this.assignPoint=t,this.tryAssignNewGuard()):this.reassignGuard(t,n):(cc.warn("\u6ca1\u6709\u76ee\u6807\uff0c\u8f6c\u4e3a\u90e8\u7f72"),this.reassignGuard(t,n))}else{var o=this.findAssignTarget(t);if(o)this.reassignGuard(t,o);else{cc.warn("\u6ca1\u6709\u76ee\u6807\uff0c\u8f6c\u4e3a\u90e8\u7f72");var r=y.default.randomPointInCircle(t,b.default.AssignTargetRadius);this.reassignGuard(r,o)}}},e.prototype.drawDebugAssign=function(){var t,e,n=y.default.getOrAddComponent(this.terrain.node,cc.Graphics);if(n.clear(),this.assignPoint){n.lineWidth=5,n.strokeColor=cc.Color.RED,y.default.drawCircle(n,b.default.ReassignPointDistance,this.assignPoint),n.strokeColor=cc.Color.GREEN,y.default.drawCircle(n,b.default.AssignTargetRadius,this.assignPoint),this.assignTargetEnemy&&(n.strokeColor=cc.Color.ORANGE,y.default.drawBoundingBox(n,this.assignTargetEnemy.avatar)),n.strokeColor=cc.Color.BLUE;try{for(var o=s(this.assignedGuards),r=o.next();!r.done;r=o.next()){var i=r.value;y.default.drawBoundingBox(n,i.avatar)}}catch(a){t={error:a}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}}},e.prototype.findAssignTarget=function(t){var e=b.default.AssignTargetRadius*b.default.AssignTargetRadius,n=Array.from(this.entityManager.getAllEnemies().values());return n=n.filter(function(n){return!!n.isAlive()&&cc.Vec2.squaredDistance(t,n.position)<e}),y.default.findMin(n,function(t){return t.position.y})},e.prototype.reassignGuard=function(t,e){var n,o;this.assignPoint=t,this.assignTargetEnemy=e;try{for(var r=s(this.assignedGuards),i=r.next();!i.done;i=r.next())i.value.assignTarget(null)}catch(l){n={error:l}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}this.assignedGuards.length=0;var a,c=Array.from(this.entityManager.getAllGuards().values());e?((a=O.BattleHelper.getNearestEntity(e.position,c,null)).assignTarget(e),this.assignedGuards.push(a),cc.log("\u6307\u6d3e "+a+"\uff0c\u76ee\u6807 "+e)):((a=O.BattleHelper.getNearestEntity(t,c,null)).assignTarget(null),this.assignedGuards.push(a),a.moveTo(t),cc.log("\u90e8\u7f72 "+a))},e.prototype.tryAssignNewGuard=function(){var t,e=this,n=Array.from(this.entityManager.getAllGuards().values());(n=n.filter(function(t){return!e.assignedGuards.includes(t)})).length>0?this.assignTargetEnemy?((t=O.BattleHelper.getNearestEntity(this.assignTargetEnemy.position,n,null)).assignTarget(this.assignTargetEnemy),this.assignedGuards.push(t),cc.log("\u65b0\u589e\u6307\u6d3e "+t+"\uff0c\u76ee\u6807 "+this.assignTargetEnemy)):((t=O.BattleHelper.getNearestEntity(this.assignPoint,n,null)).assignTarget(null),this.assignedGuards.push(t),t.moveTo(this.assignPoint),cc.log("\u65b0\u589e\u90e8\u7f72 "+t)):cc.warn("\u6ca1\u6709\u53ef\u6307\u6d3e\u7684\u5b88\u536b\u4e86")},e.prototype.validateAssignTarget=function(){var t,e;if(this.assignTargetEnemy&&!this.assignTargetEnemy.isAlive()){this.assignTargetEnemy=null,this.assignPoint=null;try{for(var n=s(this.assignedGuards),o=n.next();!o.done;o=n.next())o.value.assignTarget(null)}catch(r){t={error:r}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.assignedGuards.length=0}},e.prototype.pauseEndBattle=function(t){var e=this;P.default.instance.pushView("PauseEndView",{rewards:t.rewards,contentKey:"condition_pause_end",cb:function(n){n?e.countBattleReward(t):(e.resume(),P.default.instance.toast("toast_user_cancel"))}},{bundle:_.default.BATTLE_BUNDLE})},e.prototype.destroy=function(){this.entityManager.clear(),this.terrain&&(this.terrain.node.destroy(),this.terrain=null),cc.director.getCollisionManager().enabled=!1},e.prototype.onGuardCreate=function(t){return i(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return O.BattleHelper.addGuardEntry(t,this.guardEntryMap),[4,t.createAvatar({parent:this.terrain.node})];case 1:return e.sent(),[2]}})})},e.prototype.getGuardSpawnPos=function(){var t=this.terrain.guardSpawnPosition;return t.addSelf(cc.v2(y.default.randomRange(-200,200),0)),t},e.prototype.initHurtNodePool=function(){return i(this,void 0,void 0,function(){var t,e;return a(this,function(n){switch(n.label){case 0:return t=_.default.getHurtNodePath(),[4,d.default.loadResAsync(t,cc.Prefab,null)];case 1:return e=n.sent(),S.NodePool.instance.tryCreatePool(t,e),[2]}})})},e.prototype.showFloatDamage=function(t,e,n){var o=S.NodePool.instance.getNode(_.default.getHurtNodePath());o.parent=this.battleView.effectRoot,y.default.setWorldPosition(o,t);var r=o.getChildByName("labelHurt").getComponent(cc.Label);r.string="-"+e,r.node.color=n?cc.Color.RED:cc.Color.WHITE,r.node.scale=n?1.5:1,cc.tween(o).by(.5,{y:50}).call(function(){S.NodePool.instance.putNode(o)}).start()},e.prototype.onGuardDestroy=function(){},e.prototype.onPlayerCreate=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.onEnemyCreate=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.Events=R,e}(cc.EventTarget);n.Battle=T,cc._RF.pop()},{"../Component/Terrain/Terrain":"Terrain","../Interface/Config/UpgradeConfig":"UpgradeConfig","../Module/ConfigManager":"ConfigManager","../Module/Loader":"Loader","../Module/ViewModule":"ViewModule","../Utils/NodePool":"NodePool","../Utils/Path":"Path","../Utils/ReactProperty":"ReactProperty","../Utils/Utils":"Utils","./BattleFlow":"BattleFlow","./BattleStats":"BattleStats","./Common/BattleHelper":"BattleHelper","./Entity/EntityManager":"EntityManager","./GameDefine":"GameDefine","./System/BagSystem":"BagSystem","./System/HomeSystem":"HomeSystem","./System/WeaponSystem":"WeaponSystem",lodash:13}],BuffConfig:[function(t,e,n){"use strict";cc._RF.push(e,"ef0234TXwNPv6KTn5UqN9ZI","BuffConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.PropertyModType=n.BuffType=n.TargetCategory=void 0,function(t){t.Enemy="Enemy",t.Guard="Guard",t.Player="Player"}(n.TargetCategory||(n.TargetCategory={})),function(t){t.Stun="Stun",t.Dot="Dot",t.Heal="Heal",t.Invincible="Invincible",t.Die="Die",t.DieCast="DieCast",t.AddAttack="AddAttack",t.AddMoveSpeed="AddMoveSpeed",t.AddAttackSpped="AddAttackSpped",t.AddHurt="AddHurt"}(n.BuffType||(n.BuffType={})),function(t){t.Base="Base",t.Percent="Pct",t.External="Ext"}(n.PropertyModType||(n.PropertyModType={})),cc._RF.pop()},{}],Buff:[function(t,e,n){"use strict";cc._RF.push(e,"100058OE2FIVY9AnnnhpXPs","Buff");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.Buff=n.BuffCreator=void 0;var a=t("../../Interface/Config/BuffConfig"),s=t("../../Module/ConfigManager"),c=t("../../Utils/Timer"),l=i(t("../GameDefine")),u=t("./BaseEntity"),p=function(){function t(){}return t.create=function(t,e){switch(s.ConfigManager.instance.getBuffConfig(e).type){case a.BuffType.Stun:return new d(t,e);case a.BuffType.Dot:return new y(t,e);case a.BuffType.Heal:return new _(t,e);case a.BuffType.Invincible:return new S(t,e);case a.BuffType.DieCast:return new A(t,e);case a.BuffType.Die:return new C(t,e);case a.BuffType.AddAttack:return new w(t,e);case a.BuffType.AddAttackSpped:return new m(t,e);case a.BuffType.AddMoveSpeed:return new v(t,e);case a.BuffType.AddHurt:return new b(t,e);default:return null}},t}();n.BuffCreator=p;var f=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o._lastTick=0,o._tick=0,o._onStartCalled=!1,o._onFinishCalled=!1,o.config=s.ConfigManager.instance.getBuffConfig(n),o}return r(e,t),Object.defineProperty(e.prototype,"targetProp",{get:function(){return this.target.prop},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this._onStartCalled||(this.onStart(),this._onStartCalled=!0),this._onFinishCalled||(this.onFinish(),this._onFinishCalled=!0)},e.prototype.isAlive=function(){return this._tick<this.config.duration},e.prototype.update=function(t){this._lastTick=this._tick,this._tick+=t,0===this._lastTick&&(this.onStart(),this._onStartCalled=!0),this.onUpdate(t),this.isAlive()||(this.onFinish(),this._onFinishCalled=!0,this._entityContext.removeBuff(this.uid))},e.prototype.onStart=function(){cc.log("[Buff] onStart, uid: "+this.uid+", type: "+this.constructor.name)},e.prototype.onFinish=function(){cc.log("[Buff] onFinish, uid: "+this.uid+", type: "+this.constructor.name)},e.prototype.onUpdate=function(){},e}(u.BaseEntity);n.Buff=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(f),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onStart=function(){t.prototype.onStart.call(this),this.targetProp.moveSpeed.addPercent(-1)},e.prototype.onFinish=function(){t.prototype.onFinish.call(this),this.targetProp.moveSpeed.addPercent(1)},e}(h),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onStart=function(){t.prototype.onStart.call(this);var e=Math.ceil(this.config.duration/this.config.interval);this._timer=new c.IntervalTimer(this.onDamage.bind(this),this.config.interval,e)},e.prototype.onUpdate=function(t){this._timer.step(t)},e.prototype.onDamage=function(){this.target.hurt(this.config.value,this.owner)},e}(h),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onStart=function(){t.prototype.onStart.call(this),this.target.heal(this.config.value,this.owner)},e}(h),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onStart=function(){t.prototype.onStart.call(this),this.property=this.getProperty(),this.apply()},e.prototype.onFinish=function(){t.prototype.onFinish.call(this),this.revert()},e.prototype.apply=function(){var t,e=this.config.property;if(l.default.DebugBuff&&(t=this.property.get()),this.property.addValue(e.type,e.value),l.default.DebugBuff){var n=this.property.get();cc.log("[PropertyBuff] onStart, type: "+e.type+", value: "+t+" -> "+n)}},e.prototype.revert=function(){var t,e=this.config.property;switch(l.default.DebugBuff&&(t=this.property.get()),e.type){case a.PropertyModType.Base:this.property.addBase(-e.value);break;case a.PropertyModType.Percent:this.property.addPercent(-e.value);break;case a.PropertyModType.External:this.property.addExternal(-e.value)}if(l.default.DebugBuff){var n=this.property.get();cc.log("[PropertyBuff] onFinish, type: "+e.type+", value: "+t+" -> "+n)}},e}(h),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getProperty=function(){return this.targetProp.moveSpeed},e}(g),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getProperty=function(){return this.targetProp.attackSpeed},e}(g),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getProperty=function(){return this.targetProp.hurt},e}(g),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getProperty=function(){return this.targetProp.attack},e}(g),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onStart=function(){t.prototype.onStart.call(this),this.targetProp.defense.addExternal(l.default.InvincibleDefense)},e.prototype.onFinish=function(){t.prototype.onFinish.call(this),this.targetProp.defense.addExternal(-l.default.InvincibleDefense)},e}(h),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onStart=function(){t.prototype.onStart.call(this),this.target.hurt(-this.target.getHp(),this.owner)},e}(h),A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onUpdate=function(e){t.prototype.onUpdate.call(this,e),this.target.isAlive()||this.target.castAbility(this.config.value,null)},e}(h);cc._RF.pop()},{"../../Interface/Config/BuffConfig":"BuffConfig","../../Module/ConfigManager":"ConfigManager","../../Utils/Timer":"Timer","../GameDefine":"GameDefine","./BaseEntity":"BaseEntity"}],BulletConfig:[function(t,e,n){"use strict";cc._RF.push(e,"35cb5TnC3RFGrK0IXJpphOd","BulletConfig"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],Bullet:[function(t,e,n){"use strict";cc._RF.push(e,"8a46162XRFEuZAPPyC17BFo","Bullet");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.Bullet=void 0;var a=i(t("../../Component/Gameplay/CollisionWrapper")),s=i(t("../../Component/Gameplay/EntityTag")),c=t("../../Module/ConfigManager"),l=i(t("../../Utils/Path")),u=i(t("../../Utils/Utils")),p=t("./AvatarEntity"),f=t("./Enemy"),h=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.config=c.ConfigManager.instance.getBulletConfig(o.id),o}return r(e,t),e.prototype.onAvatarReady=function(){var t=this.avatar.getComponent(cc.Collider);u.default.getOrAddComponent(t.node,s.default).entity=this;var e=u.default.getOrAddComponent(t.node,a.default);e.onEnter.clear(),e.onEnter.add(this.onCollisionEnter,this),this.avatar.zIndex=3e3},e.prototype.getAssetPath=function(){return l.default.getEntityPath(this.config.asset)},e.prototype.update=function(t){if(this.avatar){if(this.trackTarget){var n=this.direction=this.trackTarget.avatar.getPosition(cc.v2()).sub(this.position);n.normalizeSelf(),n.mulSelf(t),n.addSelf(this.position),this.position=n}else{var o=this.direction.mul(t*this.config.moveSpeed);o.addSelf(this.position),this.position=o}var r=u.default.directionToAngle(this.direction);this.avatar.angle=r-e.BulletInitRotation;var i=this.position;(Math.abs(i.x)>500||Math.abs(i.y)>800)&&this._context.entityManager.removeBullet(this.uid)}},e.prototype.onCollisionEnter=function(t){var e=t.node.getComponent(s.default);null!=e.entity?e.entity instanceof f.Enemy?(e.entity.hurt(this.config.attack,this.owner),this._context.entityManager.removeBullet(this.uid)):cc.error("[Bullet] onCollision, other entity is not Enemy: "+e.entity):cc.error("[Bullet] onCollision, other entity is null")},e.prototype.toString=function(){return"Bullet: "+this.config.name+"["+this.uid+"]"},e.BulletInitRotation=90,e}(p.AvatarEntity);n.Bullet=h,cc._RF.pop()},{"../../Component/Gameplay/CollisionWrapper":"CollisionWrapper","../../Component/Gameplay/EntityTag":"EntityTag","../../Module/ConfigManager":"ConfigManager","../../Utils/Path":"Path","../../Utils/Utils":"Utils","./AvatarEntity":"AvatarEntity","./Enemy":"Enemy"}],BusyCircle:[function(t,e,n){"use strict";cc._RF.push(e,"f4b47t7xEdBQbt6zGoOWzCc","BusyCircle");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.firstTile=null,e.tiles=12,e.minOpacity=120,e.startColor=cc.Color.GRAY,e.endColor=cc.Color.WHITE,e}return r(e,t),e.prototype.onLoad=function(){var t=360/this.tiles,e=this.firstTile.parent,n=this.firstTile;n.angle=0,n.opacity=255;for(var o=[n],r=n.getPosition(),i=1;i<this.tiles;++i)(a=cc.instantiate(this.firstTile)).parent=e,a.setPosition(r),a.angle=i*t,o.push(a);for(i=0;i<o.length;++i){var a=o[i],s=i/o.length,c=1*(1-s),l=cc.Color.lerp(cc.color(),this.startColor,this.endColor,s);a.color=l,cc.tween(a).to(c,{color:this.endColor}).sequence(cc.tween().set({color:this.startColor}),cc.tween().to(1,{color:this.endColor})).repeatForever().start()}},i([c(cc.Node)],e.prototype,"firstTile",void 0),i([c],e.prototype,"tiles",void 0),i([c],e.prototype,"minOpacity",void 0),i([c(cc.Color)],e.prototype,"startColor",void 0),i([c(cc.Color)],e.prototype,"endColor",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],BusyView:[function(t,e,n){"use strict";cc._RF.push(e,"d1a76Dp/xdNSqN/w5aQFq3Z","BusyView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=c(t("../../../Module/Loader")),u=c(t("../../../Utils/Path")),p=cc._decorator,f=p.ccclass,h=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.circlePrefab=null,e}var n;return r(e,t),n=e,e.show=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return this._isLoading?(this._show=!0,[2]):(this._show=!0,cc.isValid(this._node)?[3,2]:(this._isLoading=!0,[4,l.default.loadPrefabAsync(u.default.viewPath("BusyView"),null)]));case 1:t=o.sent(),this._isLoading=!1,this._node=cc.instantiate(t),e=cc.Canvas.instance,this._node.parent=e.node,o.label=2;case 2:return this._show?this._node.getComponent(n).show():this._node.getComponent(n).hide(),[2]}})})},e.hide=function(){this._isLoading?this._show=!1:cc.isValid(this._node)&&this._node.getComponent(n).hide()},e.prototype.show=function(){this.node.active=!0,this._circle||(this._circle=cc.instantiate(this.circlePrefab),this._circle.parent=this.node)},e.prototype.hide=function(){this._circle&&(this._circle.destroy(),this._circle=null),this.node.active=!1},e._isLoading=!1,e._show=!1,i([h(cc.Prefab)],e.prototype,"circlePrefab",void 0),n=i([f],e)}(cc.Component);n.default=d,cc._RF.pop()},{"../../../Module/Loader":"Loader","../../../Utils/Path":"Path"}],ButtonEffect:[function(t,e,n){"use strict";cc._RF.push(e,"beba1YJhhJPj4QpfeXtGnLC","ButtonEffect");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Module/Audio")),c=a(t("../../Utils/Path")),l=cc._decorator,u=l.ccclass,p=(l.property,l.menu),f=l.requireComponent,h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){this.node.on("click",this.onClick,this)},e.prototype.onDestroy=function(){this.node.targetOff(this)},e.prototype.onClick=function(){s.default.instance.playEffect(c.default.effectPath("click"))},i([u,p("Utils/ButtonEffect"),f(cc.Button)],e)}(cc.Component);n.default=h,cc._RF.pop()},{"../../Module/Audio":"Audio","../../Utils/Path":"Path"}],1:[function(){},{}],CardConfig:[function(t,e,n){"use strict";cc._RF.push(e,"639d8WrFTlE15/ke0rzpsog","CardConfig"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],CardInfoNode:[function(t,e,n){"use strict";cc._RF.push(e,"0e52ebktU1A7pAAlqBBIXzL","CardInfoNode");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=c(t("../../Module/Loader")),u=c(t("../../Module/ViewHandler")),p=c(t("../../Utils/Path")),f=c(t("../../Utils/Utils")),h=cc._decorator,d=h.ccclass,y=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelName=null,e.labelContent=null,e.guardRoot=null,e._guardId=null,e}return r(e,t),e.prototype.initiateView=function(t){f.default.localize(this.labelName,"guard_"+t+"_name"),f.default.localize(this.labelContent,"guard_"+t+"_desc"),this._guardId=t,this.initGuard()},e.prototype.initGuard=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return this.guardRoot.removeAllChildren(),t=p.default.getEntityPath("Guards/Guard_"+this._guardId),[4,l.default.loadResAsync(t,cc.Prefab,null)];case 1:return e=n.sent(),cc.instantiate(e).parent=this.guardRoot,[2]}})})},e.prototype.onClose=function(){this.node.destroy()},i([y(cc.Label)],e.prototype,"labelName",void 0),i([y(cc.Label)],e.prototype,"labelContent",void 0),i([y(cc.Node)],e.prototype,"guardRoot",void 0),i([d],e)}(u.default);n.default=_,cc._RF.pop()},{"../../Module/Loader":"Loader","../../Module/ViewHandler":"ViewHandler","../../Utils/Path":"Path","../../Utils/Utils":"Utils"}],CardNode:[function(t,e,n){"use strict";cc._RF.push(e,"8d74aqMoBdKrr0WvE8hU6ID","CardNode");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../../Gameplay/System/WeaponSystem"),u=t("../../Module/ConfigManager"),p=c(t("../../Module/Loader")),f=c(t("../../Module/ViewHandler")),h=c(t("../../Utils/Path")),d=c(t("../../Utils/Utils")),y=cc._decorator,_=y.ccclass,g=y.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelRemove=null,e.labelInfo=null,e.labelName=null,e.labelType=null,e.btnNode=null,e.cardBg=null,e.showBox=null,e._guardId=null,e._manager=null,e}return r(e,t),e.prototype.initiateView=function(t){var e=this;d.default.localize(this.labelName,"guard_"+t.id+"_name"),d.default.localize(this.labelRemove,"ui_remove"),d.default.localize(this.labelInfo,"ui_info");var n=u.ConfigManager.instance.getGuardConfig(t.id);if(n.tags[1]){var o="guard_"+n.tags[1];d.default.localize(this.labelType,o)}d.default.loadImg(this.cardBg,h.default.getGuardQualityPath(n.quality)),this._guardId=t.id,this._manager=t.view,this.btnNode.active=!1,this.initShowBox(),l.WeaponSystem.instance.targetOff(this),l.WeaponSystem.instance.on(l.WeaponSystem.Events.CardInfo,function(t){e.btnNode.active=t==e._guardId},this)},e.prototype.initShowBox=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return t=h.default.getEntityPath("Guards/Guard_"+this._guardId),[4,p.default.loadResAsync(t,cc.Prefab,null)];case 1:return e=n.sent(),cc.instantiate(e).parent=this.showBox,[2]}})})},e.prototype.onShowBtn=function(){this.btnNode.active?this.btnNode.active=!1:l.WeaponSystem.instance.sendMessage(l.WeaponSystem.Events.CardInfo,this._guardId)},e.prototype.onShowInfo=function(){this._manager.createCardInfoNode(this._guardId)},e.prototype.onRemove=function(){var t=this._manager.getSelectLineupIndex();l.WeaponSystem.instance.updateLineup(t,this._guardId,l.UpdateLineup.remove)},i([g(cc.Label)],e.prototype,"labelRemove",void 0),i([g(cc.Label)],e.prototype,"labelInfo",void 0),i([g(cc.Label)],e.prototype,"labelName",void 0),i([g(cc.Label)],e.prototype,"labelType",void 0),i([g(cc.Node)],e.prototype,"btnNode",void 0),i([g(cc.Sprite)],e.prototype,"cardBg",void 0),i([g(cc.Node)],e.prototype,"showBox",void 0),i([_],e)}(f.default);n.default=v,cc._RF.pop()},{"../../Gameplay/System/WeaponSystem":"WeaponSystem","../../Module/ConfigManager":"ConfigManager","../../Module/Loader":"Loader","../../Module/ViewHandler":"ViewHandler","../../Utils/Path":"Path","../../Utils/Utils":"Utils"}],ChatNode:[function(t,e,n){"use strict";cc._RF.push(e,"d0fcbxDwE1OmJktNZqv80YP","ChatNode");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=c(t("../Gameplay/GameDefine")),u=t("../Gameplay/System/HomeSystem"),p=t("../Module/ConfigManager"),f=c(t("../Module/Loader")),h=t("../Utils/NodePool"),d=c(t("../Utils/Path")),y=c(t("../Utils/Utils")),_=cc._decorator,g=_.ccclass,v=_.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelRoot=null,e._labelNodeArr=[],e._startRandomStrIndex=null,e._scrolling=!1,e._maxHeight=0,e._curAllLabelHeight=0,e._lastNode=null,e._strArr=[],e}return r(e,t),e.prototype.start=function(){var t=this;this.labelRoot.removeAllChildren(),this._maxHeight=this.labelRoot.height,this._curAllLabelHeight=0,this._lastNode=null,this._curAllLabelHeight=0,this._strArr=[],this._startRandomStrIndex=null,this._labelNodeArr=[],this.initLabelNode(),u.HomeSystem.instance.targetOff(this),u.HomeSystem.instance.on(u.HomeSystem.Events.OnSummon,function(e){t.startCreateInfo(e)},this),u.HomeSystem.instance.on(u.HomeSystem.Events.OnSummonEnd,function(){t.updateLabelNode(t._strArr[0])},this)},e.prototype.initLabelNode=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return t=d.default.getSummonInfoNodePath(),[4,f.default.loadResAsync(t,cc.Prefab,null)];case 1:return e=n.sent(),h.NodePool.instance.tryCreatePool(t,e),[2]}})})},e.prototype.startCreateInfo=function(t){var e=y.default.randomRangeInt(1,l.default.MaxLabelIndex+1),n="summon_"+e,o="guard_"+t.guardId+"_name",r="<color=#F1BF38><b>"+p.ConfigManager.instance.getLanConfig(o)+"</b></color>",i=y.default.replaceStr(n,r);this._startRandomStrIndex=e,this._strArr.push(i);var a,s=t.heroSoul,c=p.ConfigManager.instance.getLanConfig("item_3_name");a=s>1?"summon_"+this._startRandomStrIndex+"_success":"summon_"+this._startRandomStrIndex+"_failed";var u="<color=#0fffff><b>\u3010"+c+"\u3011</b></color>",f="<color=#FF0000><b>x</b></color><color=#FF0000><b>"+s+"</b></color>",h=y.default.replaceStr(a,r,u,f);this._strArr.push(h),this.updateLabelNode(this._strArr[0])},e.prototype.updateLabelNode=function(t){var e=this;if(!this._scrolling)if(this._scrolling=!0,this._curAllLabelHeight<this._maxHeight){var n=h.NodePool.instance.getNode(d.default.getSummonInfoNodePath());if(n.parent=this.labelRoot,n.getComponent(cc.RichText).string=t,this._strArr.shift(),this._lastNode){var o=this._lastNode.y-this._lastNode.height-5;n.y=o}else n.y=0;this._lastNode=n,this._labelNodeArr.push(n),this._curAllLabelHeight+=n.height+5,this._scrolling=!1}else for(var r=this._labelNodeArr.length,i=this._labelNodeArr[0].height+5,a=0;a<this._labelNodeArr.length;a++){var s=this._labelNodeArr[a];cc.tween(s).by(1,{y:i}).call(function(){if(--r<=0){e._curAllLabelHeight-=i,e._scrolling=!1;var t=e._labelNodeArr.shift();h.NodePool.instance.putNode(t)}}).start()}},i([v(cc.Node)],e.prototype,"labelRoot",void 0),i([g],e)}(cc.Component);n.default=m,cc._RF.pop()},{"../Gameplay/GameDefine":"GameDefine","../Gameplay/System/HomeSystem":"HomeSystem","../Module/ConfigManager":"ConfigManager","../Module/Loader":"Loader","../Utils/NodePool":"NodePool","../Utils/Path":"Path","../Utils/Utils":"Utils"}],ClawGuideType:[function(t,e,n){"use strict";cc._RF.push(e,"1a2a5jnX8RGx64Tpo4mUf2Q","ClawGuideType"),Object.defineProperty(n,"__esModule",{value:!0}),n.ClawGuideType=void 0,function(t){t[t.TREASURE_PROGRESS=0]="TREASURE_PROGRESS",t[t.NPC_PROGRESS=1]="NPC_PROGRESS",t[t.COOK_SPEED_UP=2]="COOK_SPEED_UP",t[t.BUILDING_UPGRADE=3]="BUILDING_UPGRADE",t[t.HUNGRY_SALE=4]="HUNGRY_SALE",t[t.BUILDING_SKIN=5]="BUILDING_SKIN",t[t.GUEST_ORDER=6]="GUEST_ORDER",t[t.TIME_RESEARCH_SUCCESS_RATE=7]="TIME_RESEARCH_SUCCESS_RATE",t[t.OPEN_STATUE=8]="OPEN_STATUE"}(n.ClawGuideType||(n.ClawGuideType={})),cc._RF.pop()},{}],CmdClient:[function(t,e,n){"use strict";cc._RF.push(e,"dbc61pLX4tMEIuUSCYdW5Te","CmdClient"),Object.defineProperty(n,"__esModule",{value:!0}),n.Cmd=void 0,(n.Cmd||(n.Cmd={})).connector_main_ping="connector.main.ping",cc._RF.pop()},{}],CollectGuardItem:[function(t,e,n){"use strict";cc._RF.push(e,"ae4186r3LVHaL4AB2TfmglK","CollectGuardItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Component/Utils/TableView/TableViewItem")),c=t("../../Gameplay/System/WeaponSystem"),l=t("../../Module/ConfigManager"),u=a(t("../../Module/ViewModule")),p=a(t("../../Utils/Path")),f=a(t("../../Utils/Utils")),h=cc._decorator,d=h.ccclass,y=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.img=null,e.outline=null,e.focus=null,e.tagNode=null,e.labelTag=null,e.labelType=null,e._collectView=null,e._data=null,e}return r(e,t),e.prototype.init=function(t,e){var n=this;this._collectView=e,this._data=t,this._view=this._data.view;var o=l.ConfigManager.instance.getGuardConfig(this._data.id),r=p.default.getAvatar(o.avatarAsset),i=p.default.getItemOutlinePath(t.quality);if(f.default.loadImg(this.img,r,60),f.default.loadImg(this.outline,i),o.tags[1]){var a="guard_"+o.tags[1];f.default.localize(this.labelType,a)}this.img.node.opacity=t.isUnlock?255:50,this.labelType.node.parent.active=!!t.isUnlock,t.isUnlock?f.default.ungray(this.img.node):f.default.gray(this.img.node),this.updateTagStr(),c.WeaponSystem.instance.targetOff(this),c.WeaponSystem.instance.on(c.WeaponSystem.Events.SelectCardGroup,function(t){n.onHighlight(n._data.id==t)},this),c.WeaponSystem.instance.on(c.WeaponSystem.Events.RemoveCardGroupFromLineup,function(){n.updateTagStr()},this),c.WeaponSystem.instance.on(c.WeaponSystem.Events.AddCardGroupToLineup,function(){n.updateTagStr()})},e.prototype.updateTagStr=function(){var t=c.WeaponSystem.instance.getWhichLineup(this._data.id);this.tagNode.active=0!=t,this.labelTag.string=""+t},e.prototype.onSelect=function(){this._data.isUnlock?this._view.onChangeSelectId(this._data.id):u.default.instance.toast("toast_unlock")},e.prototype.onHighlight=function(t){this.focus.active=t},i([y(cc.Sprite)],e.prototype,"img",void 0),i([y(cc.Sprite)],e.prototype,"outline",void 0),i([y(cc.Node)],e.prototype,"focus",void 0),i([y(cc.Node)],e.prototype,"tagNode",void 0),i([y(cc.Label)],e.prototype,"labelTag",void 0),i([y(cc.Label)],e.prototype,"labelType",void 0),i([d],e)}(s.default);n.default=_,cc._RF.pop()},{"../../Component/Utils/TableView/TableViewItem":"TableViewItem","../../Gameplay/System/WeaponSystem":"WeaponSystem","../../Module/ConfigManager":"ConfigManager","../../Module/ViewModule":"ViewModule","../../Utils/Path":"Path","../../Utils/Utils":"Utils"}],CollectView:[function(t,e,n){"use strict";cc._RF.push(e,"6f2b1OxYwJFT4ffhx+PkAzL","CollectView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var p=u(t("../../Component/Utils/TableView/TableView")),f=t("../../Gameplay/System/WeaponSystem"),h=t("../../Interface/SaveData/WeaponData"),d=t("../../Module/ConfigManager"),y=u(t("../../Module/ViewHandler")),_=u(t("../../Module/ViewModule")),g=u(t("../../Utils/Utils")),v=u(t("./CardNode")),m=u(t("../../Gameplay/GameDefine")),b=u(t("./CardInfoNode")),w=cc._decorator,S=w.ccclass,C=w.property,A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cardView=null,e.labelName=null,e.guardRoot=null,e.cardInfoRoot=null,e.topBtns=null,e.cardNode=null,e.cardInfoNode=null,e._selectGuardId=null,e._selectLineupIndex=null,e._btnMap=new Map,e}return r(e,t),e.prototype.initiateView=function(){this._selectLineupIndex=f.WeaponSystem.instance.getCurLineupIndex(),g.default.localize(this.labelName,"ui_collect"),this.cardView.setLinesData(this._handleGuardData()),this.initShowBox(),this.initBtnMap()},e.prototype.initShowBox=function(){return a(this,void 0,void 0,function(){var t,e,n;return s(this,function(){for(this.guardRoot.removeAllChildren(),t=f.WeaponSystem.instance.getAnyLineup(this._selectLineupIndex),e=0;e<t.length;e++)n=t[e],this.createGuardCard(n);return[2]})})},e.prototype.initBtnMap=function(){for(var t=this.topBtns.children,e=0;e<t.length;e++)this._btnMap.set(e+1,t[e])},e.prototype.getSelectLineupIndex=function(){return this._selectLineupIndex},e.prototype.createGuardCard=function(t){var e=cc.instantiate(this.cardNode);e.parent=this.guardRoot,e.getComponent(v.default).initiateView({id:t,view:this})},e.prototype.createCardInfoNode=function(t){var e=cc.instantiate(this.cardInfoNode);e.parent=this.cardInfoRoot,e.getComponent(b.default).initiateView(t)},e.prototype.onChangeSelectId=function(t){this._selectGuardId=t},e.prototype.onChangeLineup=function(t,e){var n,o;if(e!=this._selectLineupIndex){this._selectLineupIndex=e;try{for(var r=c(this._btnMap),i=r.next();!i.done;i=r.next()){var a=l(i.value,2),s=a[0];a[1].getChildByName("active").active=s==e}}catch(u){n={error:u}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}this.initShowBox()}},e.prototype.onEquipt=function(){if(this._selectGuardId){var t=f.WeaponSystem.instance.getAllLineups();t[this._selectLineupIndex].length>=m.default.MaxLineupCardNum?_.default.instance.toast("warn_maxCardNum"):t[this._selectLineupIndex].includes(this._selectGuardId)?_.default.instance.toast("warn_sameCard"):f.WeaponSystem.instance.updateLineup(this._selectLineupIndex,this._selectGuardId,f.UpdateLineup.add)}else _.default.instance.toast("warn_noCard")},e.prototype.onClose=function(){this._closeTableViews(),_.default.instance.popView(this)},e.prototype._closeTableViews=function(){this.cardView.clear()},e.prototype._handleGuardData=function(){var t=[],e=f.WeaponSystem.instance.getAllCards(),n=[];for(var o in e){var r=e[o],i=r.status!=h.ICardStatus.Lock;if(1!=r.id)for(var a=r.guards,s=0;s<a.length;s++){var c=a[s];n.push({id:c,isUnlock:i})}}var l=[];for(s=0;s<n.length;s++){var u={id:c=n[s].id,isUnlock:i=n[s].isUnlock,quality:d.ConfigManager.instance.getGuardConfig(c).quality,view:this};l.push(u)}return l.sort(function(t,e){return t.quality-e.quality}),t.push({data:l}),t},i([C(p.default)],e.prototype,"cardView",void 0),i([C(cc.Label)],e.prototype,"labelName",void 0),i([C(cc.Node)],e.prototype,"guardRoot",void 0),i([C(cc.Node)],e.prototype,"cardInfoRoot",void 0),i([C(cc.Node)],e.prototype,"topBtns",void 0),i([C(cc.Prefab)],e.prototype,"cardNode",void 0),i([C(cc.Prefab)],e.prototype,"cardInfoNode",void 0),i([S],e)}(y.default);n.default=A,cc._RF.pop()},{"../../Component/Utils/TableView/TableView":"TableView","../../Gameplay/GameDefine":"GameDefine","../../Gameplay/System/WeaponSystem":"WeaponSystem","../../Interface/SaveData/WeaponData":"WeaponData","../../Module/ConfigManager":"ConfigManager","../../Module/ViewHandler":"ViewHandler","../../Module/ViewModule":"ViewModule","../../Utils/Utils":"Utils","./CardInfoNode":"CardInfoNode","./CardNode":"CardNode"}],ColliderTest:[function(t,e,n){"use strict";cc._RF.push(e,"eb6afME0K9BIJUAsnAP0uRi","ColliderTest");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.normalColor=cc.Color.BLUE,e.collideColor=cc.Color.RED,e}return r(e,t),e.prototype.start=function(){var t=this;cc.director.getCollisionManager().enabled=!0,cc.director.getCollisionManager().enabledDebugDraw=!0,this.getComponentsInChildren(cc.Sprite).forEach(function(e){return e.node.color=t.normalColor})},e.prototype.onCollisionEnter=function(){var t=this;this.getComponentsInChildren(cc.Sprite).forEach(function(e){return e.node.color=t.collideColor})},e.prototype.onCollisionStay=function(){},e.prototype.onCollisionExit=function(){var t=this;this.getComponentsInChildren(cc.Sprite).forEach(function(e){return e.node.color=t.normalColor})},i([c(cc.Color)],e.prototype,"normalColor",void 0),i([c(cc.Color)],e.prototype,"collideColor",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],CollisionWrapper:[function(t,e,n){"use strict";cc._RF.push(e,"2b006x3fI5HCI8wS6ie8LKH","CollisionWrapper");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Utils/Action"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onEnter=new a.Action2,e.onStay=new a.Action2,e.onExit=new a.Action2,e}return r(e,t),e.prototype.onCollisionEnter=function(t,e){this.onEnter.call(t,e)},e.prototype.onCollisionStay=function(t,e){this.onStay.call(t,e)},e.prototype.onCollisionExit=function(t,e){this.onExit.call(t,e)},i([c],e)}(cc.Component));n.default=l,cc._RF.pop()},{"../../Utils/Action":"Action"}],ColorAssembler2D:[function(t,e,n){"use strict";cc._RF.push(e,"834a0oo2pRDm7VyZxgk49sy","ColorAssembler2D");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=a.executeInEditMode,u=a.requireComponent,p=a.menu,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colors=[],e}return r(e,t),Object.defineProperty(e.prototype,"colors",{get:function(){return this._colors},set:function(t){this._colors=t,this._updateColors()},enumerable:!1,configurable:!0}),e.prototype.onEnable=function(){cc.director.once(cc.Director.EVENT_AFTER_DRAW,this._updateColors,this)},e.prototype.onDisable=function(){cc.director.off(cc.Director.EVENT_AFTER_DRAW,this._updateColors,this),this.node._renderFlag|=cc.RenderFlow.FLAG_COLOR},e.prototype._updateColors=function(){var t=this.getComponent(cc.RenderComponent);if(t){var e=t._assembler;if(e instanceof cc.Assembler2D){var n=e._renderData.uintVDatas[0];if(n)for(var o=this.node.color,r=e.floatsPerVert,i=0,a=e.colorOffset,s=n.length;a<s;a+=r)n[a]=(this.colors[i++]||o)._val}}},i([c],e.prototype,"_colors",void 0),i([c({type:[cc.Color]})],e.prototype,"colors",null),i([s,l,u(cc.RenderComponent),p("i18n:MAIN_MENU.component.renderers/ColorAssembler2D-lamyoung.com")],e)}(cc.Component);n.default=f,cc._RF.pop()},{}],Common:[function(t,e,n){"use strict";cc._RF.push(e,"a9839GlDRJEL6lLAOb/Ez4w","Common"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],CompareView:[function(t,e,n){"use strict";cc._RF.push(e,"08ab0zXDnZEWb6XUP8JfMpq","CompareView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../Gameplay/System/BagSystem"),c=t("../Module/ConfigManager"),l=a(t("../Module/ViewHandler")),u=a(t("../Utils/Path")),p=a(t("../Utils/Utils")),f=cc._decorator,h=f.ccclass,d=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.labelConfirm=null,e.labelDecompose=null,e.labelOriGemName=null,e.labelNewGemName=null,e.newGemSp=null,e.oldGemSp=null,e.labelNode=null,e.oldEntryNode=null,e.newEntryNode=null,e.labelNewScore=null,e.labelOldScore=null,e.newGemLightSp=null,e.oldGemLightSp=null,e._callback=null,e._partIndex=null,e._newGem=null,e}return r(e,t),e.prototype.initiateView=function(t){var e=t.info,n=e.oldGem,o=e.newGem,r=t.index,i=t.cb;this._callback=i,this._partIndex=r,this._newGem=o;var a=p.default.replaceStr("ui_slotIndex",r+1),s=c.ConfigManager.instance.getLanConfig("ui_gemQuality_"+o.quality);this.labelTitle.string=s+a,p.default.localize(this.labelConfirm,"ui_replace"),p.default.localize(this.labelDecompose,"ui_inBag"),p.default.localize(this.labelNewGemName,"gem_"+this._partIndex+"_name"),p.default.localize(this.labelOriGemName,"gem_"+this._partIndex+"_name"),this.labelNewScore.string=p.default.replaceStr("ui_score",o.score),this.labelOldScore.string=p.default.replaceStr("ui_score",n.score);var l=u.default.getItemLightPath(o.quality),f=u.default.getItemLightPath(n.quality);p.default.loadImg(this.newGemLightSp,l,200),p.default.loadImg(this.oldGemLightSp,f,200);var h=u.default.getGemPath(o.id),d=u.default.getGemPath(n.id);p.default.loadImg(this.newGemSp,h,80),p.default.loadImg(this.oldGemSp,d,80),this.initLabelNodes(n,o)},e.prototype.initLabelNodes=function(t,e){this.oldEntryNode.removeAllChildren(),this.newEntryNode.removeAllChildren();for(var n=function(t,e){t.getChildByName("labelContent").getComponent(cc.Label).string=p.default.getEntryInfoDesc(e),t.getChildByName("labelStar").getComponent(cc.Label).string=p.default.replaceStr("ui_entry",e.quality);var n=t.getChildByName("labelProgress").getComponent(cc.Label),o=Math.round(100*e.progress);n.node.color=p.default.getLabelColor(o),n.string=o+"%"},o=0;o<t.entryInfo.length;o++){var r=t.entryInfo[o];(i=cc.instantiate(this.labelNode)).parent=this.oldEntryNode,n(i,r)}for(o=0;o<e.entryInfo.length;o++){var i;r=e.entryInfo[o],(i=cc.instantiate(this.labelNode)).parent=this.newEntryNode,n(i,r)}},e.prototype.onConfirm=function(){this.close(),this._callback(!0)},e.prototype.onDecompose=function(){s.BagSystem.instance.isGemCapacityEnough(1)&&(s.BagSystem.instance.addGem(1,this._newGem),this.close(),this._callback(!1))},i([d(cc.Label)],e.prototype,"labelTitle",void 0),i([d(cc.Label)],e.prototype,"labelConfirm",void 0),i([d(cc.Label)],e.prototype,"labelDecompose",void 0),i([d(cc.Label)],e.prototype,"labelOriGemName",void 0),i([d(cc.Label)],e.prototype,"labelNewGemName",void 0),i([d(cc.Sprite)],e.prototype,"newGemSp",void 0),i([d(cc.Sprite)],e.prototype,"oldGemSp",void 0),i([d(cc.Prefab)],e.prototype,"labelNode",void 0),i([d(cc.Node)],e.prototype,"oldEntryNode",void 0),i([d(cc.Node)],e.prototype,"newEntryNode",void 0),i([d(cc.Label)],e.prototype,"labelNewScore",void 0),i([d(cc.Label)],e.prototype,"labelOldScore",void 0),i([d(cc.Sprite)],e.prototype,"newGemLightSp",void 0),i([d(cc.Sprite)],e.prototype,"oldGemLightSp",void 0),i([h],e)}(l.default);n.default=y,cc._RF.pop()},{"../Gameplay/System/BagSystem":"BagSystem","../Module/ConfigManager":"ConfigManager","../Module/ViewHandler":"ViewHandler","../Utils/Path":"Path","../Utils/Utils":"Utils"}],ConditionView:[function(t,e,n){"use strict";cc._RF.push(e,"eddeaVM+R1Jho29M5nlQ95Q","ConditionView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../Gameplay/System/BagSystem"),c=t("../Module/ConfigManager"),l=a(t("../Module/ViewHandler")),u=a(t("../Module/ViewModule")),p=a(t("../Utils/Path")),f=a(t("../Utils/Utils")),h=cc._decorator,d=h.ccclass,y=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.labelConfirm=null,e.labelCancel=null,e.labelContent=null,e.itemNodes=null,e.itemNode=null,e._callback=null,e._conditions=null,e}return r(e,t),e.prototype.initiateView=function(t){var e=t.conditions,n=t.contentKey,o=t.cb;this._callback=o,this._conditions=e,f.default.localize(this.labelTitle,"ui_condition"),f.default.localize(this.labelConfirm,"ui_confirm"),f.default.localize(this.labelCancel,"ui_cancel"),f.default.localize(this.labelContent,n),this.initItems()},e.prototype.initItems=function(){this.itemNodes.removeAllChildren();for(var t=0;t<this._conditions.length;t++){var e=this._conditions[t],n=cc.instantiate(this.itemNode);n.parent=this.itemNodes,n.getChildByName("labelNum").getComponent(cc.Label).string=""+e.count;var o=n.getChildByName("img").getComponent(cc.Sprite),r=n.getChildByName("imgOutline").getComponent(cc.Sprite),i=p.default.getItemPath(e.id),a=p.default.getItemOutlinePath(e.quality||1);f.default.loadImg(o,i,80),f.default.loadImg(r,a,100)}},e.prototype.onCancel=function(){this.close(),this._callback(!1,"toast_user_cancel")},e.prototype.onConfirm=function(){for(var t=!0,e=0;e<this._conditions.length;e++){var n=this._conditions[e];if(!s.BagSystem.instance.isItemEnough(n.id,n.count)){var o=n.count-s.BagSystem.instance.getItemCount(n.id),r=c.ConfigManager.instance.getLanConfig("item_"+n.id+"_name");u.default.instance.toast("toast_needItem",r,o),t=!1;break}}this._callback(t),this.close()},i([y(cc.Label)],e.prototype,"labelTitle",void 0),i([y(cc.Label)],e.prototype,"labelConfirm",void 0),i([y(cc.Label)],e.prototype,"labelCancel",void 0),i([y(cc.Label)],e.prototype,"labelContent",void 0),i([y(cc.Node)],e.prototype,"itemNodes",void 0),i([y(cc.Prefab)],e.prototype,"itemNode",void 0),i([d],e)}(l.default);n.default=_,cc._RF.pop()},{"../Gameplay/System/BagSystem":"BagSystem","../Module/ConfigManager":"ConfigManager","../Module/ViewHandler":"ViewHandler","../Module/ViewModule":"ViewModule","../Utils/Path":"Path","../Utils/Utils":"Utils"}],ConfigManager:[function(t,e,n){"use strict";cc._RF.push(e,"4233ecUPplERpCUvnSrTMTZ","ConfigManager");var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.ConfigManager=void 0;var a=i(t("./Loader")),s=i(t("../Utils/Path")),c=t("../Interface/Config/LanConfig"),l=t("./ConfigParser"),u=i(t("../Utils/Utils")),p=function(){function t(){this._allConfigMap=null,this._guardMap=new Map,this._playerMap=new Map,this._bulletMap=new Map,this._enemyMap=new Map,this._abilityMap=new Map,this._levelMap=new Map,this._levelFlowMap=new Map,this._stageMap=new Map,this._lanMap=new Map,this._entryMap=new Map,this._buffMap=new Map,this._gemMap=new Map,this._weaponMap=new Map,this._cardGroupMap=new Map,this._talkMap=new Map,this._cardMap=new Map,this._partGemMap=new Map,this._lanType=c.LanType.cn}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.init=function(){var t=this;return new Promise(function(e){a.default.loadRes(s.default.getConfigPath(),cc.JsonAsset,function(n){t._allConfigMap=n.json,t.initConfig("Guard",t._guardMap,l.GuardConfigParser),t.initConfig("Bullet",t._bulletMap),t.initConfig("Enemy",t._enemyMap),t.initConfig("Level",t._levelMap),t.initConfig("LevelFlow",t._levelFlowMap),t.initConfig("Stage",t._stageMap),t.initConfig("Entry",t._entryMap),t.initConfig("Buff",t._buffMap),t.initConfig("Ability",t._abilityMap,l.AbilityConfigParser),t.initConfig("Weapon",t._weaponMap),t.initConfig("Gem",t._gemMap),t.initConfig("CardGroup",t._cardGroupMap),t.initConfig("TalkGroup",t._talkMap),t.initConfig("Player",t._playerMap),t.initConfig("Card",t._cardMap),t.initLanConfig("Lan",t._lanMap),t.initPartGemConfig(),e()},null)})},t.prototype.initLanConfig=function(t,e){if(e.clear(),t in this._allConfigMap){var n=this._allConfigMap[t];for(var o in n){var r=o;e.set(r,n[o])}}},t.prototype.initConfig=function(t,e,n){if(e.clear(),t in this._allConfigMap){var o=this._allConfigMap[t];for(var r in o){var i=+r,a=o[r];n&&(a=n.parse(a)),u.default.freeze(a),e.set(i,a)}}},t.prototype.initPartGemConfig=function(){var t,e;this._partGemMap.clear();for(var n=0;n<6;n++)this._partGemMap.set(n,[]);try{for(var i=o(this._gemMap),a=i.next();!a.done;a=i.next()){var s=r(a.value,2),c=(s[0],s[1]),l=+c.index;this._partGemMap.get(l).push(c)}}catch(u){t={error:u}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.getConfig=function(t){return this._allConfigMap[t]},t.prototype.addGuardConfig=function(t){this._guardMap.set(t.id,t)},t.prototype.addEnemyConfig=function(t){this._enemyMap.set(t.id,t)},t.prototype.getCardConfig=function(t){return this._cardMap.get(t)},t.prototype.getTalkConfig=function(t){return this._talkMap.get(t)},t.prototype.getPartGemConfig=function(t){return this._partGemMap.get(t)},t.prototype.getCardGroupConfig=function(t){return this._cardGroupMap.get(t)},t.prototype.getBuffConfig=function(t){return this._buffMap.get(t)},t.prototype.getGemConfig=function(t){return this._gemMap.get(t)},t.prototype.getEntryConfig=function(t){return this._entryMap.get(t)},t.prototype.getWeaponConfig=function(t){return this._weaponMap.get(t)},t.prototype.getGuardConfigs=function(){return this._guardMap},t.prototype.getGuardConfig=function(t){return this._guardMap.get(t)},t.prototype.getBulletConfigs=function(){return this._bulletMap},t.prototype.getBulletConfig=function(t){return this._bulletMap.get(t)},t.prototype.getEnemyConfigs=function(){return this._enemyMap},t.prototype.getEnemyConfig=function(t){return this._enemyMap.get(t)},t.prototype.getAbilityConfigs=function(){return this._abilityMap},t.prototype.getAbilityConfig=function(t){return this._abilityMap.get(t)},t.prototype.getStageConfig=function(t){return this._stageMap.get(t)},t.prototype.getLanConfig=function(t){var e=this._lanMap.get(t);return e?e[this._lanType]:"null"},t.prototype.getLevelConfigs=function(){return this._levelMap},t.prototype.getLevelConfig=function(t){return this._levelMap.get(t)},t.prototype.getLevelFlowConfig=function(t){return this._levelFlowMap.get(t)},t}();n.ConfigManager=p,cc._RF.pop()},{"../Interface/Config/LanConfig":"LanConfig","../Utils/Path":"Path","../Utils/Utils":"Utils","./ConfigParser":"ConfigParser","./Loader":"Loader"}],ConfigParser:[function(t,e,n){"use strict";cc._RF.push(e,"748aehzeyFF25ra5nEiI/MQ","ConfigParser");var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.GuardConfigParser=n.AbilityConfigParser=void 0;var r=t("../Interface/Config/AbilityConfig"),i=o(t("lodash")),a=function(){function t(){}return t.parse=function(t){var e={},n=(t=i.default.cloneDeep(t)).range;if(t.cast,delete t.range,delete t.cast,i.default.assign(e,t),n){var o=n.split(","),a=o[0];switch(a){case r.AbilityRangeType.None:case r.AbilityRangeType.Preset:e.range={type:a};break;case r.AbilityRangeType.Rect:e.range={type:a,width:+o[1],height:+o[2]};break;case r.AbilityRangeType.Circle:e.range={type:a,radius:+o[1]};break;case r.AbilityRangeType.Fan:e.range={type:a,radius:+o[1],rangeAngle:+o[2]};break;default:cc.error("Ability \u8303\u56f4\u7c7b\u578b\u9519\u8bef, id: "+t.id)}}else e.range={type:r.AbilityRangeType.None};return e},t}();n.AbilityConfigParser=a;var s=function(){function t(){}return t.parse=function(t){var e={},n=(t=i.default.cloneDeep(t)).cast;if(delete t.cast,i.default.assign(e,t),n){var o=n.split(","),r=o[0];switch(r){case"Scatter":e.cast={type:r,count:+o[1],angle:+o[2]};break;default:cc.error("Guard \u91ca\u653e\u7c7b\u578b\u9519\u8bef, id: "+t.id)}}return e},t}();n.GuardConfigParser=s,cc._RF.pop()},{"../Interface/Config/AbilityConfig":"AbilityConfig",lodash:13}],ConfirmCommonView:[function(t,e,n){"use strict";cc._RF.push(e,"066165pzkBJTJvXOdOaReMx","ConfirmCommonView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../../Module/ConfigManager"),u=c(t("../../Module/ViewHandler")),p=c(t("../../Module/ViewModule")),f=c(t("../../Module/Audio")),h=c(t("../../Utils/Path")),d=c(t("../../Utils/Platform")),y=c(t("../../Utils/Utils")),_=cc._decorator,g=_.ccclass,v=_.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.refuseBtn=null,e.confirmBtn=null,e.content=null,e.labelRefuse=null,e.labelConfirm=null,e.icon_ad=null,e.adIcon=null,e._handler=null,e}return r(e,t),e.show=function(t){p.default.instance.pushView("ConfirmCommonView",t)},e.prototype.start=function(){},e.prototype.initiateView=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(){return d.default.isBytedance()?(this.adIcon.node.scale=.3,this.adIcon.node.y=8):(this.adIcon.node.scale=1,this.adIcon.node.y=10),y.default.loadImg(this.adIcon,h.default.getAdIconByPlatForm()),e=l.ConfigManager.instance.getLanConfig(t.content),this.content.string=e||t.content,this.labelConfirm.string=t.confirmStr,t.refuseStr?(this.refuseBtn.node.active=!0,this.labelRefuse.string=t.refuseStr):this.refuseBtn.node.active=!1,this._handler=t.handler,this.icon_ad.active=!1,t.showAd&&(this.icon_ad.active=!0),this.icon_ad.active||(this.labelConfirm.node.x=0),[2]})})},e.prototype.onAccept=function(){f.default.instance.playEffect(h.default.effectPath("click")),this._handler(!0,this),this.onClose()},e.prototype.onRefuse=function(){f.default.instance.playEffect(h.default.effectPath("click")),this._handler(!1,this),this.onClose()},e.prototype.onClose=function(){p.default.instance.popView(this)},i([v(cc.Button)],e.prototype,"refuseBtn",void 0),i([v(cc.Button)],e.prototype,"confirmBtn",void 0),i([v(cc.Label)],e.prototype,"content",void 0),i([v(cc.Label)],e.prototype,"labelRefuse",void 0),i([v(cc.Label)],e.prototype,"labelConfirm",void 0),i([v(cc.Node)],e.prototype,"icon_ad",void 0),i([v(cc.Sprite)],e.prototype,"adIcon",void 0),i([g],e)}(u.default);n.default=m,cc._RF.pop()},{"../../Module/Audio":"Audio","../../Module/ConfigManager":"ConfigManager","../../Module/ViewHandler":"ViewHandler","../../Module/ViewModule":"ViewModule","../../Utils/Path":"Path","../../Utils/Platform":"Platform","../../Utils/Utils":"Utils"}],CryptoJsMini:[function(t,e,n){"use strict";cc._RF.push(e,"be65azbMBxNgqaDC+gP74Or","CryptoJsMini");var o=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return r(e,t),e};Object.defineProperty(n,"__esModule",{value:!0}),t("crypto-js/aes"),t("crypto-js/md5");var a=i(t("crypto-js/core"));n.default=a,cc._RF.pop()},{"crypto-js/aes":4,"crypto-js/core":6,"crypto-js/md5":10}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.HOLIDAYS_TYPE={NEW_YEARS_DAY:["New Year's Day","\u5143\u65e6",1],SPRING_FESTIVAL:["Spring Festival","\u6625\u8282",3],TOMB_SWEEPING_DAY:["Tomb-sweeping Day","\u6e05\u660e",1],LABOUR_DAY:["Labour Day","\u52b3\u52a8\u8282",1],DRAGON_BOAT_FESTIVAL:["Dragon Boat Festival","\u7aef\u5348",1],MID_AUTUMN_FESTIVAL:["Mid-autumn Festival","\u4e2d\u79cb",1],NATIONAL_DAY:["National Day","\u56fd\u5e86\u8282",3]},n.Holidays=new Map([["2020-01-01",n.HOLIDAYS_TYPE.NEW_YEARS_DAY],["2020-01-24",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2020-01-25",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2020-01-26",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2020-01-27",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2020-01-28",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2020-01-29",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2020-01-30",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2020-01-31",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2020-05-01",n.HOLIDAYS_TYPE.LABOUR_DAY],["2020-05-02",n.HOLIDAYS_TYPE.LABOUR_DAY],["2020-05-03",n.HOLIDAYS_TYPE.LABOUR_DAY],["2020-05-04",n.HOLIDAYS_TYPE.LABOUR_DAY],["2020-05-05",n.HOLIDAYS_TYPE.LABOUR_DAY],["2020-06-25",n.HOLIDAYS_TYPE.DRAGON_BOAT_FESTIVAL],["2020-06-26",n.HOLIDAYS_TYPE.DRAGON_BOAT_FESTIVAL],["2020-06-27",n.HOLIDAYS_TYPE.DRAGON_BOAT_FESTIVAL],["2020-10-01",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2020-10-02",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2020-10-03",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2020-10-04",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2020-10-05",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2020-10-06",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2020-10-07",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2020-10-08",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2021-01-01",n.HOLIDAYS_TYPE.NEW_YEARS_DAY],["2021-01-02",n.HOLIDAYS_TYPE.NEW_YEARS_DAY],["2021-01-03",n.HOLIDAYS_TYPE.NEW_YEARS_DAY],["2021-02-11",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2021-02-12",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2021-02-13",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2021-02-14",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2021-02-15",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2021-02-16",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2021-02-17",n.HOLIDAYS_TYPE.SPRING_FESTIVAL],["2021-04-03",n.HOLIDAYS_TYPE.TOMB_SWEEPING_DAY],["2021-04-04",n.HOLIDAYS_TYPE.TOMB_SWEEPING_DAY],["2021-04-05",n.HOLIDAYS_TYPE.TOMB_SWEEPING_DAY],["2021-05-01",n.HOLIDAYS_TYPE.LABOUR_DAY],["2021-05-02",n.HOLIDAYS_TYPE.LABOUR_DAY],["2021-05-03",n.HOLIDAYS_TYPE.LABOUR_DAY],["2021-05-04",n.HOLIDAYS_TYPE.LABOUR_DAY],["2021-05-05",n.HOLIDAYS_TYPE.LABOUR_DAY],["2021-06-12",n.HOLIDAYS_TYPE.DRAGON_BOAT_FESTIVAL],["2021-06-13",n.HOLIDAYS_TYPE.DRAGON_BOAT_FESTIVAL],["2021-06-14",n.HOLIDAYS_TYPE.DRAGON_BOAT_FESTIVAL],["2021-09-19",n.HOLIDAYS_TYPE.MID_AUTUMN_FESTIVAL],["2021-09-20",n.HOLIDAYS_TYPE.MID_AUTUMN_FESTIVAL],["2021-09-21",n.HOLIDAYS_TYPE.MID_AUTUMN_FESTIVAL],["2021-10-01",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2021-10-02",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2021-10-03",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2021-10-04",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2021-10-05",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2021-10-06",n.HOLIDAYS_TYPE.NATIONAL_DAY],["2021-10-07",n.HOLIDAYS_TYPE.NATIONAL_DAY]])},{}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t("./constants");n.default={isHoliday:function(t){return o.Holidays.has(t)},getHolidayDetail:function(t){return o.Holidays.get(t)||[]}}},{"./constants":2}],4:[function(t,e,n){var o;o=function(t){return function(){var e=t,n=e.lib.BlockCipher,o=e.algo,r=[],i=[],a=[],s=[],c=[],l=[],u=[],p=[],f=[],h=[];(function(){for(var t=[],e=0;e<256;e++)t[e]=e<128?e<<1:e<<1^283;var n=0,o=0;for(e=0;e<256;e++){var d=o^o<<1^o<<2^o<<3^o<<4;d=d>>>8^255&d^99,r[n]=d,i[d]=n;var y=t[n],_=t[y],g=t[_],v=257*t[d]^16843008*d;a[n]=v<<24|v>>>8,s[n]=v<<16|v>>>16,c[n]=v<<8|v>>>24,l[n]=v,v=16843009*g^65537*_^257*y^16843008*n,u[d]=v<<24|v>>>8,p[d]=v<<16|v>>>16,f[d]=v<<8|v>>>24,h[d]=v,n?(n=y^t[t[t[g^y]]],o^=t[t[o]]):n=o=1}})();var d=[0,1,2,4,8,16,32,64,128,27,54],y=o.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var t=this._keyPriorReset=this._key,e=t.words,n=t.sigBytes/4,o=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],a=0;a<o;a++)a<n?i[a]=e[a]:(l=i[a-1],a%n?n>6&&a%n==4&&(l=r[l>>>24]<<24|r[l>>>16&255]<<16|r[l>>>8&255]<<8|r[255&l]):(l=r[(l=l<<8|l>>>24)>>>24]<<24|r[l>>>16&255]<<16|r[l>>>8&255]<<8|r[255&l],l^=d[a/n|0]<<24),i[a]=i[a-n]^l);for(var s=this._invKeySchedule=[],c=0;c<o;c++){if(a=o-c,c%4)var l=i[a];else l=i[a-4];s[c]=c<4||a<=4?l:u[r[l>>>24]]^p[r[l>>>16&255]]^f[r[l>>>8&255]]^h[r[255&l]]}}},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,a,s,c,l,r)},decryptBlock:function(t,e){var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n,this._doCryptBlock(t,e,this._invKeySchedule,u,p,f,h,i),n=t[e+1],t[e+1]=t[e+3],t[e+3]=n},_doCryptBlock:function(t,e,n,o,r,i,a,s){for(var c=this._nRounds,l=t[e]^n[0],u=t[e+1]^n[1],p=t[e+2]^n[2],f=t[e+3]^n[3],h=4,d=1;d<c;d++){var y=o[l>>>24]^r[u>>>16&255]^i[p>>>8&255]^a[255&f]^n[h++],_=o[u>>>24]^r[p>>>16&255]^i[f>>>8&255]^a[255&l]^n[h++],g=o[p>>>24]^r[f>>>16&255]^i[l>>>8&255]^a[255&u]^n[h++],v=o[f>>>24]^r[l>>>16&255]^i[u>>>8&255]^a[255&p]^n[h++];l=y,u=_,p=g,f=v}y=(s[l>>>24]<<24|s[u>>>16&255]<<16|s[p>>>8&255]<<8|s[255&f])^n[h++],_=(s[u>>>24]<<24|s[p>>>16&255]<<16|s[f>>>8&255]<<8|s[255&l])^n[h++],g=(s[p>>>24]<<24|s[f>>>16&255]<<16|s[l>>>8&255]<<8|s[255&u])^n[h++],v=(s[f>>>24]<<24|s[l>>>16&255]<<16|s[u>>>8&255]<<8|s[255&p])^n[h++],t[e]=y,t[e+1]=_,t[e+2]=g,t[e+3]=v},keySize:8});e.AES=n._createHelper(y)}(),t.AES},"object"==typeof n?e.exports=n=o(t("./core"),t("./enc-base64"),t("./md5"),t("./evpkdf"),t("./cipher-core")):"function"==typeof define&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],o):o(this.CryptoJS)},{"./cipher-core":5,"./core":6,"./enc-base64":7,"./evpkdf":8,"./md5":10}],5:[function(t,e,n){var o;o=function(t){t.lib.Cipher||function(e){var n=t,o=n.lib,r=o.Base,i=o.WordArray,a=o.BufferedBlockAlgorithm,s=n.enc,c=(s.Utf8,s.Base64),l=n.algo.EvpKDF,u=o.Cipher=a.extend({cfg:r.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,n){this.cfg=this.cfg.extend(n),this._xformMode=t,this._key=e,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function t(t){return"string"==typeof t?m:g}return function(e){return{encrypt:function(n,o,r){return t(o).encrypt(e,n,o,r)},decrypt:function(n,o,r){return t(o).decrypt(e,n,o,r)}}}}()}),p=(o.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),n.mode={}),f=o.BlockCipherMode=r.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),h=p.CBC=function(){var t=f.extend();function n(t,n,o){var r,i=this._iv;i?(r=i,this._iv=e):r=this._prevBlock;for(var a=0;a<o;a++)t[n+a]^=r[a]}return t.Encryptor=t.extend({processBlock:function(t,e){var o=this._cipher,r=o.blockSize;n.call(this,t,e,r),o.encryptBlock(t,e),this._prevBlock=t.slice(e,e+r)}}),t.Decryptor=t.extend({processBlock:function(t,e){var o=this._cipher,r=o.blockSize,i=t.slice(e,e+r);o.decryptBlock(t,e),n.call(this,t,e,r),this._prevBlock=i}}),t}(),d=(n.pad={}).Pkcs7={pad:function(t,e){for(var n=4*e,o=n-t.sigBytes%n,r=o<<24|o<<16|o<<8|o,a=[],s=0;s<o;s+=4)a.push(r);var c=i.create(a,o);t.concat(c)},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},y=(o.BlockCipher=u.extend({cfg:u.cfg.extend({mode:h,padding:d}),reset:function(){var t;u.reset.call(this);var e=this.cfg,n=e.iv,o=e.mode;this._xformMode==this._ENC_XFORM_MODE?t=o.createEncryptor:(t=o.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==t?this._mode.init(this,n&&n.words):(this._mode=t.call(o,this,n&&n.words),this._mode.__creator=t)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t,e=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(e.pad(this._data,this.blockSize),t=this._process(!0)):(t=this._process(!0),e.unpad(t)),t},blockSize:4}),o.CipherParams=r.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}})),_=(n.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext,n=t.salt;return(n?i.create([1398893684,1701076831]).concat(n).concat(e):e).toString(c)},parse:function(t){var e,n=c.parse(t),o=n.words;return 1398893684==o[0]&&1701076831==o[1]&&(e=i.create(o.slice(2,4)),o.splice(0,4),n.sigBytes-=16),y.create({ciphertext:n,salt:e})}},g=o.SerializableCipher=r.extend({cfg:r.extend({format:_}),encrypt:function(t,e,n,o){o=this.cfg.extend(o);var r=t.createEncryptor(n,o),i=r.finalize(e),a=r.cfg;return y.create({ciphertext:i,key:n,iv:a.iv,algorithm:t,mode:a.mode,padding:a.padding,blockSize:t.blockSize,formatter:o.format})},decrypt:function(t,e,n,o){return o=this.cfg.extend(o),e=this._parse(e,o.format),t.createDecryptor(n,o).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),v=(n.kdf={}).OpenSSL={execute:function(t,e,n,o,r){if(o||(o=i.random(8)),r)a=l.create({keySize:e+n,hasher:r}).compute(t,o);else var a=l.create({keySize:e+n}).compute(t,o);var s=i.create(a.words.slice(e),4*n);return a.sigBytes=4*e,y.create({key:a,iv:s,salt:o})}},m=o.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:v}),encrypt:function(t,e,n,o){var r=(o=this.cfg.extend(o)).kdf.execute(n,t.keySize,t.ivSize,o.salt,o.hasher);o.iv=r.iv;var i=g.encrypt.call(this,t,e,r.key,o);return i.mixIn(r),i},decrypt:function(t,e,n,o){o=this.cfg.extend(o),e=this._parse(e,o.format);var r=o.kdf.execute(n,t.keySize,t.ivSize,e.salt,o.hasher);return o.iv=r.iv,g.decrypt.call(this,t,e,r.key,o)}})}()},"object"==typeof n?e.exports=n=o(t("./core"),t("./evpkdf")):"function"==typeof define&&define.amd?define(["./core","./evpkdf"],o):o(this.CryptoJS)},{"./core":6,"./evpkdf":8}],6:[function(t,e,n){(function(o){var r;r=function(){var e=e||function(e){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==o&&o.crypto&&(n=o.crypto),!n&&"function"==typeof t)try{n=t("crypto")}catch(_){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(_){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(_){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),a={},s=a.lib={},c=s.Base={extend:function(t){var e=i(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},l=s.WordArray=c.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||p).stringify(this)},concat:function(t){var e=this.words,n=t.words,o=this.sigBytes,r=t.sigBytes;if(this.clamp(),o%4)for(var i=0;i<r;i++){var a=n[i>>>2]>>>24-i%4*8&255;e[o+i>>>2]|=a<<24-(o+i)%4*8}else for(var s=0;s<r;s+=4)e[o+s>>>2]=n[s>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var t=c.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(r());return new l.init(e,t)}}),u=a.enc={},p=u.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,o=[],r=0;r<n;r++){var i=e[r>>>2]>>>24-r%4*8&255;o.push((i>>>4).toString(16)),o.push((15&i).toString(16))}return o.join("")},parse:function(t){for(var e=t.length,n=[],o=0;o<e;o+=2)n[o>>>3]|=parseInt(t.substr(o,2),16)<<24-o%8*4;return new l.init(n,e/2)}},f=u.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,o=[],r=0;r<n;r++){var i=e[r>>>2]>>>24-r%4*8&255;o.push(String.fromCharCode(i))}return o.join("")},parse:function(t){for(var e=t.length,n=[],o=0;o<e;o++)n[o>>>2]|=(255&t.charCodeAt(o))<<24-o%4*8;return new l.init(n,e)}},h=u.Utf8={stringify:function(t){try{return decodeURIComponent(escape(f.stringify(t)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(t){return f.parse(unescape(encodeURIComponent(t)))}},d=s.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var n,o=this._data,r=o.words,i=o.sigBytes,a=this.blockSize,s=i/(4*a),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*a,u=e.min(4*c,i);if(c){for(var p=0;p<c;p+=a)this._doProcessBlock(r,p);n=r.splice(0,c),o.sigBytes-=u}return new l.init(n,u)},clone:function(){var t=c.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),y=(s.Hasher=d.extend({cfg:c.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new y.HMAC.init(t,n).finalize(e)}}}),a.algo={});return a}(Math);return e},"object"==typeof n?e.exports=n=r():"function"==typeof define&&define.amd?define([],r):this.CryptoJS=r()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{crypto:1}],7:[function(t,e,n){var o;o=function(t){return function(){var e=t,n=e.lib.WordArray;function o(t,e,o){for(var r=[],i=0,a=0;a<e;a++)if(a%4){var s=o[t.charCodeAt(a-1)]<<a%4*2|o[t.charCodeAt(a)]>>>6-a%4*2;r[i>>>2]|=s<<24-i%4*8,i++}return n.create(r,i)}e.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,o=this._map;t.clamp();for(var r=[],i=0;i<n;i+=3)for(var a=(e[i>>>2]>>>24-i%4*8&255)<<16|(e[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|e[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)r.push(o.charAt(a>>>6*(3-s)&63));var c=o.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(t){var e=t.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var i=0;i<n.length;i++)r[n.charCodeAt(i)]=i}var a=n.charAt(64);if(a){var s=t.indexOf(a);-1!==s&&(e=s)}return o(t,e,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),t.enc.Base64},"object"==typeof n?e.exports=n=o(t("./core")):"function"==typeof define&&define.amd?define(["./core"],o):o(this.CryptoJS)},{"./core":6}],8:[function(t,e,n){var o;o=function(t){var e,n,o,r,i,a,s;return o=(n=(e=t).lib).Base,r=n.WordArray,a=(i=e.algo).MD5,s=i.EvpKDF=o.extend({cfg:o.extend({keySize:4,hasher:a,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var n,o=this.cfg,i=o.hasher.create(),a=r.create(),s=a.words,c=o.keySize,l=o.iterations;s.length<c;){n&&i.update(n),n=i.update(t).finalize(e),i.reset();for(var u=1;u<l;u++)n=i.finalize(n),i.reset();a.concat(n)}return a.sigBytes=4*c,a}}),e.EvpKDF=function(t,e,n){return s.create(n).compute(t,e)},t.EvpKDF},"object"==typeof n?e.exports=n=o(t("./core"),t("./sha1"),t("./hmac")):"function"==typeof define&&define.amd?define(["./core","./sha1","./hmac"],o):o(this.CryptoJS)},{"./core":6,"./hmac":9,"./sha1":11}],9:[function(t,e,n){var o;o=function(t){var e,n,o;n=(e=t).lib.Base,o=e.enc.Utf8,e.algo.HMAC=n.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=o.parse(e));var n=t.blockSize,r=4*n;e.sigBytes>r&&(e=t.finalize(e)),e.clamp();for(var i=this._oKey=e.clone(),a=this._iKey=e.clone(),s=i.words,c=a.words,l=0;l<n;l++)s[l]^=1549556828,c[l]^=909522486;i.sigBytes=a.sigBytes=r,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,n=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(n))}})},"object"==typeof n?e.exports=n=o(t("./core")):"function"==typeof define&&define.amd?define(["./core"],o):o(this.CryptoJS)},{"./core":6}],10:[function(t,e,n){var o;o=function(t){return function(e){var n=t,o=n.lib,r=o.WordArray,i=o.Hasher,a=n.algo,s=[];(function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0})();var c=a.MD5=i.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var n=0;n<16;n++){var o=e+n,r=t[o];t[o]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var i=this._hash.words,a=t[e+0],c=t[e+1],h=t[e+2],d=t[e+3],y=t[e+4],_=t[e+5],g=t[e+6],v=t[e+7],m=t[e+8],b=t[e+9],w=t[e+10],S=t[e+11],C=t[e+12],A=t[e+13],M=t[e+14],P=t[e+15],E=i[0],O=i[1],R=i[2],T=i[3];E=l(E,O,R,T,a,7,s[0]),T=l(T,E,O,R,c,12,s[1]),R=l(R,T,E,O,h,17,s[2]),O=l(O,R,T,E,d,22,s[3]),E=l(E,O,R,T,y,7,s[4]),T=l(T,E,O,R,_,12,s[5]),R=l(R,T,E,O,g,17,s[6]),O=l(O,R,T,E,v,22,s[7]),E=l(E,O,R,T,m,7,s[8]),T=l(T,E,O,R,b,12,s[9]),R=l(R,T,E,O,w,17,s[10]),O=l(O,R,T,E,S,22,s[11]),E=l(E,O,R,T,C,7,s[12]),T=l(T,E,O,R,A,12,s[13]),R=l(R,T,E,O,M,17,s[14]),E=u(E,O=l(O,R,T,E,P,22,s[15]),R,T,c,5,s[16]),T=u(T,E,O,R,g,9,s[17]),R=u(R,T,E,O,S,14,s[18]),O=u(O,R,T,E,a,20,s[19]),E=u(E,O,R,T,_,5,s[20]),T=u(T,E,O,R,w,9,s[21]),R=u(R,T,E,O,P,14,s[22]),O=u(O,R,T,E,y,20,s[23]),E=u(E,O,R,T,b,5,s[24]),T=u(T,E,O,R,M,9,s[25]),R=u(R,T,E,O,d,14,s[26]),O=u(O,R,T,E,m,20,s[27]),E=u(E,O,R,T,A,5,s[28]),T=u(T,E,O,R,h,9,s[29]),R=u(R,T,E,O,v,14,s[30]),E=p(E,O=u(O,R,T,E,C,20,s[31]),R,T,_,4,s[32]),T=p(T,E,O,R,m,11,s[33]),R=p(R,T,E,O,S,16,s[34]),O=p(O,R,T,E,M,23,s[35]),E=p(E,O,R,T,c,4,s[36]),T=p(T,E,O,R,y,11,s[37]),R=p(R,T,E,O,v,16,s[38]),O=p(O,R,T,E,w,23,s[39]),E=p(E,O,R,T,A,4,s[40]),T=p(T,E,O,R,a,11,s[41]),R=p(R,T,E,O,d,16,s[42]),O=p(O,R,T,E,g,23,s[43]),E=p(E,O,R,T,b,4,s[44]),T=p(T,E,O,R,C,11,s[45]),R=p(R,T,E,O,P,16,s[46]),E=f(E,O=p(O,R,T,E,h,23,s[47]),R,T,a,6,s[48]),T=f(T,E,O,R,v,10,s[49]),R=f(R,T,E,O,M,15,s[50]),O=f(O,R,T,E,_,21,s[51]),E=f(E,O,R,T,C,6,s[52]),T=f(T,E,O,R,d,10,s[53]),R=f(R,T,E,O,w,15,s[54]),O=f(O,R,T,E,c,21,s[55]),E=f(E,O,R,T,m,6,s[56]),T=f(T,E,O,R,P,10,s[57]),R=f(R,T,E,O,g,15,s[58]),O=f(O,R,T,E,A,21,s[59]),E=f(E,O,R,T,y,6,s[60]),T=f(T,E,O,R,S,10,s[61]),R=f(R,T,E,O,h,15,s[62]),O=f(O,R,T,E,b,21,s[63]),i[0]=i[0]+E|0,i[1]=i[1]+O|0,i[2]=i[2]+R|0,i[3]=i[3]+T|0},_doFinalize:function(){var t=this._data,n=t.words,o=8*this._nDataBytes,r=8*t.sigBytes;n[r>>>5]|=128<<24-r%32;var i=e.floor(o/4294967296),a=o;n[15+(r+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(r+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,c=s.words,l=0;l<4;l++){var u=c[l];c[l]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return s},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});function l(t,e,n,o,r,i,a){var s=t+(e&n|~e&o)+r+a;return(s<<i|s>>>32-i)+e}function u(t,e,n,o,r,i,a){var s=t+(e&o|n&~o)+r+a;return(s<<i|s>>>32-i)+e}function p(t,e,n,o,r,i,a){var s=t+(e^n^o)+r+a;return(s<<i|s>>>32-i)+e}function f(t,e,n,o,r,i,a){var s=t+(n^(e|~o))+r+a;return(s<<i|s>>>32-i)+e}n.MD5=i._createHelper(c),n.HmacMD5=i._createHmacHelper(c)}(Math),t.MD5},"object"==typeof n?e.exports=n=o(t("./core")):"function"==typeof define&&define.amd?define(["./core"],o):o(this.CryptoJS)},{"./core":6}],11:[function(t,e,n){var o;o=function(t){var e,n,o,r,i,a,s;return n=(e=t).lib,o=n.WordArray,r=n.Hasher,i=e.algo,a=[],s=i.SHA1=r.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,o=n[0],r=n[1],i=n[2],s=n[3],c=n[4],l=0;l<80;l++){if(l<16)a[l]=0|t[e+l];else{var u=a[l-3]^a[l-8]^a[l-14]^a[l-16];a[l]=u<<1|u>>>31}var p=(o<<5|o>>>27)+c+a[l];p+=l<20?1518500249+(r&i|~r&s):l<40?1859775393+(r^i^s):l<60?(r&i|r&s|i&s)-1894007588:(r^i^s)-899497514,c=s,s=i,i=r<<30|r>>>2,r=o,o=p}n[0]=n[0]+o|0,n[1]=n[1]+r|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+c|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,o=8*t.sigBytes;return e[o>>>5]|=128<<24-o%32,e[14+(o+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(o+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}}),e.SHA1=r._createHelper(s),e.HmacSHA1=r._createHmacHelper(s),t.SHA1},"object"==typeof n?e.exports=n=o(t("./core")):"function"==typeof define&&define.amd?define(["./core"],o):o(this.CryptoJS)},{"./core":6}],12:[function(t,e){"use strict";function n(t,e){e=e||{},this._capacity=e.capacity,this._head=0,this._tail=0,Array.isArray(t)?this._fromArray(t):(this._capacityMask=3,this._list=new Array(4))}n.prototype.peekAt=function(t){var e=t;if(e===(0|e)){var n=this.size();if(!(e>=n||e<-n))return e<0&&(e+=n),e=this._head+e&this._capacityMask,this._list[e]}},n.prototype.get=function(t){return this.peekAt(t)},n.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},n.prototype.peekFront=function(){return this.peek()},n.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(n.prototype,"length",{get:function(){return this.size()}}),n.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},n.prototype.unshift=function(t){if(0===arguments.length)return this.size();var e=this._list.length;return this._head=this._head-1+e&this._capacityMask,this._list[this._head]=t,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},n.prototype.shift=function(){var t=this._head;if(t!==this._tail){var e=this._list[t];return this._list[t]=void 0,this._head=t+1&this._capacityMask,t<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),e}},n.prototype.push=function(t){if(0===arguments.length)return this.size();var e=this._tail;return this._list[e]=t,this._tail=e+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},n.prototype.pop=function(){var t=this._tail;if(t!==this._head){var e=this._list.length;this._tail=t-1+e&this._capacityMask;var n=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&t>1e4&&t<=e>>>2&&this._shrinkArray(),n}},n.prototype.removeOne=function(t){var e=t;if(e===(0|e)&&this._head!==this._tail){var n=this.size(),o=this._list.length;if(!(e>=n||e<-n)){e<0&&(e+=n),e=this._head+e&this._capacityMask;var r,i=this._list[e];if(t<n/2){for(r=t;r>0;r--)this._list[e]=this._list[e=e-1+o&this._capacityMask];this._list[e]=void 0,this._head=this._head+1+o&this._capacityMask}else{for(r=n-1-t;r>0;r--)this._list[e]=this._list[e=e+1+o&this._capacityMask];this._list[e]=void 0,this._tail=this._tail-1+o&this._capacityMask}return i}}},n.prototype.remove=function(t,e){var n,o=t,r=e;if(o===(0|o)&&this._head!==this._tail){var i=this.size(),a=this._list.length;if(!(o>=i||o<-i||e<1)){if(o<0&&(o+=i),1===e||!e)return(n=new Array(1))[0]=this.removeOne(o),n;if(0===o&&o+e>=i)return n=this.toArray(),this.clear(),n;var s;for(o+e>i&&(e=i-o),n=new Array(e),s=0;s<e;s++)n[s]=this._list[this._head+o+s&this._capacityMask];if(o=this._head+o&this._capacityMask,t+e===i){for(this._tail=this._tail-e+a&this._capacityMask,s=e;s>0;s--)this._list[o=o+1+a&this._capacityMask]=void 0;return n}if(0===t){for(this._head=this._head+e+a&this._capacityMask,s=e-1;s>0;s--)this._list[o=o+1+a&this._capacityMask]=void 0;return n}if(o<i/2){for(this._head=this._head+t+e+a&this._capacityMask,s=t;s>0;s--)this.unshift(this._list[o=o-1+a&this._capacityMask]);for(o=this._head-1+a&this._capacityMask;r>0;)this._list[o=o-1+a&this._capacityMask]=void 0,r--;t<0&&(this._tail=o)}else{for(this._tail=o,o=o+e+a&this._capacityMask,s=i-(e+t);s>0;s--)this.push(this._list[o++]);for(o=this._tail;r>0;)this._list[o=o+1+a&this._capacityMask]=void 0,r--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),n}}},n.prototype.splice=function(t,e){var n=t;if(n===(0|n)){var o=this.size();if(n<0&&(n+=o),!(n>o)){if(arguments.length>2){var r,i,a,s=arguments.length,c=this._list.length,l=2;if(!o||n<o/2){for(i=new Array(n),r=0;r<n;r++)i[r]=this._list[this._head+r&this._capacityMask];for(0===e?(a=[],n>0&&(this._head=this._head+n+c&this._capacityMask)):(a=this.remove(n,e),this._head=this._head+n+c&this._capacityMask);s>l;)this.unshift(arguments[--s]);for(r=n;r>0;r--)this.unshift(i[r-1])}else{var u=(i=new Array(o-(n+e))).length;for(r=0;r<u;r++)i[r]=this._list[this._head+n+e+r&this._capacityMask];for(0===e?(a=[],n!=o&&(this._tail=this._head+n+c&this._capacityMask)):(a=this.remove(n,e),this._tail=this._tail-u+c&this._capacityMask);l<s;)this.push(arguments[l++]);for(r=0;r<u;r++)this.push(i[r])}return a}return this.remove(n,e)}}},n.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0},n.prototype.isEmpty=function(){return this._head===this._tail},n.prototype.toArray=function(){return this._copyArray(!1)},n.prototype._fromArray=function(t){var e=t.length,n=this._nextPowerOf2(e);this._list=new Array(n),this._capacityMask=n-1,this._tail=e;for(var o=0;o<e;o++)this._list[o]=t[o]},n.prototype._copyArray=function(t,e){var n=this._list,o=n.length,r=this.length;if((e|=r)==r&&this._head<this._tail)return this._list.slice(this._head,this._tail);var i,a=new Array(e),s=0;if(t||this._head>this._tail){for(i=this._head;i<o;i++)a[s++]=n[i];for(i=0;i<this._tail;i++)a[s++]=n[i]}else for(i=this._head;i<this._tail;i++)a[s++]=n[i];return a},n.prototype._growArray=function(){if(0!=this._head){var t=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=t}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1},n.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},n.prototype._nextPowerOf2=function(t){var e=1<<Math.log(t)/Math.log(2)+1;return Math.max(e,4)},e.exports=n},{}],13:[function(t,e,n){(function(t){(function(){var o,r=200,i="Expected a function",a="__lodash_placeholder__",s=1,c=2,l=4,u=1,p=2,f=1,h=2,d=4,y=8,_=16,g=32,v=64,m=128,b=256,w=512,S=800,C=16,A=1/0,M=9007199254740991,P=17976931348623157e292,E=NaN,O=4294967295,R=O-1,T=O>>>1,I=[["ary",m],["bind",f],["bindKey",h],["curry",y],["curryRight",_],["flip",w],["partial",g],["partialRight",v],["rearg",b]],N="[object Arguments]",D="[object Array]",x="[object AsyncFunction]",B="[object Boolean]",L="[object Date]",k="[object DOMException]",U="[object Error]",G="[object Function]",j="[object GeneratorFunction]",V="[object Map]",F="[object Number]",H="[object Null]",W="[object Object]",z="[object Proxy]",q="[object RegExp]",Y="[object Set]",K="[object String]",J="[object Symbol]",X="[object Undefined]",Q="[object WeakMap]",Z="[object ArrayBuffer]",$="[object DataView]",tt="[object Float32Array]",et="[object Float64Array]",nt="[object Int8Array]",ot="[object Int16Array]",rt="[object Int32Array]",it="[object Uint8Array]",at="[object Uint8ClampedArray]",st="[object Uint16Array]",ct="[object Uint32Array]",lt=/\b__p \+= '';/g,ut=/\b(__p \+=) '' \+/g,pt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ft=/&(?:amp|lt|gt|quot|#39);/g,ht=/[&<>"']/g,dt=RegExp(ft.source),yt=RegExp(ht.source),_t=/<%-([\s\S]+?)%>/g,gt=/<%([\s\S]+?)%>/g,vt=/<%=([\s\S]+?)%>/g,mt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,bt=/^\w*$/,wt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,St=/[\\^$.*+?()[\]{}|]/g,Ct=RegExp(St.source),At=/^\s+/,Mt=/\s/,Pt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Et=/\{\n\/\* \[wrapped with (.+)\] \*/,Ot=/,? & /,Rt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Tt=/[()=,{}\[\]\/\s]/,It=/\\(\\)?/g,Nt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Dt=/\w*$/,xt=/^[-+]0x[0-9a-f]+$/i,Bt=/^0b[01]+$/i,Lt=/^\[object .+?Constructor\]$/,kt=/^0o[0-7]+$/i,Ut=/^(?:0|[1-9]\d*)$/,Gt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,jt=/($^)/,Vt=/['\n\r\u2028\u2029\\]/g,Ft="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ht="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Wt="["+Ht+"]",zt="["+Ft+"]",qt="\\d+",Yt="[a-z\\xdf-\\xf6\\xf8-\\xff]",Kt="[^\\ud800-\\udfff"+Ht+qt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Jt="\\ud83c[\\udffb-\\udfff]",Xt="[^\\ud800-\\udfff]",Qt="(?:\\ud83c[\\udde6-\\uddff]){2}",Zt="[\\ud800-\\udbff][\\udc00-\\udfff]",$t="[A-Z\\xc0-\\xd6\\xd8-\\xde]",te="(?:"+Yt+"|"+Kt+")",ee="(?:"+$t+"|"+Kt+")",ne="(?:"+zt+"|"+Jt+")?",oe="[\\ufe0e\\ufe0f]?"+ne+"(?:\\u200d(?:"+[Xt,Qt,Zt].join("|")+")[\\ufe0e\\ufe0f]?"+ne+")*",re="(?:"+["[\\u2700-\\u27bf]",Qt,Zt].join("|")+")"+oe,ie="(?:"+[Xt+zt+"?",zt,Qt,Zt,"[\\ud800-\\udfff]"].join("|")+")",ae=RegExp("['\u2019]","g"),se=RegExp(zt,"g"),ce=RegExp(Jt+"(?="+Jt+")|"+ie+oe,"g"),le=RegExp([$t+"?"+Yt+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[Wt,$t,"$"].join("|")+")",ee+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[Wt,$t+te,"$"].join("|")+")",$t+"?"+te+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",$t+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",qt,re].join("|"),"g"),ue=RegExp("[\\u200d\\ud800-\\udfff"+Ft+"\\ufe0e\\ufe0f]"),pe=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,fe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],he=-1,de={};de[tt]=de[et]=de[nt]=de[ot]=de[rt]=de[it]=de[at]=de[st]=de[ct]=!0,de[N]=de[D]=de[Z]=de[B]=de[$]=de[L]=de[U]=de[G]=de[V]=de[F]=de[W]=de[q]=de[Y]=de[K]=de[Q]=!1;var ye={};ye[N]=ye[D]=ye[Z]=ye[$]=ye[B]=ye[L]=ye[tt]=ye[et]=ye[nt]=ye[ot]=ye[rt]=ye[V]=ye[F]=ye[W]=ye[q]=ye[Y]=ye[K]=ye[J]=ye[it]=ye[at]=ye[st]=ye[ct]=!0,ye[U]=ye[G]=ye[Q]=!1;var _e={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ge=parseFloat,ve=parseInt,me="object"==typeof t&&t&&t.Object===Object&&t,be="object"==typeof self&&self&&self.Object===Object&&self,we=me||be||Function("","return this")(),Se="object"==typeof n&&n&&!n.nodeType&&n,Ce=Se&&"object"==typeof e&&e&&!e.nodeType&&e,Ae=Ce&&Ce.exports===Se,Me=Ae&&me.process,Pe=function(){try{return Ce&&Ce.require&&Ce.require("util").types||Me&&Me.binding&&Me.binding("util")}catch(t){}}(),Ee=Pe&&Pe.isArrayBuffer,Oe=Pe&&Pe.isDate,Re=Pe&&Pe.isMap,Te=Pe&&Pe.isRegExp,Ie=Pe&&Pe.isSet,Ne=Pe&&Pe.isTypedArray;function De(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function xe(t,e,n,o){for(var r=-1,i=null==t?0:t.length;++r<i;){var a=t[r];e(o,a,n(a),t)}return o}function Be(t,e){for(var n=-1,o=null==t?0:t.length;++n<o&&!1!==e(t[n],n,t););return t}function Le(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function ke(t,e){for(var n=-1,o=null==t?0:t.length;++n<o;)if(!e(t[n],n,t))return!1;return!0}function Ue(t,e){for(var n=-1,o=null==t?0:t.length,r=0,i=[];++n<o;){var a=t[n];e(a,n,t)&&(i[r++]=a)}return i}function Ge(t,e){return!(null==t||!t.length)&&Qe(t,e,0)>-1}function je(t,e,n){for(var o=-1,r=null==t?0:t.length;++o<r;)if(n(e,t[o]))return!0;return!1}function Ve(t,e){for(var n=-1,o=null==t?0:t.length,r=Array(o);++n<o;)r[n]=e(t[n],n,t);return r}function Fe(t,e){for(var n=-1,o=e.length,r=t.length;++n<o;)t[r+n]=e[n];return t}function He(t,e,n,o){var r=-1,i=null==t?0:t.length;for(o&&i&&(n=t[++r]);++r<i;)n=e(n,t[r],r,t);return n}function We(t,e,n,o){var r=null==t?0:t.length;for(o&&r&&(n=t[--r]);r--;)n=e(n,t[r],r,t);return n}function ze(t,e){for(var n=-1,o=null==t?0:t.length;++n<o;)if(e(t[n],n,t))return!0;return!1}var qe=en("length");function Ye(t){return t.split("")}function Ke(t){return t.match(Rt)||[]}function Je(t,e,n){var o;return n(t,function(t,n,r){if(e(t,n,r))return o=n,!1}),o}function Xe(t,e,n,o){for(var r=t.length,i=n+(o?1:-1);o?i--:++i<r;)if(e(t[i],i,t))return i;return-1}function Qe(t,e,n){return e==e?On(t,e,n):Xe(t,$e,n)}function Ze(t,e,n,o){for(var r=n-1,i=t.length;++r<i;)if(o(t[r],e))return r;return-1}function $e(t){return t!=t}function tn(t,e){var n=null==t?0:t.length;return n?an(t,e)/n:E}function en(t){return function(e){return null==e?o:e[t]}}function nn(t){return function(e){return null==t?o:t[e]}}function on(t,e,n,o,r){return r(t,function(t,r,i){n=o?(o=!1,t):e(n,t,r,i)}),n}function rn(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function an(t,e){for(var n,r=-1,i=t.length;++r<i;){var a=e(t[r]);a!==o&&(n=n===o?a:n+a)}return n}function sn(t,e){for(var n=-1,o=Array(t);++n<t;)o[n]=e(n);return o}function cn(t,e){return Ve(e,function(e){return[e,t[e]]})}function ln(t){return t?t.slice(0,Nn(t)+1).replace(At,""):t}function un(t){return function(e){return t(e)}}function pn(t,e){return Ve(e,function(e){return t[e]})}function fn(t,e){return t.has(e)}function hn(t,e){for(var n=-1,o=t.length;++n<o&&Qe(e,t[n],0)>-1;);return n}function dn(t,e){for(var n=t.length;n--&&Qe(e,t[n],0)>-1;);return n}function yn(t,e){for(var n=t.length,o=0;n--;)t[n]===e&&++o;return o}var _n=nn({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),gn=nn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function vn(t){return"\\"+_e[t]}function mn(t,e){return null==t?o:t[e]}function bn(t){return ue.test(t)}function wn(t){return pe.test(t)}function Sn(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function Cn(t){var e=-1,n=Array(t.size);return t.forEach(function(t,o){n[++e]=[o,t]}),n}function An(t,e){return function(n){return t(e(n))}}function Mn(t,e){for(var n=-1,o=t.length,r=0,i=[];++n<o;){var s=t[n];s!==e&&s!==a||(t[n]=a,i[r++]=n)}return i}function Pn(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function En(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function On(t,e,n){for(var o=n-1,r=t.length;++o<r;)if(t[o]===e)return o;return-1}function Rn(t,e,n){for(var o=n+1;o--;)if(t[o]===e)return o;return o}function Tn(t){return bn(t)?xn(t):qe(t)}function In(t){return bn(t)?Bn(t):Ye(t)}function Nn(t){for(var e=t.length;e--&&Mt.test(t.charAt(e)););return e}var Dn=nn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});function xn(t){for(var e=ce.lastIndex=0;ce.test(t);)++e;return e}function Bn(t){return t.match(ce)||[]}function Ln(t){return t.match(le)||[]}var kn=function t(e){var n,Mt=(e=null==e?we:kn.defaults(we.Object(),e,kn.pick(we,fe))).Array,Rt=e.Date,Ft=e.Error,Ht=e.Function,Wt=e.Math,zt=e.Object,qt=e.RegExp,Yt=e.String,Kt=e.TypeError,Jt=Mt.prototype,Xt=Ht.prototype,Qt=zt.prototype,Zt=e["__core-js_shared__"],$t=Xt.toString,te=Qt.hasOwnProperty,ee=0,ne=(n=/[^.]+$/.exec(Zt&&Zt.keys&&Zt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",oe=Qt.toString,re=$t.call(zt),ie=we._,ce=qt("^"+$t.call(te).replace(St,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),le=Ae?e.Buffer:o,ue=e.Symbol,pe=e.Uint8Array,_e=le?le.allocUnsafe:o,me=An(zt.getPrototypeOf,zt),be=zt.create,Se=Qt.propertyIsEnumerable,Ce=Jt.splice,Me=ue?ue.isConcatSpreadable:o,Pe=ue?ue.iterator:o,qe=ue?ue.toStringTag:o,Ye=function(){try{var t=ra(zt,"defineProperty");return t({},"",{}),t}catch(e){}}(),nn=e.clearTimeout!==we.clearTimeout&&e.clearTimeout,On=Rt&&Rt.now!==we.Date.now&&Rt.now,xn=e.setTimeout!==we.setTimeout&&e.setTimeout,Bn=Wt.ceil,Un=Wt.floor,Gn=zt.getOwnPropertySymbols,jn=le?le.isBuffer:o,Vn=e.isFinite,Fn=Jt.join,Hn=An(zt.keys,zt),Wn=Wt.max,zn=Wt.min,qn=Rt.now,Yn=e.parseInt,Kn=Wt.random,Jn=Jt.reverse,Xn=ra(e,"DataView"),Qn=ra(e,"Map"),Zn=ra(e,"Promise"),$n=ra(e,"Set"),to=ra(e,"WeakMap"),eo=ra(zt,"create"),no=to&&new to,oo={},ro=ja(Xn),io=ja(Qn),ao=ja(Zn),so=ja($n),co=ja(to),lo=ue?ue.prototype:o,uo=lo?lo.valueOf:o,po=lo?lo.toString:o;function fo(t){if(rc(t)&&!Ys(t)&&!(t instanceof go)){if(t instanceof _o)return t;if(te.call(t,"__wrapped__"))return Fa(t)}return new _o(t)}var ho=function(){function t(){}return function(e){if(!oc(e))return{};if(be)return be(e);t.prototype=e;var n=new t;return t.prototype=o,n}}();function yo(){}function _o(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=o}function go(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=O,this.__views__=[]}function vo(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function mo(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function bo(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function wo(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new bo;++e<n;)this.add(t[e])}function So(t){var e=this.__data__=new mo(t);this.size=e.size}function Co(t,e){var n=Ys(t),o=!n&&qs(t),r=!n&&!o&&Qs(t),i=!n&&!o&&!r&&fc(t),a=n||o||r||i,s=a?sn(t.length,Yt):[],c=s.length;for(var l in t)!e&&!te.call(t,l)||a&&("length"==l||r&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ga(l,c))||s.push(l);return s}function Ao(t){var e=t.length;return e?t[Tr(0,e-1)]:o}function Mo(t,e){return ka(yi(t),Bo(e,0,t.length))}function Po(t){return ka(yi(t))}function Eo(t,e,n){(n===o||Hs(t[e],n))&&(n!==o||e in t)||Do(t,e,n)}function Oo(t,e,n){var r=t[e];te.call(t,e)&&Hs(r,n)&&(n!==o||e in t)||Do(t,e,n)}function Ro(t,e){for(var n=t.length;n--;)if(Hs(t[n][0],e))return n;return-1}function To(t,e,n,o){return Vo(t,function(t,r,i){e(o,t,n(t),i)}),o}function Io(t,e){return t&&_i(e,xc(e),t)}function No(t,e){return t&&_i(e,Bc(e),t)}function Do(t,e,n){"__proto__"==e&&Ye?Ye(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function xo(t,e){for(var n=-1,r=e.length,i=Mt(r),a=null==t;++n<r;)i[n]=a?o:Rc(t,e[n]);return i}function Bo(t,e,n){return t==t&&(n!==o&&(t=t<=n?t:n),e!==o&&(t=t>=e?t:e)),t}function Lo(t,e,n,r,i,a){var u,p=e&s,f=e&c,h=e&l;if(n&&(u=i?n(t,r,i,a):n(t)),u!==o)return u;if(!oc(t))return t;var d=Ys(t);if(d){if(u=fa(t),!p)return yi(t,u)}else{var y=ca(t),_=y==G||y==j;if(Qs(t))return ai(t,p);if(y==W||y==N||_&&!i){if(u=f||_?{}:ha(t),!p)return f?vi(t,No(u,t)):gi(t,Io(u,t))}else{if(!ye[y])return i?t:{};u=da(t,y,p)}}a||(a=new So);var g=a.get(t);if(g)return g;a.set(t,u),lc(t)?t.forEach(function(o){u.add(Lo(o,e,n,o,t,a))}):ic(t)&&t.forEach(function(o,r){u.set(r,Lo(o,e,n,r,t,a))});var v=d?o:(h?f?Qi:Xi:f?Bc:xc)(t);return Be(v||t,function(o,r){v&&(o=t[r=o]),Oo(u,r,Lo(o,e,n,r,t,a))}),u}function ko(t){var e=xc(t);return function(n){return Uo(n,t,e)}}function Uo(t,e,n){var r=n.length;if(null==t)return!r;for(t=zt(t);r--;){var i=n[r],a=e[i],s=t[i];if(s===o&&!(i in t)||!a(s))return!1}return!0}function Go(t,e,n){if("function"!=typeof t)throw new Kt(i);return Da(function(){t.apply(o,n)},e)}function jo(t,e,n,o){var i=-1,a=Ge,s=!0,c=t.length,l=[],u=e.length;if(!c)return l;n&&(e=Ve(e,un(n))),o?(a=je,s=!1):e.length>=r&&(a=fn,s=!1,e=new wo(e));t:for(;++i<c;){var p=t[i],f=null==n?p:n(p);if(p=o||0!==p?p:0,s&&f==f){for(var h=u;h--;)if(e[h]===f)continue t;l.push(p)}else a(e,f,o)||l.push(p)}return l}fo.templateSettings={escape:_t,evaluate:gt,interpolate:vt,variable:"",imports:{_:fo}},fo.prototype=yo.prototype,fo.prototype.constructor=fo,_o.prototype=ho(yo.prototype),_o.prototype.constructor=_o,go.prototype=ho(yo.prototype),go.prototype.constructor=go,vo.prototype.clear=function(){this.__data__=eo?eo(null):{},this.size=0},vo.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},vo.prototype.get=function(t){var e=this.__data__;if(eo){var n=e[t];return"__lodash_hash_undefined__"===n?o:n}return te.call(e,t)?e[t]:o},vo.prototype.has=function(t){var e=this.__data__;return eo?e[t]!==o:te.call(e,t)},vo.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=eo&&e===o?"__lodash_hash_undefined__":e,this},mo.prototype.clear=function(){this.__data__=[],this.size=0},mo.prototype.delete=function(t){var e=this.__data__,n=Ro(e,t);return!(n<0||(n==e.length-1?e.pop():Ce.call(e,n,1),--this.size,0))},mo.prototype.get=function(t){var e=this.__data__,n=Ro(e,t);return n<0?o:e[n][1]},mo.prototype.has=function(t){return Ro(this.__data__,t)>-1},mo.prototype.set=function(t,e){var n=this.__data__,o=Ro(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this},bo.prototype.clear=function(){this.size=0,this.__data__={hash:new vo,map:new(Qn||mo),string:new vo}},bo.prototype.delete=function(t){var e=na(this,t).delete(t);return this.size-=e?1:0,e},bo.prototype.get=function(t){return na(this,t).get(t)},bo.prototype.has=function(t){return na(this,t).has(t)},bo.prototype.set=function(t,e){var n=na(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this},wo.prototype.add=wo.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},wo.prototype.has=function(t){return this.__data__.has(t)},So.prototype.clear=function(){this.__data__=new mo,this.size=0},So.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},So.prototype.get=function(t){return this.__data__.get(t)},So.prototype.has=function(t){return this.__data__.has(t)},So.prototype.set=function(t,e){var n=this.__data__;if(n instanceof mo){var o=n.__data__;if(!Qn||o.length<r-1)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new bo(o)}return n.set(t,e),this.size=n.size,this};var Vo=wi(Xo),Fo=wi(Qo,!0);function Ho(t,e){var n=!0;return Vo(t,function(t,o,r){return n=!!e(t,o,r)}),n}function Wo(t,e,n){for(var r=-1,i=t.length;++r<i;){var a=t[r],s=e(a);if(null!=s&&(c===o?s==s&&!pc(s):n(s,c)))var c=s,l=a}return l}function zo(t,e,n,r){var i=t.length;for((n=gc(n))<0&&(n=-n>i?0:i+n),(r=r===o||r>i?i:gc(r))<0&&(r+=i),r=n>r?0:vc(r);n<r;)t[n++]=e;return t}function qo(t,e){var n=[];return Vo(t,function(t,o,r){e(t,o,r)&&n.push(t)}),n}function Yo(t,e,n,o,r){var i=-1,a=t.length;for(n||(n=_a),r||(r=[]);++i<a;){var s=t[i];e>0&&n(s)?e>1?Yo(s,e-1,n,o,r):Fe(r,s):o||(r[r.length]=s)}return r}var Ko=Si(),Jo=Si(!0);function Xo(t,e){return t&&Ko(t,e,xc)}function Qo(t,e){return t&&Jo(t,e,xc)}function Zo(t,e){return Ue(e,function(e){return tc(t[e])})}function $o(t,e){for(var n=0,r=(e=ni(e,t)).length;null!=t&&n<r;)t=t[Ga(e[n++])];return n&&n==r?t:o}function tr(t,e,n){var o=e(t);return Ys(t)?o:Fe(o,n(t))}function er(t){return null==t?t===o?X:H:qe&&qe in zt(t)?ia(t):Ea(t)}function nr(t,e){return t>e}function or(t,e){return null!=t&&te.call(t,e)}function rr(t,e){return null!=t&&e in zt(t)}function ir(t,e,n){return t>=zn(e,n)&&t<Wn(e,n)}function ar(t,e,n){for(var r=n?je:Ge,i=t[0].length,a=t.length,s=a,c=Mt(a),l=1/0,u=[];s--;){var p=t[s];s&&e&&(p=Ve(p,un(e))),l=zn(p.length,l),c[s]=!n&&(e||i>=120&&p.length>=120)?new wo(s&&p):o}p=t[0];var f=-1,h=c[0];t:for(;++f<i&&u.length<l;){var d=p[f],y=e?e(d):d;if(d=n||0!==d?d:0,!(h?fn(h,y):r(u,y,n))){for(s=a;--s;){var _=c[s];if(!(_?fn(_,y):r(t[s],y,n)))continue t}h&&h.push(y),u.push(d)}}return u}function sr(t,e,n,o){return Xo(t,function(t,r,i){e(o,n(t),r,i)}),o}function cr(t,e,n){var r=null==(t=Ra(t,e=ni(e,t)))?t:t[Ga($a(e))];return null==r?o:De(r,t,n)}function lr(t){return rc(t)&&er(t)==N}function ur(t,e,n,o,r){return t===e||(null==t||null==e||!rc(t)&&!rc(e)?t!=t&&e!=e:pr(t,e,n,o,ur,r))}function pr(t,e,n,o,r,i){var a=Ys(t),s=Ys(e),c=a?D:ca(t),l=s?D:ca(e),p=(c=c==N?W:c)==W,f=(l=l==N?W:l)==W,h=c==l;if(h&&Qs(t)){if(!Qs(e))return!1;a=!0,p=!1}if(h&&!p)return i||(i=new So),a||fc(t)?qi(t,e,n,o,r,i):Yi(t,e,c,n,o,r,i);if(!(n&u)){var d=p&&te.call(t,"__wrapped__"),y=f&&te.call(e,"__wrapped__");if(d||y){var _=d?t.value():t,g=y?e.value():e;return i||(i=new So),r(_,g,n,o,i)}}return!!h&&(i||(i=new So),Ki(t,e,n,o,r,i))}function fr(t,e,n,r){var i=n.length,a=i,s=!r;if(null==t)return!a;for(t=zt(t);i--;){var c=n[i];if(s&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++i<a;){var l=(c=n[i])[0],f=t[l],h=c[1];if(s&&c[2]){if(f===o&&!(l in t))return!1}else{var d=new So;if(r)var y=r(f,h,l,t,e,d);if(!(y===o?ur(h,f,u|p,r,d):y))return!1}}return!0}function hr(t){return!(!oc(t)||(e=t,ne&&ne in e))&&(tc(t)?ce:Lt).test(ja(t));var e}function dr(t){return"function"==typeof t?t:null==t?al:"object"==typeof t?Ys(t)?br(t[0],t[1]):mr(t):yl(t)}function yr(t){if(!Sa(t))return Hn(t);var e=[];for(var n in zt(t))te.call(t,n)&&"constructor"!=n&&e.push(n);return e}function _r(t){if(!oc(t))return Pa(t);var e=Sa(t),n=[];for(var o in t)("constructor"!=o||!e&&te.call(t,o))&&n.push(o);return n}function gr(t,e){return t<e}function vr(t,e){var n=-1,o=Js(t)?Mt(t.length):[];return Vo(t,function(t,r,i){o[++n]=e(t,r,i)}),o}function mr(t){var e=oa(t);return 1==e.length&&e[0][2]?Aa(e[0][0],e[0][1]):function(n){return n===t||fr(n,t,e)}}function br(t,e){return ma(t)&&Ca(e)?Aa(Ga(t),e):function(n){var r=Rc(n,t);return r===o&&r===e?Tc(n,t):ur(e,r,u|p)}}function wr(t,e,n,r,i){t!==e&&Ko(e,function(a,s){if(i||(i=new So),oc(a))Sr(t,e,s,n,wr,r,i);else{var c=r?r(Ia(t,s),a,s+"",t,e,i):o;c===o&&(c=a),Eo(t,s,c)}},Bc)}function Sr(t,e,n,r,i,a,s){var c=Ia(t,n),l=Ia(e,n),u=s.get(l);if(u)Eo(t,n,u);else{var p=a?a(c,l,n+"",t,e,s):o,f=p===o;if(f){var h=Ys(l),d=!h&&Qs(l),y=!h&&!d&&fc(l);p=l,h||d||y?Ys(c)?p=c:Xs(c)?p=yi(c):d?(f=!1,p=ai(l,!0)):y?(f=!1,p=ui(l,!0)):p=[]:sc(l)||qs(l)?(p=c,qs(c)?p=bc(c):oc(c)&&!tc(c)||(p=ha(l))):f=!1}f&&(s.set(l,p),i(p,l,r,a,s),s.delete(l)),Eo(t,n,p)}}function Cr(t,e){var n=t.length;if(n)return ga(e+=e<0?n:0,n)?t[e]:o}function Ar(t,e,n){e=e.length?Ve(e,function(t){return Ys(t)?function(e){return $o(e,1===t.length?t[0]:t)}:t}):[al];var o=-1;return e=Ve(e,un(ea())),rn(vr(t,function(t){return{criteria:Ve(e,function(e){return e(t)}),index:++o,value:t}}),function(t,e){return fi(t,e,n)})}function Mr(t,e){return Pr(t,e,function(e,n){return Tc(t,n)})}function Pr(t,e,n){for(var o=-1,r=e.length,i={};++o<r;){var a=e[o],s=$o(t,a);n(s,a)&&Lr(i,ni(a,t),s)}return i}function Er(t){return function(e){return $o(e,t)}}function Or(t,e,n,o){var r=o?Ze:Qe,i=-1,a=e.length,s=t;for(t===e&&(e=yi(e)),n&&(s=Ve(t,un(n)));++i<a;)for(var c=0,l=e[i],u=n?n(l):l;(c=r(s,u,c,o))>-1;)s!==t&&Ce.call(s,c,1),Ce.call(t,c,1);return t}function Rr(t,e){for(var n=t?e.length:0,o=n-1;n--;){var r=e[n];if(n==o||r!==i){var i=r;ga(r)?Ce.call(t,r,1):Kr(t,r)}}return t}function Tr(t,e){return t+Un(Kn()*(e-t+1))}function Ir(t,e,n,o){for(var r=-1,i=Wn(Bn((e-t)/(n||1)),0),a=Mt(i);i--;)a[o?i:++r]=t,t+=n;return a}function Nr(t,e){var n="";if(!t||e<1||e>M)return n;do{e%2&&(n+=t),(e=Un(e/2))&&(t+=t)}while(e);return n}function Dr(t,e){return xa(Oa(t,e,al),t+"")}function xr(t){return Ao(Hc(t))}function Br(t,e){var n=Hc(t);return ka(n,Bo(e,0,n.length))}function Lr(t,e,n,r){if(!oc(t))return t;for(var i=-1,a=(e=ni(e,t)).length,s=a-1,c=t;null!=c&&++i<a;){var l=Ga(e[i]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(i!=s){var p=c[l];(u=r?r(p,l,c):o)===o&&(u=oc(p)?p:ga(e[i+1])?[]:{})}Oo(c,l,u),c=c[l]}return t}var kr=no?function(t,e){return no.set(t,e),t}:al,Ur=Ye?function(t,e){return Ye(t,"toString",{configurable:!0,enumerable:!1,value:ol(e),writable:!0})}:al;function Gr(t){return ka(Hc(t))}function jr(t,e,n){var o=-1,r=t.length;e<0&&(e=-e>r?0:r+e),(n=n>r?r:n)<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var i=Mt(r);++o<r;)i[o]=t[o+e];return i}function Vr(t,e){var n;return Vo(t,function(t,o,r){return!(n=e(t,o,r))}),!!n}function Fr(t,e,n){var o=0,r=null==t?o:t.length;if("number"==typeof e&&e==e&&r<=T){for(;o<r;){var i=o+r>>>1,a=t[i];null!==a&&!pc(a)&&(n?a<=e:a<e)?o=i+1:r=i}return r}return Hr(t,e,al,n)}function Hr(t,e,n,r){var i=0,a=null==t?0:t.length;if(0===a)return 0;for(var s=(e=n(e))!=e,c=null===e,l=pc(e),u=e===o;i<a;){var p=Un((i+a)/2),f=n(t[p]),h=f!==o,d=null===f,y=f==f,_=pc(f);if(s)var g=r||y;else g=u?y&&(r||h):c?y&&h&&(r||!d):l?y&&h&&!d&&(r||!_):!d&&!_&&(r?f<=e:f<e);g?i=p+1:a=p}return zn(a,R)}function Wr(t,e){for(var n=-1,o=t.length,r=0,i=[];++n<o;){var a=t[n],s=e?e(a):a;if(!n||!Hs(s,c)){var c=s;i[r++]=0===a?0:a}}return i}function zr(t){return"number"==typeof t?t:pc(t)?E:+t}function qr(t){if("string"==typeof t)return t;if(Ys(t))return Ve(t,qr)+"";if(pc(t))return po?po.call(t):"";var e=t+"";return"0"==e&&1/t==-A?"-0":e}function Yr(t,e,n){var o=-1,i=Ge,a=t.length,s=!0,c=[],l=c;if(n)s=!1,i=je;else if(a>=r){var u=e?null:ji(t);if(u)return Pn(u);s=!1,i=fn,l=new wo}else l=e?[]:c;t:for(;++o<a;){var p=t[o],f=e?e(p):p;if(p=n||0!==p?p:0,s&&f==f){for(var h=l.length;h--;)if(l[h]===f)continue t;e&&l.push(f),c.push(p)}else i(l,f,n)||(l!==c&&l.push(f),c.push(p))}return c}function Kr(t,e){return null==(t=Ra(t,e=ni(e,t)))||delete t[Ga($a(e))]}function Jr(t,e,n,o){return Lr(t,e,n($o(t,e)),o)}function Xr(t,e,n,o){for(var r=t.length,i=o?r:-1;(o?i--:++i<r)&&e(t[i],i,t););return n?jr(t,o?0:i,o?i+1:r):jr(t,o?i+1:0,o?r:i)}function Qr(t,e){var n=t;return n instanceof go&&(n=n.value()),He(e,function(t,e){return e.func.apply(e.thisArg,Fe([t],e.args))},n)}function Zr(t,e,n){var o=t.length;if(o<2)return o?Yr(t[0]):[];for(var r=-1,i=Mt(o);++r<o;)for(var a=t[r],s=-1;++s<o;)s!=r&&(i[r]=jo(i[r]||a,t[s],e,n));return Yr(Yo(i,1),e,n)}function $r(t,e,n){for(var r=-1,i=t.length,a=e.length,s={};++r<i;){var c=r<a?e[r]:o;n(s,t[r],c)}return s}function ti(t){return Xs(t)?t:[]}function ei(t){return"function"==typeof t?t:al}function ni(t,e){return Ys(t)?t:ma(t,e)?[t]:Ua(wc(t))}var oi=Dr;function ri(t,e,n){var r=t.length;return n=n===o?r:n,!e&&n>=r?t:jr(t,e,n)}var ii=nn||function(t){return we.clearTimeout(t)};function ai(t,e){if(e)return t.slice();var n=t.length,o=_e?_e(n):new t.constructor(n);return t.copy(o),o}function si(t){var e=new t.constructor(t.byteLength);return new pe(e).set(new pe(t)),e}function ci(t,e){var n=e?si(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}function li(t){var e=new t.constructor(t.source,Dt.exec(t));return e.lastIndex=t.lastIndex,e}function ui(t,e){var n=e?si(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function pi(t,e){if(t!==e){var n=t!==o,r=null===t,i=t==t,a=pc(t),s=e!==o,c=null===e,l=e==e,u=pc(e);if(!c&&!u&&!a&&t>e||a&&s&&l&&!c&&!u||r&&s&&l||!n&&l||!i)return 1;if(!r&&!a&&!u&&t<e||u&&n&&i&&!r&&!a||c&&n&&i||!s&&i||!l)return-1}return 0}function fi(t,e,n){for(var o=-1,r=t.criteria,i=e.criteria,a=r.length,s=n.length;++o<a;){var c=pi(r[o],i[o]);if(c)return o>=s?c:c*("desc"==n[o]?-1:1)}return t.index-e.index}function hi(t,e,n,o){for(var r=-1,i=t.length,a=n.length,s=-1,c=e.length,l=Wn(i-a,0),u=Mt(c+l),p=!o;++s<c;)u[s]=e[s];for(;++r<a;)(p||r<i)&&(u[n[r]]=t[r]);for(;l--;)u[s++]=t[r++];return u}function di(t,e,n,o){for(var r=-1,i=t.length,a=-1,s=n.length,c=-1,l=e.length,u=Wn(i-s,0),p=Mt(u+l),f=!o;++r<u;)p[r]=t[r];for(var h=r;++c<l;)p[h+c]=e[c];for(;++a<s;)(f||r<i)&&(p[h+n[a]]=t[r++]);return p}function yi(t,e){var n=-1,o=t.length;for(e||(e=Mt(o));++n<o;)e[n]=t[n];return e}function _i(t,e,n,r){var i=!n;n||(n={});for(var a=-1,s=e.length;++a<s;){var c=e[a],l=r?r(n[c],t[c],c,n,t):o;l===o&&(l=t[c]),i?Do(n,c,l):Oo(n,c,l)}return n}function gi(t,e){return _i(t,aa(t),e)}function vi(t,e){return _i(t,sa(t),e)}function mi(t,e){return function(n,o){var r=Ys(n)?xe:To,i=e?e():{};return r(n,t,ea(o,2),i)}}function bi(t){return Dr(function(e,n){var r=-1,i=n.length,a=i>1?n[i-1]:o,s=i>2?n[2]:o;for(a=t.length>3&&"function"==typeof a?(i--,a):o,s&&va(n[0],n[1],s)&&(a=i<3?o:a,i=1),e=zt(e);++r<i;){var c=n[r];c&&t(e,c,r,a)}return e})}function wi(t,e){return function(n,o){if(null==n)return n;if(!Js(n))return t(n,o);for(var r=n.length,i=e?r:-1,a=zt(n);(e?i--:++i<r)&&!1!==o(a[i],i,a););return n}}function Si(t){return function(e,n,o){for(var r=-1,i=zt(e),a=o(e),s=a.length;s--;){var c=a[t?s:++r];if(!1===n(i[c],c,i))break}return e}}function Ci(t,e,n){var o=e&f,r=Pi(t);return function e(){return(this&&this!==we&&this instanceof e?r:t).apply(o?n:this,arguments)}}function Ai(t){return function(e){var n=bn(e=wc(e))?In(e):o,r=n?n[0]:e.charAt(0),i=n?ri(n,1).join(""):e.slice(1);return r[t]()+i}}function Mi(t){return function(e){return He(tl(qc(e).replace(ae,"")),t,"")}}function Pi(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=ho(t.prototype),o=t.apply(n,e);return oc(o)?o:n}}function Ei(t,e,n){var r=Pi(t);return function i(){for(var a=arguments.length,s=Mt(a),c=a,l=ta(i);c--;)s[c]=arguments[c];var u=a<3&&s[0]!==l&&s[a-1]!==l?[]:Mn(s,l);return(a-=u.length)<n?Ui(t,e,Ti,i.placeholder,o,s,u,o,o,n-a):De(this&&this!==we&&this instanceof i?r:t,this,s)}}function Oi(t){return function(e,n,r){var i=zt(e);if(!Js(e)){var a=ea(n,3);e=xc(e),n=function(t){return a(i[t],t,i)}}var s=t(e,n,r);return s>-1?i[a?e[s]:s]:o}}function Ri(t){return Ji(function(e){var n=e.length,r=n,a=_o.prototype.thru;for(t&&e.reverse();r--;){var s=e[r];if("function"!=typeof s)throw new Kt(i);if(a&&!c&&"wrapper"==$i(s))var c=new _o([],!0)}for(r=c?r:n;++r<n;){var l=$i(s=e[r]),u="wrapper"==l?Zi(s):o;c=u&&ba(u[0])&&u[1]==(m|y|g|b)&&!u[4].length&&1==u[9]?c[$i(u[0])].apply(c,u[3]):1==s.length&&ba(s)?c[l]():c.thru(s)}return function(){var t=arguments,o=t[0];if(c&&1==t.length&&Ys(o))return c.plant(o).value();for(var r=0,i=n?e[r].apply(this,t):o;++r<n;)i=e[r].call(this,i);return i}})}function Ti(t,e,n,r,i,a,s,c,l,u){var p=e&m,d=e&f,g=e&h,v=e&(y|_),b=e&w,S=g?o:Pi(t);return function o(){for(var f=arguments.length,h=Mt(f),y=f;y--;)h[y]=arguments[y];if(v)var _=ta(o),m=yn(h,_);if(r&&(h=hi(h,r,i,v)),a&&(h=di(h,a,s,v)),f-=m,v&&f<u){var w=Mn(h,_);return Ui(t,e,Ti,o.placeholder,n,h,w,c,l,u-f)}var C=d?n:this,A=g?C[t]:t;return f=h.length,c?h=Ta(h,c):b&&f>1&&h.reverse(),p&&l<f&&(h.length=l),this&&this!==we&&this instanceof o&&(A=S||Pi(A)),A.apply(C,h)}}function Ii(t,e){return function(n,o){return sr(n,t,e(o),{})}}function Ni(t,e){return function(n,r){var i;if(n===o&&r===o)return e;if(n!==o&&(i=n),r!==o){if(i===o)return r;"string"==typeof n||"string"==typeof r?(n=qr(n),r=qr(r)):(n=zr(n),r=zr(r)),i=t(n,r)}return i}}function Di(t){return Ji(function(e){return e=Ve(e,un(ea())),Dr(function(n){var o=this;return t(e,function(t){return De(t,o,n)})})})}function xi(t,e){var n=(e=e===o?" ":qr(e)).length;if(n<2)return n?Nr(e,t):e;var r=Nr(e,Bn(t/Tn(e)));return bn(e)?ri(In(r),0,t).join(""):r.slice(0,t)}function Bi(t,e,n,o){var r=e&f,i=Pi(t);return function e(){for(var a=-1,s=arguments.length,c=-1,l=o.length,u=Mt(l+s),p=this&&this!==we&&this instanceof e?i:t;++c<l;)u[c]=o[c];for(;s--;)u[c++]=arguments[++a];return De(p,r?n:this,u)}}function Li(t){return function(e,n,r){return r&&"number"!=typeof r&&va(e,n,r)&&(n=r=o),e=_c(e),n===o?(n=e,e=0):n=_c(n),Ir(e,n,r=r===o?e<n?1:-1:_c(r),t)}}function ki(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=mc(e),n=mc(n)),t(e,n)}}function Ui(t,e,n,r,i,a,s,c,l,u){var p=e&y;e|=p?g:v,(e&=~(p?v:g))&d||(e&=~(f|h));var _=[t,e,i,p?a:o,p?s:o,p?o:a,p?o:s,c,l,u],m=n.apply(o,_);return ba(t)&&Na(m,_),m.placeholder=r,Ba(m,t,e)}function Gi(t){var e=Wt[t];return function(t,n){if(t=mc(t),(n=null==n?0:zn(gc(n),292))&&Vn(t)){var o=(wc(t)+"e").split("e");return+((o=(wc(e(o[0]+"e"+(+o[1]+n)))+"e").split("e"))[0]+"e"+(+o[1]-n))}return e(t)}}var ji=$n&&1/Pn(new $n([,-0]))[1]==A?function(t){return new $n(t)}:pl;function Vi(t){return function(e){var n=ca(e);return n==V?Cn(e):n==Y?En(e):cn(e,t(e))}}function Fi(t,e,n,r,a,s,c,l){var u=e&h;if(!u&&"function"!=typeof t)throw new Kt(i);var p=r?r.length:0;if(p||(e&=~(g|v),r=a=o),c=c===o?c:Wn(gc(c),0),l=l===o?l:gc(l),p-=a?a.length:0,e&v){var d=r,m=a;r=a=o}var b=u?o:Zi(t),w=[t,e,n,r,a,d,m,s,c,l];if(b&&Ma(w,b),t=w[0],e=w[1],n=w[2],r=w[3],a=w[4],!(l=w[9]=w[9]===o?u?0:t.length:Wn(w[9]-p,0))&&e&(y|_)&&(e&=~(y|_)),e&&e!=f)S=e==y||e==_?Ei(t,e,l):e!=g&&e!=(f|g)||a.length?Ti.apply(o,w):Bi(t,e,n,r);else var S=Ci(t,e,n);return Ba((b?kr:Na)(S,w),t,e)}function Hi(t,e,n,r){return t===o||Hs(t,Qt[n])&&!te.call(r,n)?e:t}function Wi(t,e,n,r,i,a){return oc(t)&&oc(e)&&(a.set(e,t),wr(t,e,o,Wi,a),a.delete(e)),t}function zi(t){return sc(t)?o:t}function qi(t,e,n,r,i,a){var s=n&u,c=t.length,l=e.length;if(c!=l&&!(s&&l>c))return!1;var f=a.get(t),h=a.get(e);if(f&&h)return f==e&&h==t;var d=-1,y=!0,_=n&p?new wo:o;for(a.set(t,e),a.set(e,t);++d<c;){var g=t[d],v=e[d];if(r)var m=s?r(v,g,d,e,t,a):r(g,v,d,t,e,a);if(m!==o){if(m)continue;y=!1;break}if(_){if(!ze(e,function(t,e){if(!fn(_,e)&&(g===t||i(g,t,n,r,a)))return _.push(e)})){y=!1;break}}else if(g!==v&&!i(g,v,n,r,a)){y=!1;break}}return a.delete(t),a.delete(e),y}function Yi(t,e,n,o,r,i,a){switch(n){case $:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Z:return!(t.byteLength!=e.byteLength||!i(new pe(t),new pe(e)));case B:case L:case F:return Hs(+t,+e);case U:return t.name==e.name&&t.message==e.message;case q:case K:return t==e+"";case V:var s=Cn;case Y:var c=o&u;if(s||(s=Pn),t.size!=e.size&&!c)return!1;var l=a.get(t);if(l)return l==e;o|=p,a.set(t,e);var f=qi(s(t),s(e),o,r,i,a);return a.delete(t),f;case J:if(uo)return uo.call(t)==uo.call(e)}return!1}function Ki(t,e,n,r,i,a){var s=n&u,c=Xi(t),l=c.length;if(l!=Xi(e).length&&!s)return!1;for(var p=l;p--;){var f=c[p];if(!(s?f in e:te.call(e,f)))return!1}var h=a.get(t),d=a.get(e);if(h&&d)return h==e&&d==t;var y=!0;a.set(t,e),a.set(e,t);for(var _=s;++p<l;){var g=t[f=c[p]],v=e[f];if(r)var m=s?r(v,g,f,e,t,a):r(g,v,f,t,e,a);if(!(m===o?g===v||i(g,v,n,r,a):m)){y=!1;break}_||(_="constructor"==f)}if(y&&!_){var b=t.constructor,w=e.constructor;b!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(y=!1)}return a.delete(t),a.delete(e),y}function Ji(t){return xa(Oa(t,o,Ka),t+"")}function Xi(t){return tr(t,xc,aa)}function Qi(t){return tr(t,Bc,sa)}var Zi=no?function(t){return no.get(t)}:pl;function $i(t){for(var e=t.name+"",n=oo[e],o=te.call(oo,e)?n.length:0;o--;){var r=n[o],i=r.func;if(null==i||i==t)return r.name}return e}function ta(t){return(te.call(fo,"placeholder")?fo:t).placeholder}function ea(){var t=fo.iteratee||sl;return t=t===sl?dr:t,arguments.length?t(arguments[0],arguments[1]):t}function na(t,e){var n,o,r=t.__data__;return("string"==(o=typeof(n=e))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function oa(t){for(var e=xc(t),n=e.length;n--;){var o=e[n],r=t[o];e[n]=[o,r,Ca(r)]}return e}function ra(t,e){var n=mn(t,e);return hr(n)?n:o}function ia(t){var e=te.call(t,qe),n=t[qe];try{t[qe]=o;var r=!0}catch(a){}var i=oe.call(t);return r&&(e?t[qe]=n:delete t[qe]),i}var aa=Gn?function(t){return null==t?[]:(t=zt(t),Ue(Gn(t),function(e){return Se.call(t,e)}))}:vl,sa=Gn?function(t){for(var e=[];t;)Fe(e,aa(t)),t=me(t);return e}:vl,ca=er;function la(t,e,n){for(var o=-1,r=n.length;++o<r;){var i=n[o],a=i.size;switch(i.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=zn(e,t+a);break;case"takeRight":t=Wn(t,e-a)}}return{start:t,end:e}}function ua(t){var e=t.match(Et);return e?e[1].split(Ot):[]}function pa(t,e,n){for(var o=-1,r=(e=ni(e,t)).length,i=!1;++o<r;){var a=Ga(e[o]);if(!(i=null!=t&&n(t,a)))break;t=t[a]}return i||++o!=r?i:!!(r=null==t?0:t.length)&&nc(r)&&ga(a,r)&&(Ys(t)||qs(t))}function fa(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&te.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function ha(t){return"function"!=typeof t.constructor||Sa(t)?{}:ho(me(t))}function da(t,e,n){var o,r=t.constructor;switch(e){case Z:return si(t);case B:case L:return new r(+t);case $:return ci(t,n);case tt:case et:case nt:case ot:case rt:case it:case at:case st:case ct:return ui(t,n);case V:return new r;case F:case K:return new r(t);case q:return li(t);case Y:return new r;case J:return o=t,uo?zt(uo.call(o)):{}}}function ya(t,e){var n=e.length;if(!n)return t;var o=n-1;return e[o]=(n>1?"& ":"")+e[o],e=e.join(n>2?", ":" "),t.replace(Pt,"{\n/* [wrapped with "+e+"] */\n")}function _a(t){return Ys(t)||qs(t)||!!(Me&&t&&t[Me])}function ga(t,e){var n=typeof t;return!!(e=null==e?M:e)&&("number"==n||"symbol"!=n&&Ut.test(t))&&t>-1&&t%1==0&&t<e}function va(t,e,n){if(!oc(n))return!1;var o=typeof e;return!!("number"==o?Js(n)&&ga(e,n.length):"string"==o&&e in n)&&Hs(n[e],t)}function ma(t,e){if(Ys(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!pc(t))||bt.test(t)||!mt.test(t)||null!=e&&t in zt(e)}function ba(t){var e=$i(t),n=fo[e];if("function"!=typeof n||!(e in go.prototype))return!1;if(t===n)return!0;var o=Zi(n);return!!o&&t===o[0]}(Xn&&ca(new Xn(new ArrayBuffer(1)))!=$||Qn&&ca(new Qn)!=V||Zn&&"[object Promise]"!=ca(Zn.resolve())||$n&&ca(new $n)!=Y||to&&ca(new to)!=Q)&&(ca=function(t){var e=er(t),n=e==W?t.constructor:o,r=n?ja(n):"";if(r)switch(r){case ro:return $;case io:return V;case ao:return"[object Promise]";case so:return Y;case co:return Q}return e});var wa=Zt?tc:ml;function Sa(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Qt)}function Ca(t){return t==t&&!oc(t)}function Aa(t,e){return function(n){return null!=n&&n[t]===e&&(e!==o||t in zt(n))}}function Ma(t,e){var n=t[1],o=e[1],r=n|o,i=r<(f|h|m),s=o==m&&n==y||o==m&&n==b&&t[7].length<=e[8]||o==(m|b)&&e[7].length<=e[8]&&n==y;if(!i&&!s)return t;o&f&&(t[2]=e[2],r|=n&f?0:d);var c=e[3];if(c){var l=t[3];t[3]=l?hi(l,c,e[4]):c,t[4]=l?Mn(t[3],a):e[4]}return(c=e[5])&&(l=t[5],t[5]=l?di(l,c,e[6]):c,t[6]=l?Mn(t[5],a):e[6]),(c=e[7])&&(t[7]=c),o&m&&(t[8]=null==t[8]?e[8]:zn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=r,t}function Pa(t){var e=[];if(null!=t)for(var n in zt(t))e.push(n);return e}function Ea(t){return oe.call(t)}function Oa(t,e,n){return e=Wn(e===o?t.length-1:e,0),function(){for(var o=arguments,r=-1,i=Wn(o.length-e,0),a=Mt(i);++r<i;)a[r]=o[e+r];r=-1;for(var s=Mt(e+1);++r<e;)s[r]=o[r];return s[e]=n(a),De(t,this,s)}}function Ra(t,e){return e.length<2?t:$o(t,jr(e,0,-1))}function Ta(t,e){for(var n=t.length,r=zn(e.length,n),i=yi(t);r--;){var a=e[r];t[r]=ga(a,n)?i[a]:o}return t}function Ia(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Na=La(kr),Da=xn||function(t,e){return we.setTimeout(t,e)},xa=La(Ur);function Ba(t,e,n){var o=e+"";return xa(t,ya(o,Va(ua(o),n)))}function La(t){var e=0,n=0;return function(){var r=qn(),i=C-(r-n);if(n=r,i>0){if(++e>=S)return arguments[0]}else e=0;return t.apply(o,arguments)}}function ka(t,e){var n=-1,r=t.length,i=r-1;for(e=e===o?r:e;++n<e;){var a=Tr(n,i),s=t[a];t[a]=t[n],t[n]=s}return t.length=e,t}var Ua=function(){var t=ks(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(wt,function(t,n,o,r){e.push(o?r.replace(It,"$1"):n||t)}),e},function(t){return 500===e.size&&e.clear(),t}),e=t.cache;return t}();function Ga(t){if("string"==typeof t||pc(t))return t;var e=t+"";return"0"==e&&1/t==-A?"-0":e}function ja(t){if(null!=t){try{return $t.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function Va(t,e){return Be(I,function(n){var o="_."+n[0];e&n[1]&&!Ge(t,o)&&t.push(o)}),t.sort()}function Fa(t){if(t instanceof go)return t.clone();var e=new _o(t.__wrapped__,t.__chain__);return e.__actions__=yi(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Ha=Dr(function(t,e){return Xs(t)?jo(t,Yo(e,1,Xs,!0)):[]}),Wa=Dr(function(t,e){var n=$a(e);return Xs(n)&&(n=o),Xs(t)?jo(t,Yo(e,1,Xs,!0),ea(n,2)):[]}),za=Dr(function(t,e){var n=$a(e);return Xs(n)&&(n=o),Xs(t)?jo(t,Yo(e,1,Xs,!0),o,n):[]});function qa(t,e,n){var o=null==t?0:t.length;if(!o)return-1;var r=null==n?0:gc(n);return r<0&&(r=Wn(o+r,0)),Xe(t,ea(e,3),r)}function Ya(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return n!==o&&(i=gc(n),i=n<0?Wn(r+i,0):zn(i,r-1)),Xe(t,ea(e,3),i,!0)}function Ka(t){return null!=t&&t.length?Yo(t,1):[]}function Ja(t){return t&&t.length?t[0]:o}var Xa=Dr(function(t){var e=Ve(t,ti);return e.length&&e[0]===t[0]?ar(e):[]}),Qa=Dr(function(t){var e=$a(t),n=Ve(t,ti);return e===$a(n)?e=o:n.pop(),n.length&&n[0]===t[0]?ar(n,ea(e,2)):[]}),Za=Dr(function(t){var e=$a(t),n=Ve(t,ti);return(e="function"==typeof e?e:o)&&n.pop(),n.length&&n[0]===t[0]?ar(n,o,e):[]});function $a(t){var e=null==t?0:t.length;return e?t[e-1]:o}var ts=Dr(es);function es(t,e){return t&&t.length&&e&&e.length?Or(t,e):t}var ns=Ji(function(t,e){var n=null==t?0:t.length,o=xo(t,e);return Rr(t,Ve(e,function(t){return ga(t,n)?+t:t}).sort(pi)),o});function os(t){return null==t?t:Jn.call(t)}var rs=Dr(function(t){return Yr(Yo(t,1,Xs,!0))}),is=Dr(function(t){var e=$a(t);return Xs(e)&&(e=o),Yr(Yo(t,1,Xs,!0),ea(e,2))}),as=Dr(function(t){var e=$a(t);return e="function"==typeof e?e:o,Yr(Yo(t,1,Xs,!0),o,e)});function ss(t){if(!t||!t.length)return[];var e=0;return t=Ue(t,function(t){if(Xs(t))return e=Wn(t.length,e),!0}),sn(e,function(e){return Ve(t,en(e))})}function cs(t,e){if(!t||!t.length)return[];var n=ss(t);return null==e?n:Ve(n,function(t){return De(e,o,t)})}var ls=Dr(function(t,e){return Xs(t)?jo(t,e):[]}),us=Dr(function(t){return Zr(Ue(t,Xs))}),ps=Dr(function(t){var e=$a(t);return Xs(e)&&(e=o),Zr(Ue(t,Xs),ea(e,2))}),fs=Dr(function(t){var e=$a(t);return e="function"==typeof e?e:o,Zr(Ue(t,Xs),o,e)}),hs=Dr(ss),ds=Dr(function(t){var e=t.length,n=e>1?t[e-1]:o;return n="function"==typeof n?(t.pop(),n):o,cs(t,n)});function ys(t){var e=fo(t);return e.__chain__=!0,e}function _s(t,e){return e(t)}var gs=Ji(function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,i=function(e){return xo(e,t)};return!(e>1||this.__actions__.length)&&r instanceof go&&ga(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:_s,args:[i],thisArg:o}),new _o(r,this.__chain__).thru(function(t){return e&&!t.length&&t.push(o),t})):this.thru(i)}),vs=mi(function(t,e,n){te.call(t,n)?++t[n]:Do(t,n,1)}),ms=Oi(qa),bs=Oi(Ya);function ws(t,e){return(Ys(t)?Be:Vo)(t,ea(e,3))}function Ss(t,e){return(Ys(t)?Le:Fo)(t,ea(e,3))}var Cs=mi(function(t,e,n){te.call(t,n)?t[n].push(e):Do(t,n,[e])}),As=Dr(function(t,e,n){var o=-1,r="function"==typeof e,i=Js(t)?Mt(t.length):[];return Vo(t,function(t){i[++o]=r?De(e,t,n):cr(t,e,n)}),i}),Ms=mi(function(t,e,n){Do(t,n,e)});function Ps(t,e){return(Ys(t)?Ve:vr)(t,ea(e,3))}var Es=mi(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),Os=Dr(function(t,e){if(null==t)return[];var n=e.length;return n>1&&va(t,e[0],e[1])?e=[]:n>2&&va(e[0],e[1],e[2])&&(e=[e[0]]),Ar(t,Yo(e,1),[])}),Rs=On||function(){return we.Date.now()};function Ts(t,e,n){return e=n?o:e,e=t&&null==e?t.length:e,Fi(t,m,o,o,o,o,e)}function Is(t,e){var n;if("function"!=typeof e)throw new Kt(i);return t=gc(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=o),n}}var Ns=Dr(function(t,e,n){var o=f;if(n.length){var r=Mn(n,ta(Ns));o|=g}return Fi(t,o,e,n,r)}),Ds=Dr(function(t,e,n){var o=f|h;if(n.length){var r=Mn(n,ta(Ds));o|=g}return Fi(e,o,t,n,r)});function xs(t,e,n){var r,a,s,c,l,u,p=0,f=!1,h=!1,d=!0;if("function"!=typeof t)throw new Kt(i);function y(e){var n=r,i=a;return r=a=o,p=e,c=t.apply(i,n)}function _(t){return p=t,l=Da(m,e),f?y(t):c}function g(t){var n=e-(t-u);return h?zn(n,s-(t-p)):n}function v(t){var n=t-u;return u===o||n>=e||n<0||h&&t-p>=s}function m(){var t=Rs();if(v(t))return b(t);l=Da(m,g(t))}function b(t){return l=o,d&&r?y(t):(r=a=o,c)}function w(){var t=Rs(),n=v(t);if(r=arguments,a=this,u=t,n){if(l===o)return _(u);if(h)return ii(l),l=Da(m,e),y(u)}return l===o&&(l=Da(m,e)),c}return e=mc(e)||0,oc(n)&&(f=!!n.leading,s=(h="maxWait"in n)?Wn(mc(n.maxWait)||0,e):s,d="trailing"in n?!!n.trailing:d),w.cancel=function(){l!==o&&ii(l),p=0,r=u=a=l=o},w.flush=function(){return l===o?c:b(Rs())},w}var Bs=Dr(function(t,e){return Go(t,1,e)}),Ls=Dr(function(t,e,n){return Go(t,mc(e)||0,n)});function ks(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Kt(i);var n=function(){var o=arguments,r=e?e.apply(this,o):o[0],i=n.cache;if(i.has(r))return i.get(r);var a=t.apply(this,o);return n.cache=i.set(r,a)||i,a};return n.cache=new(ks.Cache||bo),n}function Us(t){if("function"!=typeof t)throw new Kt(i);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}ks.Cache=bo;var Gs=oi(function(t,e){var n=(e=1==e.length&&Ys(e[0])?Ve(e[0],un(ea())):Ve(Yo(e,1),un(ea()))).length;return Dr(function(o){for(var r=-1,i=zn(o.length,n);++r<i;)o[r]=e[r].call(this,o[r]);return De(t,this,o)})}),js=Dr(function(t,e){var n=Mn(e,ta(js));return Fi(t,g,o,e,n)}),Vs=Dr(function(t,e){var n=Mn(e,ta(Vs));return Fi(t,v,o,e,n)}),Fs=Ji(function(t,e){return Fi(t,b,o,o,o,e)});function Hs(t,e){return t===e||t!=t&&e!=e}var Ws=ki(nr),zs=ki(function(t,e){return t>=e}),qs=lr(function(){return arguments}())?lr:function(t){return rc(t)&&te.call(t,"callee")&&!Se.call(t,"callee")},Ys=Mt.isArray,Ks=Ee?un(Ee):function(t){return rc(t)&&er(t)==Z};function Js(t){return null!=t&&nc(t.length)&&!tc(t)}function Xs(t){return rc(t)&&Js(t)}var Qs=jn||ml,Zs=Oe?un(Oe):function(t){return rc(t)&&er(t)==L};function $s(t){if(!rc(t))return!1;var e=er(t);return e==U||e==k||"string"==typeof t.message&&"string"==typeof t.name&&!sc(t)}function tc(t){if(!oc(t))return!1;var e=er(t);return e==G||e==j||e==x||e==z}function ec(t){return"number"==typeof t&&t==gc(t)}function nc(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=M}function oc(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function rc(t){return null!=t&&"object"==typeof t}var ic=Re?un(Re):function(t){return rc(t)&&ca(t)==V};function ac(t){return"number"==typeof t||rc(t)&&er(t)==F}function sc(t){if(!rc(t)||er(t)!=W)return!1;var e=me(t);if(null===e)return!0;var n=te.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&$t.call(n)==re}var cc=Te?un(Te):function(t){return rc(t)&&er(t)==q},lc=Ie?un(Ie):function(t){return rc(t)&&ca(t)==Y};function uc(t){return"string"==typeof t||!Ys(t)&&rc(t)&&er(t)==K}function pc(t){return"symbol"==typeof t||rc(t)&&er(t)==J}var fc=Ne?un(Ne):function(t){return rc(t)&&nc(t.length)&&!!de[er(t)]},hc=ki(gr),dc=ki(function(t,e){return t<=e});function yc(t){if(!t)return[];if(Js(t))return uc(t)?In(t):yi(t);if(Pe&&t[Pe])return Sn(t[Pe]());var e=ca(t);return(e==V?Cn:e==Y?Pn:Hc)(t)}function _c(t){return t?(t=mc(t))===A||t===-A?(t<0?-1:1)*P:t==t?t:0:0===t?t:0}function gc(t){var e=_c(t),n=e%1;return e==e?n?e-n:e:0}function vc(t){return t?Bo(gc(t),0,O):0}function mc(t){if("number"==typeof t)return t;if(pc(t))return E;if(oc(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=oc(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=ln(t);var n=Bt.test(t);return n||kt.test(t)?ve(t.slice(2),n?2:8):xt.test(t)?E:+t}function bc(t){return _i(t,Bc(t))}function wc(t){return null==t?"":qr(t)}var Sc=bi(function(t,e){if(Sa(e)||Js(e))_i(e,xc(e),t);else for(var n in e)te.call(e,n)&&Oo(t,n,e[n])}),Cc=bi(function(t,e){_i(e,Bc(e),t)}),Ac=bi(function(t,e,n,o){_i(e,Bc(e),t,o)}),Mc=bi(function(t,e,n,o){_i(e,xc(e),t,o)}),Pc=Ji(xo),Ec=Dr(function(t,e){t=zt(t);var n=-1,r=e.length,i=r>2?e[2]:o;for(i&&va(e[0],e[1],i)&&(r=1);++n<r;)for(var a=e[n],s=Bc(a),c=-1,l=s.length;++c<l;){var u=s[c],p=t[u];(p===o||Hs(p,Qt[u])&&!te.call(t,u))&&(t[u]=a[u])}return t}),Oc=Dr(function(t){return t.push(o,Wi),De(kc,o,t)});function Rc(t,e,n){var r=null==t?o:$o(t,e);return r===o?n:r}function Tc(t,e){return null!=t&&pa(t,e,rr)}var Ic=Ii(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=oe.call(e)),t[e]=n},ol(al)),Nc=Ii(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=oe.call(e)),te.call(t,e)?t[e].push(n):t[e]=[n]},ea),Dc=Dr(cr);function xc(t){return Js(t)?Co(t):yr(t)}function Bc(t){return Js(t)?Co(t,!0):_r(t)}var Lc=bi(function(t,e,n){wr(t,e,n)}),kc=bi(function(t,e,n,o){wr(t,e,n,o)}),Uc=Ji(function(t,e){var n={};if(null==t)return n;var o=!1;e=Ve(e,function(e){return e=ni(e,t),o||(o=e.length>1),e}),_i(t,Qi(t),n),o&&(n=Lo(n,s|c|l,zi));for(var r=e.length;r--;)Kr(n,e[r]);return n}),Gc=Ji(function(t,e){return null==t?{}:Mr(t,e)});function jc(t,e){if(null==t)return{};var n=Ve(Qi(t),function(t){return[t]});return e=ea(e),Pr(t,n,function(t,n){return e(t,n[0])})}var Vc=Vi(xc),Fc=Vi(Bc);function Hc(t){return null==t?[]:pn(t,xc(t))}var Wc=Mi(function(t,e,n){return e=e.toLowerCase(),t+(n?zc(e):e)});function zc(t){return $c(wc(t).toLowerCase())}function qc(t){return(t=wc(t))&&t.replace(Gt,_n).replace(se,"")}var Yc=Mi(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Kc=Mi(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),Jc=Ai("toLowerCase"),Xc=Mi(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Qc=Mi(function(t,e,n){return t+(n?" ":"")+$c(e)}),Zc=Mi(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),$c=Ai("toUpperCase");function tl(t,e,n){return t=wc(t),(e=n?o:e)===o?wn(t)?Ln(t):Ke(t):t.match(e)||[]}var el=Dr(function(t,e){try{return De(t,o,e)}catch(n){return $s(n)?n:new Ft(n)}}),nl=Ji(function(t,e){return Be(e,function(e){e=Ga(e),Do(t,e,Ns(t[e],t))}),t});function ol(t){return function(){return t}}var rl=Ri(),il=Ri(!0);function al(t){return t}function sl(t){return dr("function"==typeof t?t:Lo(t,s))}var cl=Dr(function(t,e){return function(n){return cr(n,t,e)}}),ll=Dr(function(t,e){return function(n){return cr(t,n,e)}});function ul(t,e,n){var o=xc(e),r=Zo(e,o);null!=n||oc(e)&&(r.length||!o.length)||(n=e,e=t,t=this,r=Zo(e,xc(e)));var i=!(oc(n)&&"chain"in n&&!n.chain),a=tc(t);return Be(r,function(n){var o=e[n];t[n]=o,a&&(t.prototype[n]=function(){var e=this.__chain__;if(i||e){var n=t(this.__wrapped__),r=n.__actions__=yi(this.__actions__);return r.push({func:o,args:arguments,thisArg:t}),n.__chain__=e,n}return o.apply(t,Fe([this.value()],arguments))})}),t}function pl(){}var fl=Di(Ve),hl=Di(ke),dl=Di(ze);function yl(t){return ma(t)?en(Ga(t)):Er(t)}var _l=Li(),gl=Li(!0);function vl(){return[]}function ml(){return!1}var bl,wl=Ni(function(t,e){return t+e},0),Sl=Gi("ceil"),Cl=Ni(function(t,e){return t/e},1),Al=Gi("floor"),Ml=Ni(function(t,e){return t*e},1),Pl=Gi("round"),El=Ni(function(t,e){return t-e},0);return fo.after=function(t,e){if("function"!=typeof e)throw new Kt(i);return t=gc(t),function(){if(--t<1)return e.apply(this,arguments)}},fo.ary=Ts,fo.assign=Sc,fo.assignIn=Cc,fo.assignInWith=Ac,fo.assignWith=Mc,fo.at=Pc,fo.before=Is,fo.bind=Ns,fo.bindAll=nl,fo.bindKey=Ds,fo.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ys(t)?t:[t]},fo.chain=ys,fo.chunk=function(t,e,n){e=(n?va(t,e,n):e===o)?1:Wn(gc(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var i=0,a=0,s=Mt(Bn(r/e));i<r;)s[a++]=jr(t,i,i+=e);return s},fo.compact=function(t){for(var e=-1,n=null==t?0:t.length,o=0,r=[];++e<n;){var i=t[e];i&&(r[o++]=i)}return r},fo.concat=function(){var t=arguments.length;if(!t)return[];for(var e=Mt(t-1),n=arguments[0],o=t;o--;)e[o-1]=arguments[o];return Fe(Ys(n)?yi(n):[n],Yo(e,1))},fo.cond=function(t){var e=null==t?0:t.length,n=ea();return t=e?Ve(t,function(t){if("function"!=typeof t[1])throw new Kt(i);return[n(t[0]),t[1]]}):[],Dr(function(n){for(var o=-1;++o<e;){var r=t[o];if(De(r[0],this,n))return De(r[1],this,n)}})},fo.conforms=function(t){return ko(Lo(t,s))},fo.constant=ol,fo.countBy=vs,fo.create=function(t,e){var n=ho(t);return null==e?n:Io(n,e)},fo.curry=function t(e,n,r){var i=Fi(e,y,o,o,o,o,o,n=r?o:n);return i.placeholder=t.placeholder,i},fo.curryRight=function t(e,n,r){var i=Fi(e,_,o,o,o,o,o,n=r?o:n);return i.placeholder=t.placeholder,i},fo.debounce=xs,fo.defaults=Ec,fo.defaultsDeep=Oc,fo.defer=Bs,fo.delay=Ls,fo.difference=Ha,fo.differenceBy=Wa,fo.differenceWith=za,fo.drop=function(t,e,n){var r=null==t?0:t.length;return r?jr(t,(e=n||e===o?1:gc(e))<0?0:e,r):[]},fo.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?jr(t,0,(e=r-(e=n||e===o?1:gc(e)))<0?0:e):[]},fo.dropRightWhile=function(t,e){return t&&t.length?Xr(t,ea(e,3),!0,!0):[]},fo.dropWhile=function(t,e){return t&&t.length?Xr(t,ea(e,3),!0):[]},fo.fill=function(t,e,n,o){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&va(t,e,n)&&(n=0,o=r),zo(t,e,n,o)):[]},fo.filter=function(t,e){return(Ys(t)?Ue:qo)(t,ea(e,3))},fo.flatMap=function(t,e){return Yo(Ps(t,e),1)},fo.flatMapDeep=function(t,e){return Yo(Ps(t,e),A)},fo.flatMapDepth=function(t,e,n){return n=n===o?1:gc(n),Yo(Ps(t,e),n)},fo.flatten=Ka,fo.flattenDeep=function(t){return null!=t&&t.length?Yo(t,A):[]},fo.flattenDepth=function(t,e){return null!=t&&t.length?Yo(t,e=e===o?1:gc(e)):[]},fo.flip=function(t){return Fi(t,w)},fo.flow=rl,fo.flowRight=il,fo.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,o={};++e<n;){var r=t[e];o[r[0]]=r[1]}return o},fo.functions=function(t){return null==t?[]:Zo(t,xc(t))},fo.functionsIn=function(t){return null==t?[]:Zo(t,Bc(t))},fo.groupBy=Cs,fo.initial=function(t){return null!=t&&t.length?jr(t,0,-1):[]},fo.intersection=Xa,fo.intersectionBy=Qa,fo.intersectionWith=Za,fo.invert=Ic,fo.invertBy=Nc,fo.invokeMap=As,fo.iteratee=sl,fo.keyBy=Ms,fo.keys=xc,fo.keysIn=Bc,fo.map=Ps,fo.mapKeys=function(t,e){var n={};return e=ea(e,3),Xo(t,function(t,o,r){Do(n,e(t,o,r),t)}),n},fo.mapValues=function(t,e){var n={};return e=ea(e,3),Xo(t,function(t,o,r){Do(n,o,e(t,o,r))}),n},fo.matches=function(t){return mr(Lo(t,s))},fo.matchesProperty=function(t,e){return br(t,Lo(e,s))},fo.memoize=ks,fo.merge=Lc,fo.mergeWith=kc,fo.method=cl,fo.methodOf=ll,fo.mixin=ul,fo.negate=Us,fo.nthArg=function(t){return t=gc(t),Dr(function(e){return Cr(e,t)})},fo.omit=Uc,fo.omitBy=function(t,e){return jc(t,Us(ea(e)))},fo.once=function(t){return Is(2,t)},fo.orderBy=function(t,e,n,r){return null==t?[]:(Ys(e)||(e=null==e?[]:[e]),Ys(n=r?o:n)||(n=null==n?[]:[n]),Ar(t,e,n))},fo.over=fl,fo.overArgs=Gs,fo.overEvery=hl,fo.overSome=dl,fo.partial=js,fo.partialRight=Vs,fo.partition=Es,fo.pick=Gc,fo.pickBy=jc,fo.property=yl,fo.propertyOf=function(t){return function(e){return null==t?o:$o(t,e)}},fo.pull=ts,fo.pullAll=es,fo.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Or(t,e,ea(n,2)):t},fo.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Or(t,e,o,n):t},fo.pullAt=ns,fo.range=_l,fo.rangeRight=gl,fo.rearg=Fs,fo.reject=function(t,e){return(Ys(t)?Ue:qo)(t,Us(ea(e,3)))},fo.remove=function(t,e){var n=[];if(!t||!t.length)return n;var o=-1,r=[],i=t.length;for(e=ea(e,3);++o<i;){var a=t[o];e(a,o,t)&&(n.push(a),r.push(o))}return Rr(t,r),n},fo.rest=function(t,e){if("function"!=typeof t)throw new Kt(i);return Dr(t,e=e===o?e:gc(e))},fo.reverse=os,fo.sampleSize=function(t,e,n){return e=(n?va(t,e,n):e===o)?1:gc(e),(Ys(t)?Mo:Br)(t,e)},fo.set=function(t,e,n){return null==t?t:Lr(t,e,n)},fo.setWith=function(t,e,n,r){return r="function"==typeof r?r:o,null==t?t:Lr(t,e,n,r)},fo.shuffle=function(t){return(Ys(t)?Po:Gr)(t)},fo.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&va(t,e,n)?(e=0,n=r):(e=null==e?0:gc(e),n=n===o?r:gc(n)),jr(t,e,n)):[]},fo.sortBy=Os,fo.sortedUniq=function(t){return t&&t.length?Wr(t):[]},fo.sortedUniqBy=function(t,e){return t&&t.length?Wr(t,ea(e,2)):[]},fo.split=function(t,e,n){return n&&"number"!=typeof n&&va(t,e,n)&&(e=n=o),(n=n===o?O:n>>>0)?(t=wc(t))&&("string"==typeof e||null!=e&&!cc(e))&&!(e=qr(e))&&bn(t)?ri(In(t),0,n):t.split(e,n):[]},fo.spread=function(t,e){if("function"!=typeof t)throw new Kt(i);return e=null==e?0:Wn(gc(e),0),Dr(function(n){var o=n[e],r=ri(n,0,e);return o&&Fe(r,o),De(t,this,r)})},fo.tail=function(t){var e=null==t?0:t.length;return e?jr(t,1,e):[]},fo.take=function(t,e,n){return t&&t.length?jr(t,0,(e=n||e===o?1:gc(e))<0?0:e):[]},fo.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?jr(t,(e=r-(e=n||e===o?1:gc(e)))<0?0:e,r):[]},fo.takeRightWhile=function(t,e){return t&&t.length?Xr(t,ea(e,3),!1,!0):[]},fo.takeWhile=function(t,e){return t&&t.length?Xr(t,ea(e,3)):[]},fo.tap=function(t,e){return e(t),t},fo.throttle=function(t,e,n){var o=!0,r=!0;if("function"!=typeof t)throw new Kt(i);return oc(n)&&(o="leading"in n?!!n.leading:o,r="trailing"in n?!!n.trailing:r),xs(t,e,{leading:o,maxWait:e,trailing:r})},fo.thru=_s,fo.toArray=yc,fo.toPairs=Vc,fo.toPairsIn=Fc,fo.toPath=function(t){return Ys(t)?Ve(t,Ga):pc(t)?[t]:yi(Ua(wc(t)))},fo.toPlainObject=bc,fo.transform=function(t,e,n){var o=Ys(t),r=o||Qs(t)||fc(t);if(e=ea(e,4),null==n){var i=t&&t.constructor;n=r?o?new i:[]:oc(t)&&tc(i)?ho(me(t)):{}}return(r?Be:Xo)(t,function(t,o,r){return e(n,t,o,r)}),n},fo.unary=function(t){return Ts(t,1)},fo.union=rs,fo.unionBy=is,fo.unionWith=as,fo.uniq=function(t){return t&&t.length?Yr(t):[]},fo.uniqBy=function(t,e){return t&&t.length?Yr(t,ea(e,2)):[]},fo.uniqWith=function(t,e){return e="function"==typeof e?e:o,t&&t.length?Yr(t,o,e):[]},fo.unset=function(t,e){return null==t||Kr(t,e)},fo.unzip=ss,fo.unzipWith=cs,fo.update=function(t,e,n){return null==t?t:Jr(t,e,ei(n))},fo.updateWith=function(t,e,n,r){return r="function"==typeof r?r:o,null==t?t:Jr(t,e,ei(n),r)},fo.values=Hc,fo.valuesIn=function(t){return null==t?[]:pn(t,Bc(t))},fo.without=ls,fo.words=tl,fo.wrap=function(t,e){return js(ei(e),t)},fo.xor=us,fo.xorBy=ps,fo.xorWith=fs,fo.zip=hs,fo.zipObject=function(t,e){return $r(t||[],e||[],Oo)},fo.zipObjectDeep=function(t,e){return $r(t||[],e||[],Lr)},fo.zipWith=ds,fo.entries=Vc,fo.entriesIn=Fc,fo.extend=Cc,fo.extendWith=Ac,ul(fo,fo),fo.add=wl,fo.attempt=el,fo.camelCase=Wc,fo.capitalize=zc,fo.ceil=Sl,fo.clamp=function(t,e,n){return n===o&&(n=e,e=o),n!==o&&(n=(n=mc(n))==n?n:0),e!==o&&(e=(e=mc(e))==e?e:0),Bo(mc(t),e,n)},fo.clone=function(t){return Lo(t,l)},fo.cloneDeep=function(t){return Lo(t,s|l)},fo.cloneDeepWith=function(t,e){return Lo(t,s|l,e="function"==typeof e?e:o)},fo.cloneWith=function(t,e){return Lo(t,l,e="function"==typeof e?e:o)},fo.conformsTo=function(t,e){return null==e||Uo(t,e,xc(e))},fo.deburr=qc,fo.defaultTo=function(t,e){return null==t||t!=t?e:t},fo.divide=Cl,fo.endsWith=function(t,e,n){t=wc(t),e=qr(e);var r=t.length,i=n=n===o?r:Bo(gc(n),0,r);return(n-=e.length)>=0&&t.slice(n,i)==e},fo.eq=Hs,fo.escape=function(t){return(t=wc(t))&&yt.test(t)?t.replace(ht,gn):t},fo.escapeRegExp=function(t){return(t=wc(t))&&Ct.test(t)?t.replace(St,"\\$&"):t},fo.every=function(t,e,n){var r=Ys(t)?ke:Ho;return n&&va(t,e,n)&&(e=o),r(t,ea(e,3))},fo.find=ms,fo.findIndex=qa,fo.findKey=function(t,e){return Je(t,ea(e,3),Xo)},fo.findLast=bs,fo.findLastIndex=Ya,fo.findLastKey=function(t,e){return Je(t,ea(e,3),Qo)},fo.floor=Al,fo.forEach=ws,fo.forEachRight=Ss,fo.forIn=function(t,e){return null==t?t:Ko(t,ea(e,3),Bc)},fo.forInRight=function(t,e){return null==t?t:Jo(t,ea(e,3),Bc)},fo.forOwn=function(t,e){return t&&Xo(t,ea(e,3))},fo.forOwnRight=function(t,e){return t&&Qo(t,ea(e,3))},fo.get=Rc,fo.gt=Ws,fo.gte=zs,fo.has=function(t,e){return null!=t&&pa(t,e,or)},fo.hasIn=Tc,fo.head=Ja,fo.identity=al,fo.includes=function(t,e,n,o){t=Js(t)?t:Hc(t),n=n&&!o?gc(n):0;var r=t.length;return n<0&&(n=Wn(r+n,0)),uc(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&Qe(t,e,n)>-1},fo.indexOf=function(t,e,n){var o=null==t?0:t.length;if(!o)return-1;var r=null==n?0:gc(n);return r<0&&(r=Wn(o+r,0)),Qe(t,e,r)},fo.inRange=function(t,e,n){return e=_c(e),n===o?(n=e,e=0):n=_c(n),ir(t=mc(t),e,n)},fo.invoke=Dc,fo.isArguments=qs,fo.isArray=Ys,fo.isArrayBuffer=Ks,fo.isArrayLike=Js,fo.isArrayLikeObject=Xs,fo.isBoolean=function(t){return!0===t||!1===t||rc(t)&&er(t)==B},fo.isBuffer=Qs,fo.isDate=Zs,fo.isElement=function(t){return rc(t)&&1===t.nodeType&&!sc(t)},fo.isEmpty=function(t){if(null==t)return!0;if(Js(t)&&(Ys(t)||"string"==typeof t||"function"==typeof t.splice||Qs(t)||fc(t)||qs(t)))return!t.length;var e=ca(t);if(e==V||e==Y)return!t.size;if(Sa(t))return!yr(t).length;for(var n in t)if(te.call(t,n))return!1;return!0},fo.isEqual=function(t,e){return ur(t,e)},fo.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:o)?n(t,e):o;return r===o?ur(t,e,o,n):!!r},fo.isError=$s,fo.isFinite=function(t){return"number"==typeof t&&Vn(t)},fo.isFunction=tc,fo.isInteger=ec,fo.isLength=nc,fo.isMap=ic,fo.isMatch=function(t,e){return t===e||fr(t,e,oa(e))},fo.isMatchWith=function(t,e,n){return n="function"==typeof n?n:o,fr(t,e,oa(e),n)},fo.isNaN=function(t){return ac(t)&&t!=+t},fo.isNative=function(t){if(wa(t))throw new Ft("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return hr(t)},fo.isNil=function(t){return null==t},fo.isNull=function(t){return null===t},fo.isNumber=ac,fo.isObject=oc,fo.isObjectLike=rc,fo.isPlainObject=sc,fo.isRegExp=cc,fo.isSafeInteger=function(t){return ec(t)&&t>=-M&&t<=M},fo.isSet=lc,fo.isString=uc,fo.isSymbol=pc,fo.isTypedArray=fc,fo.isUndefined=function(t){return t===o},fo.isWeakMap=function(t){return rc(t)&&ca(t)==Q},fo.isWeakSet=function(t){return rc(t)&&"[object WeakSet]"==er(t)},fo.join=function(t,e){return null==t?"":Fn.call(t,e)},fo.kebabCase=Yc,fo.last=$a,fo.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return n!==o&&(i=(i=gc(n))<0?Wn(r+i,0):zn(i,r-1)),e==e?Rn(t,e,i):Xe(t,$e,i,!0)},fo.lowerCase=Kc,fo.lowerFirst=Jc,fo.lt=hc,fo.lte=dc,fo.max=function(t){return t&&t.length?Wo(t,al,nr):o},fo.maxBy=function(t,e){return t&&t.length?Wo(t,ea(e,2),nr):o},fo.mean=function(t){return tn(t,al)},fo.meanBy=function(t,e){return tn(t,ea(e,2))},fo.min=function(t){return t&&t.length?Wo(t,al,gr):o},fo.minBy=function(t,e){return t&&t.length?Wo(t,ea(e,2),gr):o},fo.stubArray=vl,fo.stubFalse=ml,fo.stubObject=function(){return{}},fo.stubString=function(){return""},fo.stubTrue=function(){return!0},fo.multiply=Ml,fo.nth=function(t,e){return t&&t.length?Cr(t,gc(e)):o},fo.noConflict=function(){return we._===this&&(we._=ie),this},fo.noop=pl,fo.now=Rs,fo.pad=function(t,e,n){t=wc(t);var o=(e=gc(e))?Tn(t):0;if(!e||o>=e)return t;var r=(e-o)/2;return xi(Un(r),n)+t+xi(Bn(r),n)},fo.padEnd=function(t,e,n){t=wc(t);var o=(e=gc(e))?Tn(t):0;return e&&o<e?t+xi(e-o,n):t},fo.padStart=function(t,e,n){t=wc(t);var o=(e=gc(e))?Tn(t):0;return e&&o<e?xi(e-o,n)+t:t},fo.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),Yn(wc(t).replace(At,""),e||0)},fo.random=function(t,e,n){if(n&&"boolean"!=typeof n&&va(t,e,n)&&(e=n=o),n===o&&("boolean"==typeof e?(n=e,e=o):"boolean"==typeof t&&(n=t,t=o)),t===o&&e===o?(t=0,e=1):(t=_c(t),e===o?(e=t,t=0):e=_c(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=Kn();return zn(t+i*(e-t+ge("1e-"+((i+"").length-1))),e)}return Tr(t,e)},fo.reduce=function(t,e,n){var o=Ys(t)?He:on,r=arguments.length<3;return o(t,ea(e,4),n,r,Vo)},fo.reduceRight=function(t,e,n){var o=Ys(t)?We:on,r=arguments.length<3;return o(t,ea(e,4),n,r,Fo)},fo.repeat=function(t,e,n){return e=(n?va(t,e,n):e===o)?1:gc(e),Nr(wc(t),e)},fo.replace=function(){var t=arguments,e=wc(t[0]);return t.length<3?e:e.replace(t[1],t[2])},fo.result=function(t,e,n){var r=-1,i=(e=ni(e,t)).length;for(i||(i=1,t=o);++r<i;){var a=null==t?o:t[Ga(e[r])];a===o&&(r=i,a=n),t=tc(a)?a.call(t):a}return t},fo.round=Pl,fo.runInContext=t,fo.sample=function(t){return(Ys(t)?Ao:xr)(t)},fo.size=function(t){if(null==t)return 0;if(Js(t))return uc(t)?Tn(t):t.length;var e=ca(t);return e==V||e==Y?t.size:yr(t).length},fo.snakeCase=Xc,fo.some=function(t,e,n){var r=Ys(t)?ze:Vr;return n&&va(t,e,n)&&(e=o),r(t,ea(e,3))},fo.sortedIndex=function(t,e){return Fr(t,e)},fo.sortedIndexBy=function(t,e,n){return Hr(t,e,ea(n,2))},fo.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var o=Fr(t,e);if(o<n&&Hs(t[o],e))return o}return-1},fo.sortedLastIndex=function(t,e){return Fr(t,e,!0)},fo.sortedLastIndexBy=function(t,e,n){return Hr(t,e,ea(n,2),!0)},fo.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=Fr(t,e,!0)-1;if(Hs(t[n],e))return n}return-1},fo.startCase=Qc,fo.startsWith=function(t,e,n){return t=wc(t),n=null==n?0:Bo(gc(n),0,t.length),e=qr(e),t.slice(n,n+e.length)==e},fo.subtract=El,fo.sum=function(t){return t&&t.length?an(t,al):0},fo.sumBy=function(t,e){return t&&t.length?an(t,ea(e,2)):0},fo.template=function(t,e,n){var r=fo.templateSettings;n&&va(t,e,n)&&(e=o),t=wc(t),e=Ac({},e,r,Hi);var i,a,s=Ac({},e.imports,r.imports,Hi),c=xc(s),l=pn(s,c),u=0,p=e.interpolate||jt,f="__p += '",h=qt((e.escape||jt).source+"|"+p.source+"|"+(p===vt?Nt:jt).source+"|"+(e.evaluate||jt).source+"|$","g"),d="//# sourceURL="+(te.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++he+"]")+"\n";t.replace(h,function(e,n,o,r,s,c){return o||(o=r),f+=t.slice(u,c).replace(Vt,vn),n&&(i=!0,f+="' +\n__e("+n+") +\n'"),s&&(a=!0,f+="';\n"+s+";\n__p += '"),o&&(f+="' +\n((__t = ("+o+")) == null ? '' : __t) +\n'"),u=c+e.length,e}),f+="';\n";var y=te.call(e,"variable")&&e.variable;if(y){if(Tt.test(y))throw new Ft("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(a?f.replace(lt,""):f).replace(ut,"$1").replace(pt,"$1;"),f="function("+(y||"obj")+") {\n"+(y?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var _=el(function(){return Ht(c,d+"return "+f).apply(o,l)});if(_.source=f,$s(_))throw _;return _},fo.times=function(t,e){if((t=gc(t))<1||t>M)return[];var n=O,o=zn(t,O);e=ea(e),t-=O;for(var r=sn(o,e);++n<t;)e(n);return r},fo.toFinite=_c,fo.toInteger=gc,fo.toLength=vc,fo.toLower=function(t){return wc(t).toLowerCase()},fo.toNumber=mc,fo.toSafeInteger=function(t){return t?Bo(gc(t),-M,M):0===t?t:0},fo.toString=wc,fo.toUpper=function(t){return wc(t).toUpperCase()},fo.trim=function(t,e,n){if((t=wc(t))&&(n||e===o))return ln(t);if(!t||!(e=qr(e)))return t;var r=In(t),i=In(e);return ri(r,hn(r,i),dn(r,i)+1).join("")},fo.trimEnd=function(t,e,n){if((t=wc(t))&&(n||e===o))return t.slice(0,Nn(t)+1);if(!t||!(e=qr(e)))return t;var r=In(t);return ri(r,0,dn(r,In(e))+1).join("")},fo.trimStart=function(t,e,n){if((t=wc(t))&&(n||e===o))return t.replace(At,"");if(!t||!(e=qr(e)))return t;var r=In(t);return ri(r,hn(r,In(e))).join("")},fo.truncate=function(t,e){var n=30,r="...";if(oc(e)){var i="separator"in e?e.separator:i;n="length"in e?gc(e.length):n,r="omission"in e?qr(e.omission):r}var a=(t=wc(t)).length;if(bn(t)){var s=In(t);a=s.length}if(n>=a)return t;var c=n-Tn(r);if(c<1)return r;var l=s?ri(s,0,c).join(""):t.slice(0,c);if(i===o)return l+r;if(s&&(c+=l.length-c),cc(i)){if(t.slice(c).search(i)){var u,p=l;for(i.global||(i=qt(i.source,wc(Dt.exec(i))+"g")),i.lastIndex=0;u=i.exec(p);)var f=u.index;l=l.slice(0,f===o?c:f)}}else if(t.indexOf(qr(i),c)!=c){var h=l.lastIndexOf(i);h>-1&&(l=l.slice(0,h))}return l+r},fo.unescape=function(t){return(t=wc(t))&&dt.test(t)?t.replace(ft,Dn):t},fo.uniqueId=function(t){var e=++ee;return wc(t)+e},fo.upperCase=Zc,fo.upperFirst=$c,fo.each=ws,fo.eachRight=Ss,fo.first=Ja,ul(fo,(bl={},Xo(fo,function(t,e){te.call(fo.prototype,e)||(bl[e]=t)}),bl),{chain:!1}),fo.VERSION="4.17.21",Be(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){fo[t].placeholder=fo}),Be(["drop","take"],function(t,e){go.prototype[t]=function(n){n=n===o?1:Wn(gc(n),0);var r=this.__filtered__&&!e?new go(this):this.clone();return r.__filtered__?r.__takeCount__=zn(n,r.__takeCount__):r.__views__.push({size:zn(n,O),type:t+(r.__dir__<0?"Right":"")}),r},go.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),Be(["filter","map","takeWhile"],function(t,e){var n=e+1,o=1==n||3==n;go.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:ea(t,3),type:n}),e.__filtered__=e.__filtered__||o,e}}),Be(["head","last"],function(t,e){var n="take"+(e?"Right":"");go.prototype[t]=function(){return this[n](1).value()[0]}}),Be(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");go.prototype[t]=function(){return this.__filtered__?new go(this):this[n](1)}}),go.prototype.compact=function(){return this.filter(al)},go.prototype.find=function(t){return this.filter(t).head()},go.prototype.findLast=function(t){return this.reverse().find(t)},go.prototype.invokeMap=Dr(function(t,e){return"function"==typeof t?new go(this):this.map(function(n){return cr(n,t,e)})}),go.prototype.reject=function(t){return this.filter(Us(ea(t)))},go.prototype.slice=function(t,e){t=gc(t);var n=this;return n.__filtered__&&(t>0||e<0)?new go(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==o&&(n=(e=gc(e))<0?n.dropRight(-e):n.take(e-t)),n)},go.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},go.prototype.toArray=function(){return this.take(O)},Xo(go.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=fo[r?"take"+("last"==e?"Right":""):e],a=r||/^find/.test(e);i&&(fo.prototype[e]=function(){var e=this.__wrapped__,s=r?[1]:arguments,c=e instanceof go,l=s[0],u=c||Ys(e),p=function(t){var e=i.apply(fo,Fe([t],s));return r&&f?e[0]:e};u&&n&&"function"==typeof l&&1!=l.length&&(c=u=!1);var f=this.__chain__,h=!!this.__actions__.length,d=a&&!f,y=c&&!h;if(!a&&u){e=y?e:new go(this);var _=t.apply(e,s);return _.__actions__.push({func:_s,args:[p],thisArg:o}),new _o(_,f)}return d&&y?t.apply(this,s):(_=this.thru(p),d?r?_.value()[0]:_.value():_)})}),Be(["pop","push","shift","sort","splice","unshift"],function(t){var e=Jt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",o=/^(?:pop|shift)$/.test(t);fo.prototype[t]=function(){var t=arguments;if(o&&!this.__chain__){var r=this.value();return e.apply(Ys(r)?r:[],t)}return this[n](function(n){return e.apply(Ys(n)?n:[],t)})}}),Xo(go.prototype,function(t,e){var n=fo[e];if(n){var o=n.name+"";te.call(oo,o)||(oo[o]=[]),oo[o].push({name:e,func:n})}}),oo[Ti(o,h).name]=[{name:"wrapper",func:o}],go.prototype.clone=function(){var t=new go(this.__wrapped__);return t.__actions__=yi(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=yi(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=yi(this.__views__),t},go.prototype.reverse=function(){if(this.__filtered__){var t=new go(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},go.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ys(t),o=e<0,r=n?t.length:0,i=la(0,r,this.__views__),a=i.start,s=i.end,c=s-a,l=o?s:a-1,u=this.__iteratees__,p=u.length,f=0,h=zn(c,this.__takeCount__);if(!n||!o&&r==c&&h==c)return Qr(t,this.__actions__);var d=[];t:for(;c--&&f<h;){for(var y=-1,_=t[l+=e];++y<p;){var g=u[y],v=g.iteratee,m=g.type,b=v(_);if(2==m)_=b;else if(!b){if(1==m)continue t;break t}}d[f++]=_}return d},fo.prototype.at=gs,fo.prototype.chain=function(){return ys(this)},fo.prototype.commit=function(){return new _o(this.value(),this.__chain__)},fo.prototype.next=function(){this.__values__===o&&(this.__values__=yc(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?o:this.__values__[this.__index__++]}},fo.prototype.plant=function(t){for(var e,n=this;n instanceof yo;){var r=Fa(n);r.__index__=0,r.__values__=o,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e},fo.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof go){var e=t;return this.__actions__.length&&(e=new go(this)),(e=e.reverse()).__actions__.push({func:_s,args:[os],thisArg:o}),new _o(e,this.__chain__)}return this.thru(os)},fo.prototype.toJSON=fo.prototype.valueOf=fo.prototype.value=function(){return Qr(this.__wrapped__,this.__actions__)},fo.prototype.first=fo.prototype.head,Pe&&(fo.prototype[Pe]=function(){return this}),fo}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(we._=kn,define(function(){return kn})):Ce?((Ce.exports=kn)._=kn,Se._=kn):we._=kn}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],DataSaver:[function(t,e,n){"use strict";cc._RF.push(e,"f220cId5rdEFKR8X1qhmDT5","DataSaver");var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.DataSaver=void 0;var r=o(t("../../../Module/Database/Db")),i=function(){function t(){this._dirty=!1,this._saveInterval=5,this._saveHandle=0}return t.prototype.init=function(t,e,n){void 0===n&&(n=5),this._key=t,this._data=e,this._saveInterval=n},t.prototype.setDirty=function(){var t=this;this._dirty=!0,this._saveHandle||(this._saveHandle=setTimeout(function(){t._saveHandle=0,t.save()},1e3*this._saveInterval))},t.prototype.save=function(){this._dirty&&(this._dirty=!1,this._saveHandle&&(clearTimeout(this._saveHandle),this._saveHandle=0),this._key&&this._data?r.default.instance.setData(this._key,this._data):cc.error("save data error, key: "+this._key))},t}();n.DataSaver=i,cc._RF.pop()},{"../../../Module/Database/Db":"Db"}],DbMap:[function(t,e,n){"use strict";cc._RF.push(e,"bcb2agHxHBDnLQAXiVH1tDO","DbMap"),Object.defineProperty(n,"__esModule",{value:!0}),n.CLEAR_USER_DATA_EXCEPT_KEYS=n.NO_ENCRYPT_KEYS=n.ENABLE_ENCRYPT=n.LOAD_KEYS=void 0,n.LOAD_KEYS=["local","bag","battle","userInfo","home","weapon"],n.ENABLE_ENCRYPT=!1,n.NO_ENCRYPT_KEYS=["local"],n.CLEAR_USER_DATA_EXCEPT_KEYS=["local"],cc._RF.pop()},{}],Db:[function(t,e,n){"use strict";cc._RF.push(e,"e97ecKewSlMh5TYYopGNbCJ","Db");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Utils/Utils")),c=t("./LocalStorage"),l=t("./DbMap"),u=function(){function t(){this._saveRequests=[],this._maxQueryPerFrame=5,this._maxTimePerFrame=5,this._nextTaskId=0,this._isNewUser=!1,this._dataMap=cc.js.createMap(!0),this._pendingSaveTasks=cc.js.createMap(!0)}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.init=function(){var t=this.getData("local");t||(this._isNewUser=!0,t={version:1,magic:0},this.setData("local",t)),this._saveHandle||(this._saveHandle=setInterval(this.update.bind(this),16)),this.loadAll()},t.prototype.isNewUser=function(){return this._isNewUser},t.prototype.update=function(){if(0!==this._saveRequests.length){var t=Date.now(),e=0;do{var n=this._saveRequests.shift();this._handlerSaveRequest(n),e++}while(this._saveRequests.length>0&&e<this._maxQueryPerFrame&&Date.now()-t<this._maxTimePerFrame)}},t.prototype.isUpdating=function(){return!!this._saveHandle},t.prototype._handlerSaveRequest=function(t){var e=this.getData(t.key);this.saveData(t.key,e),t.callbacks&&t.callbacks.forEach(function(t){return t&&t()})},t.prototype.loadAll=function(){var t=this;l.LOAD_KEYS.forEach(function(e){return t.loadData(e)})},t.prototype.saveAll=function(){return o(this,void 0,void 0,function(){var t;return r(this,function(){return this._saveRequests.forEach(this._handlerSaveRequest.bind(this)),this._saveRequests.length=0,t=Object.values(this._pendingSaveTasks),[2,Promise.all(t)]})})},t.prototype.clearUserData=function(){var t,e;try{for(var n=i(l.LOAD_KEYS),o=n.next();!o.done;o=n.next()){var r=o.value;l.CLEAR_USER_DATA_EXCEPT_KEYS.includes(r)||(this._dataMap[r]=null,c.LocalStorage.removeItem(r))}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.clearAllData=function(){var t,e;try{for(var n=i(l.LOAD_KEYS),o=n.next();!o.done;o=n.next()){var r=o.value;this._dataMap[r]=null,c.LocalStorage.removeItem(r)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.destroy=function(){this._saveRequests.length=0,this._dataMap=null,this._pendingSaveTasks=null,this._saveHandle&&(clearInterval(this._saveHandle),this._saveHandle=null)},t.prototype.getAllData=function(){return this._dataMap},t.prototype.getData=function(t){return this._dataMap[t]},t.prototype.setData=function(t,e,n){"magic"in e&&(e.magic=(e.magic||0)+1),this._dataMap[t]=e;var o=this._saveRequests.findIndex(function(e){return e.key===t});if(o>=0){if(n){var r=this._saveRequests[o];r.callbacks=r.callbacks||[],r.callbacks.push(n)}}else n?this._saveRequests.push({key:t,callbacks:[n]}):this._saveRequests.push({key:t})},t.prototype.loadData=function(t){var e=c.LocalStorage.getItem(t);if(e){var n=this.decodeObj(t,e);return this._dataMap[t]=n,n}return null},t.prototype.loadDataAsync=function(t,e){var n=this;if(!e)return c.LocalStorage.getItemAsync(t).then(function(e){if(e){var o=n.decodeObj(t,e);return n._dataMap[t]=o,o}return null});this.loadDataAsync(t).then(e)},t.prototype.saveData=function(t,e){var n=this.encodeObj(t,e);c.LocalStorage.setItem(t,n)},t.prototype.saveDataAsync=function(t,e){var n=this;if(!e){var o=this.getData(t),r=this.encodeObj(t,o),i=this._nextTaskId++,a=!1,s=c.LocalStorage.setItemAsync(t,r).then(function(t){return delete n._pendingSaveTasks[i],a=!0,t});return a||(this._pendingSaveTasks[i]=s),s}this.saveDataAsync(t).then(e)},t.prototype.encodeObj=function(t,e){var n=JSON.stringify(e);return l.ENABLE_ENCRYPT&&!l.NO_ENCRYPT_KEYS.includes(t)&&(n=s.default.encode(n)),n},t.prototype.decodeObj=function(t,e){return l.ENABLE_ENCRYPT&&!l.NO_ENCRYPT_KEYS.includes(t)&&(e=s.default.decode(e)),JSON.parse(e)},t._instance=null,t}();n.default=u,cc._RF.pop()},{"../../Utils/Utils":"Utils","./DbMap":"DbMap","./LocalStorage":"LocalStorage"}],DebugPad:[function(t,e,n){"use strict";cc._RF.push(e,"a77ae9vbQVMQrNhw6zVTrFc","DebugPad");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.DebugPad=void 0;var s=t("../Enum/ItemType"),c=a(t("../Gameplay/GameDefine")),l=t("../Gameplay/System/BagSystem"),u=t("../Gameplay/System/BattleSystem"),p=t("../Module/ConfigManager"),f=a(t("../Module/Database/Db")),h=a(t("../Module/Loader")),d=a(t("../Module/ViewModule")),y=a(t("../Utils/Path")),_=t("./EasyMenu/eMenu"),g=function(){function t(){}return t.init=function(){return o(this,void 0,void 0,function(){var t,e,n,o,a,f,g,v,m,b,w,S;return r(this,function(r){switch(r.label){case 0:return[4,h.default.loadPrefabAsync(y.default.DEBUG_BUNDLE_PREFIX+"EasyMenu/EasyMenu",null)];case 1:t=r.sent(),(e=this.node=cc.instantiate(t)).parent=cc.Camera.main.node,e.scale=1.3,n=e.getComponent(_.eMenu),o=n.addGroup("HALL").setVisible(!1).addItem("Clear Data",this.onClearData.bind(this)).addItem("Coin & Enegy",function(){l.BagSystem.instance.addItemCount(s.ItemType.Coin,1e3),l.BagSystem.instance.addItemCount(s.ItemType.Energy,1e3)}).addItem("Shop",function(){d.default.instance.pushView("LineupView")}),a=n.addGroup("LEVEL").setVisible(!1),f=function(t){var e="Level "+t.level;a.addItem(e,function(){u.BattleSystem.instance.startBattle(t.level)})};try{for(g=i(p.ConfigManager.instance.getLevelConfigs().values()),v=g.next();!v.done;v=g.next())m=v.value,f(m)}catch(C){w={error:C}}finally{try{v&&!v.done&&(S=g.return)&&S.call(g)}finally{if(w)throw w.error}}return(b=n.addGroup("BATTLE").addToggle("Draw Assign",function(t){return c.default.DebugAssign=t},c.default.DebugAssign).addToggle("Draw Ability",function(t){return c.default.DebugAblity=t},c.default.DebugAblity)).node.active=!1,u.BattleSystem.instance.on(u.BattleSystem.Events.BattleStart,function(){o.node.active=!1,b.node.active=!0}),u.BattleSystem.instance.on(u.BattleSystem.Events.BattleEnd,function(){o.node.active=!0,b.node.active=!1}),[2]}})})},t.onClearData=function(){f.default.instance.clearAllData(),cc.game.end()},t.destroy=function(){cc.isValid(this.node)&&(this.node.destroy(),this.node=null)},t}();n.DebugPad=g,cc._RF.pop()},{"../Enum/ItemType":"ItemType","../Gameplay/GameDefine":"GameDefine","../Gameplay/System/BagSystem":"BagSystem","../Gameplay/System/BattleSystem":"BattleSystem","../Module/ConfigManager":"ConfigManager","../Module/Database/Db":"Db","../Module/Loader":"Loader","../Module/ViewModule":"ViewModule","../Utils/Path":"Path","./EasyMenu/eMenu":"eMenu"}],Decorators:[function(t,e,n){"use strict";cc._RF.push(e,"b5274Ldd7ZKf42iWRaPF8ns","Decorators"),Object.defineProperty(n,"__esModule",{value:!0}),n.propLabel=void 0;var o=cc._decorator,r=(o.ccclass,o.property);n.propLabel=function(t){return r({editorOnly:!0,serializable:!1,readonly:!0,displayName:t,visible:!0})},cc._RF.pop()},{}],Drag:[function(t,e,n){"use strict";cc._RF.push(e,"07192z5VgVLsorcmCy6wMQ9","Drag");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Utils/Utils")),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._moveThreshold=15,e._cancelMovingFlag=!1,e._moveOffset=null,e.startMove=!1,e.originPos=null,e._template=null,e._container=null,e._target=null,e._moveFlag=!0,e}var n;return r(e,t),n=e,e.getOrAdd=function(t){var e=t.getComponent(n);return e||(e=t.addComponent(n)),e},e.prototype.setTemplate=function(t,e){void 0===e&&(e=null),this._template=t,this._container=e},e.prototype.setOnDragStart=function(t){this._onDragStart=t},e.prototype.setOnDragEnd=function(t){this._onDragEnd=t},e.prototype.setOnTouchStart=function(t){this._onTouchStart=t},e.prototype.setOnClickEnd=function(t){this._onClickEnd=t},e.prototype.getTarget=function(){return this._target},e.prototype.start=function(){this.addTouchListener()},e.prototype.addTouchListener=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onMoveCancel=function(){var t=this;if(this.originPos){var e=cc.v2(this.node.x,this.node.y).sub(this.originPos).mag()/4800;this._cancelMovingFlag=!0,cc.tween(this.node).to(e,{position:cc.v3(this.originPos.x,this.originPos.y,0)}).call(function(){t._cancelMovingFlag=!1}).start()}},e.prototype.onMoveStart=function(t){if(this._template){var e=cc.instantiate(this._template);e.position=this.node.position,e.parent=this.node.parent,this._target=e,e.getComponentsInChildren(cc.Button).forEach(function(t){return t.enabled=!1})}else this._target=this.node;this._container&&s.default.switchParent(this._target,this._container),this.originPos=cc.v2(this._target.x,this._target.y);var n=this._target.parent.convertToNodeSpaceAR(t);this._moveOffset=this.originPos.sub(n),this._onDragStart&&this._onDragStart()},e.prototype.onSetMoveFlag=function(t){this._moveFlag=t},e.prototype.onTouchStart=function(){this._moveFlag&&(this.startMove=!1,this._onTouchStart&&this._onTouchStart())},e.prototype.onTouchMove=function(t){if(this._moveFlag){var e=t.getLocation();if(this.startMove||t.getStartLocation().sub(e).mag()>=this._moveThreshold&&(this.startMove=!0,this.onMoveStart(e)),this.startMove){var n=this._target.parent.convertToNodeSpaceAR(e);this._moveOffset&&(n=n.add(this._moveOffset)),this._target.x=n.x,this._target.y=n.y}}},e.prototype.onTouchEnd=function(t){if(this._moveFlag)if(this.startMove){var e=t.getLocation(),n=this._target.parent.convertToNodeSpaceAR(e);this._moveOffset&&(n=n.add(this._moveOffset)),this._target.x=n.x,this._target.y=n.y,this._onDragEnd&&this._onDragEnd(),this._template&&this._target&&(this._target.destroy(),this._target=null)}else this._onClickEnd&&this._onClickEnd()},e.prototype.onTouchCancel=function(){},e.prototype.onMoveClear=function(){this._target.stopActionByTag(78987),this.startMove=!1},n=i([l],e)}(cc.Component));n.default=u,cc._RF.pop()},{"../../Utils/Utils":"Utils"}],EnemyConfig:[function(t,e,n){"use strict";cc._RF.push(e,"3b4baekK7BCxZhfktdqys2i","EnemyConfig"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],EnemyItem:[function(t,e,n){"use strict";cc._RF.push(e,"265cftZJmtGF4Tj+bksCC9q","EnemyItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Component/Utils/TableView/TableViewItem")),c=t("../../Gameplay/System/WeaponSystem"),l=t("../../Module/ConfigManager"),u=a(t("../../Module/ViewModule")),p=a(t("../../Utils/Path")),f=a(t("../../Utils/Utils")),h=cc._decorator,d=h.ccclass,y=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.img=null,e.outline=null,e.focus=null,e._handbookView=null,e._data=null,e}return r(e,t),e.prototype.init=function(t,e){var n=this;this._handbookView=e,this._data=t,this._view=this._data.view;var o=l.ConfigManager.instance.getEnemyConfig(this._data.id),r=p.default.getAvatar(o.avatarAsset),i=p.default.getItemOutlinePath(1);f.default.loadImg(this.img,r,60),f.default.loadImg(this.outline,i),this.img.node.opacity=t.isUnlock?255:50,t.isUnlock?f.default.ungray(this.img.node):f.default.gray(this.img.node),c.WeaponSystem.instance.targetOff(this),c.WeaponSystem.instance.on(c.WeaponSystem.Events.HandbookEnemy,function(t){n.onHighlight(n._data.id==t)},this);var a=this._view.getSelectEnemeyId();a&&this._data.id==a&&this.onHighlight(!0)},e.prototype.onSelect=function(){this._data.isUnlock?this._view.updateEnemyView(this._data.id):u.default.instance.toast("toast_unlock")},e.prototype.onHighlight=function(t){this.focus.active=t},i([y(cc.Sprite)],e.prototype,"img",void 0),i([y(cc.Sprite)],e.prototype,"outline",void 0),i([y(cc.Node)],e.prototype,"focus",void 0),i([d],e)}(s.default);n.default=_,cc._RF.pop()},{"../../Component/Utils/TableView/TableViewItem":"TableViewItem","../../Gameplay/System/WeaponSystem":"WeaponSystem","../../Module/ConfigManager":"ConfigManager","../../Module/ViewModule":"ViewModule","../../Utils/Path":"Path","../../Utils/Utils":"Utils"}],EnemyStateMachine:[function(t,e,n){"use strict";cc._RF.push(e,"2bad5EVIphDsahstBaHct8c","EnemyStateMachine");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0}),n.EnemyStateMachine=n.EnemyStatus=void 0;var i,a=t("../../../Interface/Config/BuffConfig"),s=t("../../../Utils/StateMachine"),c=t("../AvatarEntity");(function(t){t[t.Start=0]="Start",t[t.Move=1]="Move",t[t.Attack=2]="Attack",t[t.Die=3]="Die"})(i=n.EnemyStatus||(n.EnemyStatus={}));var l=function(t){function e(e){var n=t.call(this)||this;return n.battleContext=e,n.entityContext=e.entityManager,n}return r(e,t),Object.defineProperty(e.prototype,"avatar",{get:function(){return this.context.avatar},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this.context.config},enumerable:!1,configurable:!0}),e}(s.BaseState),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=i.Start,e}return r(e,t),e.prototype.onEnter=function(){var t=this.config.ability;if(t>0){var e=this.entityContext.createAbility(t,{pos:this.context.position});e.owner=this.context,e.createAvatar({parent:this.battleContext.terrain.node})}this.changeState(i.Move)},e}(l),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=i.Move,e}return r(e,t),e.prototype.onEnter=function(){this.context.playAnimByType(c.EntityAnimType.Walk)},e.prototype.update=function(t){if(!this.context.hasBuff(a.BuffType.Stun)){var e=this.context.getMoveSpeed();if(!(e<=0)){var n=this.context.position,o=this.entityContext.getPlayer().avatar.y;if(n.y<o)n.y=o;else{var r=Math.min(e*t,n.y-o);n.y-=r,n.y<o&&(n.y=o)}this.context.position=n,n.y<=o&&this.changeState(i.Attack)}}},e}(l),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=i.Attack,e}return r(e,t),e.prototype.onEnter=function(){},e.prototype.update=function(){if(!this.context.hasBuff(a.BuffType.Stun)&&this.context.canAttack())for(var t=this.entityContext.getPlayer();this.context.canAttack();){var e=this.context.getAttack()-t.getDefense();if(e>0&&t.hurt(e,this.context),!t.isAlive())break}},e}(l),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=i.Die,e}return r(e,t),e.prototype.onEnter=function(){var t=this;this.context.playAnimByType(c.EntityAnimType.Death,1,function(){t.entityContext.removeEnemy(t.context.uid)})},e}(l),d=function(t){function e(e,n){var o=t.call(this,e)||this;return o.addInitState(new u(n)),o.addState(new p(n)),o.addState(new f(n)),o.addState(new h(n)),o}return r(e,t),e}(s.StateMachine);n.EnemyStateMachine=d,cc._RF.pop()},{"../../../Interface/Config/BuffConfig":"BuffConfig","../../../Utils/StateMachine":"StateMachine","../AvatarEntity":"AvatarEntity"}],Enemy:[function(t,e,n){"use strict";cc._RF.push(e,"4951bvgGoVA7YqNzcaKeiQ5","Enemy");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.Enemy=void 0;var s=a(t("../../Component/Gameplay/EntityTag")),c=t("../../Module/ConfigManager"),l=a(t("../../Utils/Path")),u=a(t("../../Utils/Utils")),p=t("./AI/EnemyStateMachine"),f=a(t("../../Module/Audio")),h=t("./BattleEntity"),d=t("../../Interface/Config/AbilityConfig"),y=t("../System/BattleSystem"),_=t("./Guard"),g=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.config=c.ConfigManager.instance.getEnemyConfig(o.id),o.initProperty(),o}return r(e,t),Object.defineProperty(e.prototype,"targetType",{get:function(){return d.AbilityTargetType.Enemy},enumerable:!1,configurable:!0}),e.prototype.initProperty=function(){this._prop.maxHp.setInit(this.config.hp),this._prop.attack.setInit(this.config.attack),this._prop.attackSpeed.setInit(this.config.attackSpeed),this._prop.moveSpeed.setInit(this.config.moveSpeed),this._prop.hurt.setInit(0),this._prop.defense.setInit(0),this.fullHp()},e.prototype.getRawAttackCd=function(){return this.config.attackInterval},e.prototype.setConfigFactors=function(t,e,n){this._prop.maxHp.addPercent(t),this._prop.attack.addPercent(e),this._prop.moveSpeed.addPercent(n),this.fullHp()},e.prototype.getName=function(){var t="enemy_"+this.id+"_name";return c.ConfigManager.instance.getLanConfig(t)},e.prototype.onAvatarReady=function(){this._sm.initState();var t=this.avatar.getChildByName("labelName");if(t){var e=t.getComponent(cc.Label);e&&(e.string=this.getName())}var n=this.avatar.getComponent(cc.Collider);u.default.getOrAddComponent(n.node,s.default).entity=this,this.anim.node.y=0,this.anim.node.opacity=255},e.prototype.getAssetPath=function(){return l.default.getEntityPath(this.config.asset)},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.setContext=function(e){t.prototype.setContext.call(this,e),this._sm=new p.EnemyStateMachine(this,this._context)},e.prototype.isGuardAttackerFull=function(){var t,e,n=0;try{for(var o=i(this.followers),r=o.next();!r.done;r=o.next())r.value instanceof _.Guard&&n++}catch(a){t={error:a}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n>=this.config.maxAttackGuard},e.prototype.findTarget=function(t){var e=this,n=null;switch(t){case d.AbilityTargetType.Player:n=this._entityContext.getPlayer();break;case d.AbilityTargetType.Guard:var o=Array.from(this._entityContext.getAllGuards().values());n=this.getNeareastEntityWithCondition(o,function(t){return!t.followers.has(e)});break;case d.AbilityTargetType.Enemy:o=Array.from(this._entityContext.getAllEnemies().values()),n=this.getNeareastEntityWithCondition(o,function(t){return!t.followers.has(e)})}return n},e.prototype.onHurt=function(t,e,n){var o=this;f.default.instance.playEffect(l.default.effectPath("hurt")),this._context.battleStats.recordDamage(e.id,t);var r=this._anim.node,i=.5*r.width,a=.7*r.height,s=u.default.absPosToAnchorPos(r,cc.v2(i,a)),c=r.convertToWorldSpaceAR(s);this._context.showFloatDamage(c,t,n),this.getHp()<=0&&(this._context.battleStats.addScore(this.config.score),setTimeout(function(){return o.die()},200))},e.prototype.die=function(){this._entityContext.getPlayer().addExp(this.config.exp),this._sm.changeState(p.EnemyStatus.Die),y.BattleSystem.instance.addKillNum(this.id),y.BattleSystem.instance.unlockEnemy(this.id)},e.prototype.update=function(e){t.prototype.update.call(this,e),this._sm.update(e),this._avatar&&this.isAlive()&&(this._avatar.zIndex=-this._avatar.getPosition().y)},e.prototype.toString=function(){return"Enemy: "+this.getName()+"["+this.uid+"]"},e}(h.BattleEntity);n.Enemy=g,cc._RF.pop()},{"../../Component/Gameplay/EntityTag":"EntityTag","../../Interface/Config/AbilityConfig":"AbilityConfig","../../Module/Audio":"Audio","../../Module/ConfigManager":"ConfigManager","../../Utils/Path":"Path","../../Utils/Utils":"Utils","../System/BattleSystem":"BattleSystem","./AI/EnemyStateMachine":"EnemyStateMachine","./BattleEntity":"BattleEntity","./Guard":"Guard"}],EntityCollector:[function(t,e,n){"use strict";cc._RF.push(e,"02f00li2QZIcoAdIVH9e32o","EntityCollector");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("./EntityTag")),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._entitys=new Set,e._isValid=!1,e}return r(e,t),e.prototype.getEntities=function(){return this._entitys},e.prototype.clear=function(){this._entitys.clear()},e.prototype.isCollisionValid=function(){return this._isValid},e.prototype.start=function(){this._isValid=!1},e.prototype.onEnable=function(){var t=this;this.scheduleOnce(function(){return t._isValid=!0},0)},e.prototype.onDisable=function(){this._isValid=!1},e.prototype.onCollisionEnter=function(t){var e=t.node.getComponent(s.default);null!=e.entity?this.predict&&!this.predict(e.entity)||this._entitys.add(e.entity):cc.error("[EntityCollector] onCollision, other entity is null")},e.prototype.onCollisionExit=function(t){var e=t.node.getComponent(s.default);null!=e.entity?this._entitys.delete(e.entity):cc.error("[EntityCollector] onCollision, other entity is null")},i([l],e)}(cc.Component));n.default=u,cc._RF.pop()},{"./EntityTag":"EntityTag"}],EntityManager:[function(t,e,n){"use strict";cc._RF.push(e,"d9fdcWlC35K05kBcN2kW7WF","EntityManager");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.EntityManager=void 0;var s=t("./Bullet"),c=t("./Enemy"),l=t("./Guard"),u=t("./Player"),p=t("./Ability"),f=a(t("../../Utils/Utils")),h=t("./Buff"),d={GuardCreate:"GuardCreate",GuardDestroy:"GuardDestroy",AbilityCreate:"AbilityCreate",AbilityDestroy:"AbilityDestroy",BulletCreate:"BulletCreate",BulletDestroy:"BulletDestroy",EnemyCreate:"EnemyCreate",EnemyDestroy:"EnemyDestroy",PlayerCreate:"PlayerCreate"},y=function(t){function e(e){var n=t.call(this)||this;return n._guards=new Map,n._abilities=new Map,n._bullets=new Map,n._enemies=new Map,n._buffs=new Map,n._allMaps=[n._guards,n._enemies,n._abilities,n._bullets,n._buffs],n._nextUid=1,n.battleContext=e,n}return r(e,t),e.prototype.createGuard=function(t,e){var n=this._nextUid++,o=new l.Guard(n,t);return o.setContext(this.battleContext),this.setEntityCreateInfo(o,e),this._guards.set(n,o),this.emit(d.GuardCreate,o),o},e.prototype.createAbility=function(t,e){var n=this._nextUid++,o=new p.Ability(n,t);return o.setContext(this.battleContext),this.setEntityCreateInfo(o,e),this._abilities.set(n,o),this.emit(d.AbilityCreate,o),o},e.prototype.createBullet=function(t,e){var n=this._nextUid++,o=new s.Bullet(n,t);return o.setContext(this.battleContext),this.setEntityCreateInfo(o,e),this._bullets.set(n,o),this.emit(d.BulletCreate,o),o},e.prototype.createEnemy=function(t,e){var n=this._nextUid++,o=new c.Enemy(n,t);return o.setContext(this.battleContext),this.setEntityCreateInfo(o,e),this._enemies.set(n,o),this.emit(d.EnemyCreate,o),o},e.prototype.createBuff=function(t,e,n){var o=this._nextUid++,r=h.BuffCreator.create(o,t);return r.owner=n,r.setContext(this.battleContext),e.addBuff(r)?(this._buffs.set(o,r),r):null},e.prototype.setEntityCreateInfo=function(t,e){t&&e&&t.setInitPos(e.pos)},e.prototype.createPlayer=function(t,e){var n=this._nextUid++;return this._player=new u.Player(n,t),this._player.setContext(this.battleContext),this.setEntityCreateInfo(this._player,e),this.emit(d.PlayerCreate,this._player),this._player},e.prototype.upgradeGuard=function(t,e){var n=this;if(e.every(function(t){return null!=n._guards.get(t)})){var o=this.getGuard(f.default.randomSelect(e)).position;e.forEach(function(t){return n.removeGuard(t)}),this.createGuard(t,{pos:o})}},e.prototype.removeGuard=function(t){var e=this._guards.get(t);null!=e&&(e.destroy(),this._guards.delete(t),this.emit(d.GuardDestroy,e))},e.prototype.removeAbility=function(t){var e=this._abilities.get(t);null!=e&&(e.destroy(),this._abilities.delete(t),this.emit(d.AbilityDestroy,e))},e.prototype.removeBullet=function(t){var e=this._bullets.get(t);null!=e&&(e.destroy(),this._bullets.delete(t),this.emit(d.BulletDestroy,e))},e.prototype.removeEnemy=function(t){var e=this._enemies.get(t);null!=e&&(e.destroy(),this._enemies.delete(t),this.emit(d.EnemyDestroy,e))},e.prototype.removeBuff=function(t){var e=this._buffs.get(t);null!=e&&(e.destroy(),e.target.removeBuff(e),this._buffs.delete(t))},e.prototype.getGuard=function(t){return this._guards.get(t)},e.prototype.getAllGuards=function(){return this._guards},e.prototype.getBullet=function(t){return this._bullets.get(t)},e.prototype.getAllBullets=function(){return this._bullets},e.prototype.getEnemy=function(t){return this._enemies.get(t)},e.prototype.getAllEnemies=function(){return this._enemies},e.prototype.getPlayer=function(){return this._player},e.prototype.getBuff=function(t){return this._buffs.get(t)},e.prototype.getEntity=function(t){var e,n;if(t==this._player.uid)return this._player;try{for(var o=i(this._allMaps),r=o.next();!r.done;r=o.next()){var a=r.value;if(a.has(t))return a.get(t)}}catch(s){e={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return null},e.prototype.update=function(t){var e,n,o,r,a,s,c,l,u,p;this._player.update(t);try{for(var f=i(this._guards.values()),h=f.next();!h.done;h=f.next())h.value.update(t)}catch(S){e={error:S}}finally{try{h&&!h.done&&(n=f.return)&&n.call(f)}finally{if(e)throw e.error}}try{for(var d=i(this._abilities.values()),y=d.next();!y.done;y=d.next())y.value.update(t)}catch(C){o={error:C}}finally{try{y&&!y.done&&(r=d.return)&&r.call(d)}finally{if(o)throw o.error}}try{for(var _=i(this._bullets.values()),g=_.next();!g.done;g=_.next())g.value.update(t)}catch(A){a={error:A}}finally{try{g&&!g.done&&(s=_.return)&&s.call(_)}finally{if(a)throw a.error}}try{for(var v=i(this._enemies.values()),m=v.next();!m.done;m=v.next())m.value.update(t)}catch(M){c={error:M}}finally{try{m&&!m.done&&(l=v.return)&&l.call(v)}finally{if(c)throw c.error}}try{for(var b=i(this._buffs.values()),w=b.next();!w.done;w=b.next())w.value.update(t)}catch(P){u={error:P}}finally{try{w&&!w.done&&(p=b.return)&&p.call(b)}finally{if(u)throw u.error}}},e.prototype.destroy=function(){var t,e,n,o,r,a,s,c,l,u;this._player&&(this._player.destroy(),this._player=null);try{for(var p=i(this._guards.keys()),f=p.next();!f.done;f=p.next()){var h=f.value;this.removeGuard(h)}}catch(S){t={error:S}}finally{try{f&&!f.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}this._guards.clear();try{for(var d=i(this._abilities.keys()),y=d.next();!y.done;y=d.next())h=y.value,this.removeAbility(h)}catch(C){n={error:C}}finally{try{y&&!y.done&&(o=d.return)&&o.call(d)}finally{if(n)throw n.error}}this._abilities.clear();try{for(var _=i(this._bullets.keys()),g=_.next();!g.done;g=_.next())h=g.value,this.removeBullet(h)}catch(A){r={error:A}}finally{try{g&&!g.done&&(a=_.return)&&a.call(_)}finally{if(r)throw r.error}}this._bullets.clear();try{for(var v=i(this._enemies.keys()),m=v.next();!m.done;m=v.next())h=m.value,this.removeEnemy(h)}catch(M){s={error:M}}finally{try{m&&!m.done&&(c=v.return)&&c.call(v)}finally{if(s)throw s.error}}this._enemies.clear();try{for(var b=i(this._buffs.keys()),w=b.next();!w.done;w=b.next())h=w.value,this.removeBuff(h)}catch(P){l={error:P}}finally{try{w&&!w.done&&(u=b.return)&&u.call(b)}finally{if(l)throw l.error}}this._buffs.clear()},e.Events=d,e}(cc.EventTarget);n.EntityManager=y,cc._RF.pop()},{"../../Utils/Utils":"Utils","./Ability":"Ability","./Buff":"Buff","./Bullet":"Bullet","./Enemy":"Enemy","./Guard":"Guard","./Player":"Player"}],EntityTag:[function(t,e,n){"use strict";cc._RF.push(e,"3be69fxeqBDuYLXZxD/i0/a","EntityTag");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],EntryConfig:[function(t,e,n){"use strict";cc._RF.push(e,"46e7fvyV/JO6o7uMUmVtTrm","EntryConfig"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],EntryType:[function(t,e,n){"use strict";cc._RF.push(e,"97b6apBFWRMW5mSvSDrQC5W","EntryType"),Object.defineProperty(n,"__esModule",{value:!0}),n.EntryType=void 0,function(t){t.AddHp="AddHp",t.AddAttack="AddAttack",t.AddMoveSpeed="AddMoveSpeed",t.AddAttackSpped="AddAttackSpped",t.BulletNum="BulletNum"}(n.EntryType||(n.EntryType={})),cc._RF.pop()},{}],ErrorReporter:[function(t,e,n){"use strict";cc._RF.push(e,"c8aa5k8MjVJSoir8c2kUFcF","ErrorReporter");var o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},r=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../Enum/ErrorType")),c=a(t("../Gameplay/GameDefine")),l=a(t("../Module/Database/Db")),u=a(t("./Platform")),p=function(){function t(){this._logs=[],this._reported=[]}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.enableReportLog()},t.prototype.report=function(t,e){if(!this._reported.some(function(n){return n.type==e&&n.name==t.name&&n.message==t.message&&n.stack==t.stack})){var n={type:e,version:c.default.VERSION,isNewUser:l.default.instance.isNewUser(),name:t.name,message:t.message,stack:t.stack,logs:this._logs};return u.default.isMobile()&&(n.systemInfo=SDKBridge.getInstance().getSystemInfo()),console.warn("error",n),this._reported.push(n),new Promise(function(){})}},t.prototype.enableReportLog=function(){var t,e,n=this;if(!this._console){this._console={};var o=function(t){var e=console[t];a._console[t]=e,console[t]=function(){for(var t,o,i,a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];i=1===a.length?null!==(o=null===(t=a[0])||void 0===t?void 0:t.toString())&&void 0!==o?o:"null":a.map(function(t){var e;return null!==(e=null==t?void 0:t.toString())&&void 0!==e?e:"null"}).join(", "),n._logs.push(i),n._logs.length>c.default.MAX_REPORT_LOG_COUNT&&n._logs.shift(),e.apply(void 0,r(a))}},a=this;try{for(var s=i(["log","info","warn","error"]),l=s.next();!l.done;l=s.next())o(l.value)}catch(u){t={error:u}}finally{try{l&&!l.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}}},t.prototype.disableReportLog=function(){var t,e;if(this._console){try{for(var n=i(["log","info","warn","error"]),o=n.next();!o.done;o=n.next()){var r=o.value;console[r]=this._console[r]}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this._console=null}},t.prototype.enableGlobalCatch=function(){var t=this;cc.sys.platform===cc.sys.WECHAT_GAME?wx.onError(function(e){t.report(e,s.default.GLOBAL)}):cc.sys.isBrowser?window.onerror=function(t,e,n,o,r){this.report(r,s.default.GLOBAL)}:cc.sys.isNative&&(window.__errorHandler=function(t,e,n,o,r){this.report(r,s.default.GLOBAL)})},t._instance=null,t}();n.default=p,cc._RF.pop()},{"../Enum/ErrorType":"ErrorType","../Gameplay/GameDefine":"GameDefine","../Module/Database/Db":"Db","./Platform":"Platform"}],ErrorType:[function(t,e,n){"use strict";cc._RF.push(e,"cb5c9VTG09OkJTf1Mo7PBxR","ErrorType"),Object.defineProperty(n,"__esModule",{value:!0}),n.default={LOADING:"LoadingError",GAME_INIT:"GameInitError",GAME_UPDATE:"GameUpdateError",GLOBAL:"GlobalError"},cc._RF.pop()},{}],FFComponent:[function(t,e,n){"use strict";cc._RF.push(e,"07750AVKTxCaZdh9/NziAnw","FFComponent");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=cc._decorator.ccclass,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._res=[],e}return r(e,t),e.prototype.onDestroy=function(){for(var t=0;t<this._res.length;t++){var e=this._res[t];cc.isValid(e)&&this.releaseAsset(e)}this._res.length=0},e.prototype.loadAutoRes=function(t,e,n,o){var r=this;o||(o=this),l.default.loadRes(t,e,function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var o=t[e];r.retainAsset(o),r._res.push(o)}else r.retainAsset(t),r._res.push(t);n&&n(t)},o)},e.prototype.loadAutoResAsync=function(t,e,n){var o=this;return n||(n=this),l.default.loadResAsync(t,e,n).then(function(t){return o.retainAsset(t),o._res.push(t),t})},e.prototype.retainAsset=function(){},e.prototype.releaseAsset=function(){},i([s],e)}(cc.Component);n.default=c;var l=a(t("./Loader"));cc._RF.pop()},{"./Loader":"Loader"}],FanTest:[function(t,e,n){"use strict";cc._RF.push(e,"bcffcj+4bFBNp6YOe3JT6On","FanTest");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../Utils/Utils")),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.initAngle=90,e.range=90,e.radius=50,e.others=[],e}return r(e,t),e.prototype.start=function(){var t=this.initAngle-this.range/2,e=s.default.getOrAddComponent(this.node,cc.Graphics);e.strokeColor=cc.Color.GREEN,s.default.drawFan(e,this.radius,t,this.range),this.generateFanCollider()},e.prototype.generateFanCollider=function(){var t=s.default.getOrAddComponent(this.node,cc.PolygonCollider),e=Math.ceil(this.range/30),n=[];n.push(cc.Vec2.ZERO);for(var o=this.initAngle-this.range/2,r=0;r<=e;++r){var i=o+r*(this.range/e),a=Math.cos(cc.misc.degreesToRadians(i))*this.radius,c=Math.sin(cc.misc.degreesToRadians(i))*this.radius;cc.log("poly",r,i,a,c),n.push(cc.v2(a,c))}t.points=n,cc.log(t)},e.prototype.update=function(){this.node.color=this.others.length>0?cc.Color.RED:cc.Color.WHITE},i([u(cc.Sprite)],e.prototype,"sprite",void 0),i([u],e.prototype,"initAngle",void 0),i([u],e.prototype,"range",void 0),i([u],e.prototype,"radius",void 0),i([l],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../Utils/Utils":"Utils"}],FlexLabel:[function(t,e,n){"use strict";cc._RF.push(e,"9a82brJsmpOWraCXYe8nA8r","FlexLabel");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s={FLEX_WIDTH:"flex_width"},c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){this._label||(this._label=this.getComponent(cc.Label)),this._label.node.on("size-changed",this.onSizeChanged,this),this._rawWidth=this._label.node.width},e.prototype.onSizeChanged=function(){var t=this.node.width;this.node.emit(s.FLEX_WIDTH,Math.max(this._rawWidth,t))},e.EventType=s,i([a],e)}(cc.Component);n.default=c,cc._RF.pop()},{}],FrameExecutor:[function(t,e,n){"use strict";cc._RF.push(e,"7d24czN0HpDNZ5VnaO/Jdps","FrameExecutor"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e,n){this._handler=null,this._sourceData=null,this._complete=null,this._context=null,this._update=null,this.index=0,this.set(t,e,n),this._update=this.next.bind(this)}return t.prototype.next=function(){for(var t=Date.now();;){var e=this.index,n=this._sourceData[e];if(!n){this._complete&&this._complete(),this.stop();break}if(!this._handler(n,e))break;if(this.index++,Date.now()-t>3)break}},t.prototype.free=function(){this._handler=null,this._sourceData=null,this._complete=null},t.prototype.set=function(t,e,n){return this._handler=t,this._complete=n,e instanceof Array?this._sourceData=e:this._sourceData=Object.values(e),this},t.prototype.start=function(t){return this.index=0,this._context=t,t.schedule(this._update,0,cc.macro.REPEAT_FOREVER,0),this},t.prototype.stop=function(){return this._context.unschedule(this._update),this._context=null,this._handler=null,this._sourceData=null,this._complete=null,this},t.prototype.pause=function(){return this._context.schedule(this._update,0,cc.macro.REPEAT_FOREVER,0),this},t.prototype.resume=function(){return this._context.unschedule(this._update),this},t.prototype.isFinished=function(){return this.index>=this._sourceData.length},t}();n.default=o,cc._RF.pop()},{}],GameDefine:[function(t,e,n){"use strict";cc._RF.push(e,"cd8d69FOLlB176+5MoyeEMa","GameDefine"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.VERSION="0.0.1",t.MAX_STAT_LOG_CACHE=10,t.STAT_SEND_PERIOD=60,t.MAX_REPORT_LOG_COUNT=200,t.ShowDebugPad=!0,t.GemMaxNum=6,t.GemMaxTypeNum=8,t.MaxLabelIndex=4,t.MaxGemCapacity=100,t.EquipmentPartNumber=6,t.CreateGuardGap=2,t.CostEnergyToBattle=10,t.StageHp=5,t.StartBGM=1,t.BattleBGM=2,t.MaxLineupNum=5,t.MaxLineupCardNum=3,t.MaxEntryNum=3,t.BaseCardGroupId=1,t.PlayerId=-1,t.PlayerInitHp=100,t.InvincibleDefense=9999999,t.DefaultScatterAngle=25,t.AssignTargetRadius=100,t.ReassignPointDistance=50,t.DisableWeaponGuard=!1,t.DebugAblity=!1,t.DebugBuff=!1,t.DebugAssign=!1,t}();n.default=o,cc._RF.pop()},{}],GameScene:[function(t,e,n){"use strict";cc._RF.push(e,"e68c0oV6G1DEJzPMEqGZ3aG","GameScene");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../../Debug/DebugPad"),u=c(t("../../Enum/ViewType")),p=c(t("../../Gameplay/GameDefine")),f=t("../../Gameplay/System/BattleSystem"),h=t("../../Gameplay/System/HomeSystem"),d=c(t("../../Module/ViewModule")),y=cc._decorator,_=y.ccclass,g=y.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.topUIPrefab=null,e.bottomUIPrefab=null,e.lowerUI=null,e.topUI=null,e}return r(e,t),e.prototype.start=function(){return a(this,void 0,void 0,function(){return s(this,function(){return p.default.ShowDebugPad&&l.DebugPad.init(),this.initUI(),[2]})})},e.prototype.initUI=function(){d.default.instance.translateView("HomeWorld",null,{onLoaded:this.onHomeWorldLoaded.bind(this)}),f.BattleSystem.instance.targetOff(this),f.BattleSystem.instance.on(f.BattleSystem.Events.BattleStart,this.onBattleStart,this),f.BattleSystem.instance.on(f.BattleSystem.Events.BattleEnd,this.onBattleEnd,this),this.lowerUI=d.default.instance.getViewRoot(u.default.LowerUI),this.topUI=d.default.instance.getViewRoot(u.default.TopUI);var t=cc.instantiate(this.bottomUIPrefab);t.parent=this.lowerUI,t.getComponent("HomeBottomUI").init();var e=cc.instantiate(this.topUIPrefab);e.parent=this.topUI,e.getComponent("HomeTopUI").init()},e.prototype.onHomeWorldLoaded=function(t){h.HomeSystem.instance.onHomeWorldLoaded(t)},e.prototype.onBattleStart=function(){this.lowerUI.active=!1,this.lowerUI.active=!1},e.prototype.onBattleEnd=function(){this.lowerUI.active=!0,this.lowerUI.active=!0},i([g(cc.Prefab)],e.prototype,"topUIPrefab",void 0),i([g(cc.Prefab)],e.prototype,"bottomUIPrefab",void 0),i([_],e)}(cc.Component);n.default=v,cc._RF.pop()},{"../../Debug/DebugPad":"DebugPad","../../Enum/ViewType":"ViewType","../../Gameplay/GameDefine":"GameDefine","../../Gameplay/System/BattleSystem":"BattleSystem","../../Gameplay/System/HomeSystem":"HomeSystem","../../Module/ViewModule":"ViewModule"}],Game:[function(t,e,n){"use strict";cc._RF.push(e,"a3f38mvysRA1ZPXCcZGv0Pa","Game");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../Enum/ErrorType")),c=a(t("../Utils/ErrorReporter")),l=t("./System/AdSystem"),u=t("./System/BagSystem"),p=t("./System/BattleSystem"),f=t("./System/HomeSystem"),h=t("./System/WeaponSystem"),d=function(){function t(){this._scheduleHandler=null,this._scene=null,this._systems=null,this._isInited=!1}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.init=function(){return o(this,void 0,void 0,function(){var t,e;return r(this,function(n){switch(n.label){case 0:cc.game.setFrameRate(60),this._systems=[u.BagSystem.instance,h.WeaponSystem.instance,p.BattleSystem.instance,f.HomeSystem.instance,l.AdSystem.instance],console.log("[Game] system init start ==============="),t=0,n.label=1;case 1:return t<this._systems.length?(e=this._systems[t],console.log("[Game] init system "+e.name),[4,e.init()]):[3,4];case 2:n.sent(),n.label=3;case 3:return t++,[3,1];case 4:console.log("[Game] system lateInit start ==============="),t=0,n.label=5;case 5:return t<this._systems.length?(e=this._systems[t]).lateInit?(console.log("[Game] lateInit system "+e.name),[4,e.lateInit()]):[3,7]:[3,8];case 6:n.sent(),n.label=7;case 7:return t++,[3,5];case 8:return this._isInited=!0,console.log("[Game] init finish ==============="),this.startInterval(),[2]}})})},t.prototype.isInited=function(){return this._isInited},t.prototype.setAttachScene=function(t){this._scene=t,this.startInterval()},t.prototype.startInterval=function(){cc.director.getScheduler().scheduleUpdate(this,0,!1)},t.prototype.clearInterval=function(){cc.director.getScheduler().unscheduleUpdate(this)},t.prototype.destroy=function(){var e,n;if(this._systems){try{for(var o=i(this._systems),r=o.next();!r.done;r=o.next()){var a=r.value;a.destroy&&a.destroy()}}catch(s){e={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}this.clearInterval(),this._systems=null,t._instance=null,cc.director.getScheduler().unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_NON_SYSTEM)}},t.prototype.time=function(){return Date.now()},t.prototype.update=function(t){var e,n,o,r;try{try{for(var a=i(this._systems),l=a.next();!l.done;l=a.next())(f=l.value).logicUpdate(t)}catch(h){e={error:h}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}try{for(var u=i(this._systems),p=u.next();!p.done;p=u.next()){var f;(f=p.value).lateLogicUpdate&&f.lateLogicUpdate(t)}}catch(d){o={error:d}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(o)throw o.error}}}catch(y){c.default.instance.report(y,s.default.GAME_UPDATE)}},t._instance=null,t}();n.default=d,cc._RF.pop()},{"../Enum/ErrorType":"ErrorType","../Utils/ErrorReporter":"ErrorReporter","./System/AdSystem":"AdSystem","./System/BagSystem":"BagSystem","./System/BattleSystem":"BattleSystem","./System/HomeSystem":"HomeSystem","./System/WeaponSystem":"WeaponSystem"}],GemConfig:[function(t,e,n){"use strict";cc._RF.push(e,"4cf1bNdhqJJJ4GzZ+9EAKAi","GemConfig"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],GemItem:[function(t,e,n){"use strict";cc._RF.push(e,"aca44vMnX5ASKtrsTia2n9i","GemItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Component/Utils/TableView/TableViewItem")),c=t("../../Gameplay/System/BagSystem"),l=a(t("../../Module/ViewModule")),u=a(t("../../Utils/Path")),p=a(t("../../Utils/Utils")),f=cc._decorator,h=f.ccclass,d=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.img=null,e.outline=null,e.focus=null,e.controlNode=null,e.labelEquip=null,e.labelSell=null,e._data=null,e._bagView=null,e._initWord=!1,e}return r(e,t),e.prototype.init=function(t,e){this._bagView=e,this._data=t;var n=u.default.getGemPath(t.id),o=u.default.getItemOutlinePath(t.quality);p.default.loadImg(this.img,n,60),p.default.loadImg(this.outline,o)},e.prototype.onSelect=function(){var t=this;l.default.instance.pushView("BagCompareView",{gemData:this._data,cb:function(e){e?c.BagSystem.instance.useGem(t._data.tag,t._data.index):c.BagSystem.instance.sellGem([t._data])}})},i([d(cc.Sprite)],e.prototype,"img",void 0),i([d(cc.Sprite)],e.prototype,"outline",void 0),i([d(cc.Node)],e.prototype,"focus",void 0),i([d(cc.Node)],e.prototype,"controlNode",void 0),i([d(cc.Label)],e.prototype,"labelEquip",void 0),i([d(cc.Label)],e.prototype,"labelSell",void 0),i([h],e)}(s.default);n.default=y,cc._RF.pop()},{"../../Component/Utils/TableView/TableViewItem":"TableViewItem","../../Gameplay/System/BagSystem":"BagSystem","../../Module/ViewModule":"ViewModule","../../Utils/Path":"Path","../../Utils/Utils":"Utils"}],GemPropView:[function(t,e,n){"use strict";cc._RF.push(e,"71f4cCEWLlEeIE0No2LwOe2","GemPropView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../Module/ConfigManager"),c=a(t("../Module/ViewHandler")),l=a(t("../Utils/Path")),u=a(t("../Utils/Utils")),p=cc._decorator,f=p.ccclass,h=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.labelGemName=null,e.labelScore=null,e.gemSp=null,e.gemOutline=null,e.labelNode=null,e.entryNode=null,e._partIndex=null,e._slotData=null,e}return r(e,t),e.prototype.initiateView=function(t){this._partIndex=t.index,this._slotData=t;var e=this._slotData.gem,n=u.default.replaceStr("ui_slotIndex",t.index+1),o=s.ConfigManager.instance.getLanConfig("ui_gemQuality_"+e.quality);this.labelTitle.string=o+n,u.default.localize(this.labelGemName,"gem_"+this._partIndex+"_name"),this.labelScore.string=u.default.replaceStr("ui_score",e.score);var r=l.default.getGemPath(e.id),i=l.default.getItemOutlinePath(e.quality);u.default.loadImg(this.gemSp,r,80),u.default.loadImg(this.gemOutline,i,120),this.initLabelNodes()},e.prototype.initLabelNodes=function(){this.entryNode.removeAllChildren();for(var t=function(t,e){t.getChildByName("labelContent").getComponent(cc.Label).string=u.default.getEntryInfoDesc(e),t.getChildByName("labelStar").getComponent(cc.Label).string=""+e.quality;var n=t.getChildByName("labelProgress").getComponent(cc.Label),o=Math.round(100*e.progress);n.node.color=u.default.getLabelColor(o),n.string=o+"%"},e=this._slotData.gem,n=0;n<e.entryInfo.length;n++){var o=e.entryInfo[n],r=cc.instantiate(this.labelNode);r.parent=this.entryNode,t(r,o)}},e.prototype.onConfirm=function(){this.close()},i([h(cc.Label)],e.prototype,"labelTitle",void 0),i([h(cc.Label)],e.prototype,"labelGemName",void 0),i([h(cc.Label)],e.prototype,"labelScore",void 0),i([h(cc.Sprite)],e.prototype,"gemSp",void 0),i([h(cc.Sprite)],e.prototype,"gemOutline",void 0),i([h(cc.Prefab)],e.prototype,"labelNode",void 0),i([h(cc.Node)],e.prototype,"entryNode",void 0),i([f],e)}(c.default);n.default=d,cc._RF.pop()},{"../Module/ConfigManager":"ConfigManager","../Module/ViewHandler":"ViewHandler","../Utils/Path":"Path","../Utils/Utils":"Utils"}],GemType:[function(t,e,n){"use strict";cc._RF.push(e,"8efedKvXENIg5tcDcbbzIL4","GemType"),Object.defineProperty(n,"__esModule",{value:!0}),n.GemType=void 0,function(t){t.red="red",t.black="black",t.yellow="yellow",t.pink="pink",t.blue="blue",t.dimond="dimond",t.purple="purple",t.green="green"}(n.GemType||(n.GemType={})),cc._RF.pop()},{}],GenCollider:[function(t,e,n){"use strict";cc._RF.push(e,"ed635I6a2dLWa3afyCDy7MI","GenCollider");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s,c=a(t("../../Utils/Utils")),l=cc._decorator,u=l.ccclass,p=l.property;(function(t){t[t.Box=0]="Box",t[t.Circle=1]="Circle",t[t.Fan=2]="Fan"})(s||(s={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.colliderType=s.Box,e.size=cc.size(100,100),e.radius=50,e.startAngle=0,e.rangeAngle=90,e.offset=cc.v2(0,0),e.debugDraw=!1,e.debugColor=cc.Color.RED,e._collider=null,e}return r(e,t),e.prototype.onLoad=function(){this.colliderType===s.Box?this._collider=c.default.setBoxCollider(this.node,this.size,this.offset):this.colliderType===s.Circle?this._collider=c.default.setCircleCollider(this.node,this.radius,this.offset):this.colliderType===s.Fan&&(this._collider=c.default.setFanCollider(this.node,this.radius,this.startAngle,this.rangeAngle,30,this.offset)),this.debugDraw&&this._collider&&c.default.drawCollider(this._collider,this.debugColor)},i([p({type:cc.Enum(s)})],e.prototype,"colliderType",void 0),i([p({visible:function(){return this.colliderType===s.Box}})],e.prototype,"size",void 0),i([p({visible:function(){return this.colliderType===s.Circle||this.colliderType===s.Fan}})],e.prototype,"radius",void 0),i([p({visible:function(){return this.colliderType===s.Fan}})],e.prototype,"startAngle",void 0),i([p({visible:function(){return this.colliderType===s.Fan}})],e.prototype,"rangeAngle",void 0),i([p],e.prototype,"offset",void 0),i([p],e.prototype,"debugDraw",void 0),i([p({visible:function(){return this.debugDraw}})],e.prototype,"debugColor",void 0),i([u],e)}(cc.Component);n.default=f,cc._RF.pop()},{"../../Utils/Utils":"Utils"}],GraphicsTest:[function(t,e,n){"use strict";cc._RF.push(e,"608eaqKEjxCJY2BPvO41m+3","GraphicsTest");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../Utils/Utils")),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rectCenter=cc.v2(),e.rectSize=cc.size(100,50),e.rectAngle=0,e.circleCenter=cc.v2(0,-300),e.circleRadius=200,e.fanCenter=cc.v2(0,300),e.fanRadius=300,e.fanStart=30,e.fanRange=90,e}return r(e,t),e.prototype.start=function(){this.graphics=s.default.getOrAddComponent(this.node,cc.Graphics),this.graphics.lineWidth=3},e.prototype.update=function(){this.graphics.clear(),s.default.drawRect(this.graphics,this.rectSize.width,this.rectSize.height,this.rectCenter,this.rectAngle),s.default.drawCircle(this.graphics,this.circleRadius,this.circleCenter),s.default.drawFan(this.graphics,this.fanRadius,this.fanStart,this.fanRange,this.fanCenter)},i([u(cc.Vec2)],e.prototype,"rectCenter",void 0),i([u(cc.Size)],e.prototype,"rectSize",void 0),i([u],e.prototype,"rectAngle",void 0),i([u(cc.Vec2)],e.prototype,"circleCenter",void 0),i([u],e.prototype,"circleRadius",void 0),i([u(cc.Vec2)],e.prototype,"fanCenter",void 0),i([u],e.prototype,"fanRadius",void 0),i([u],e.prototype,"fanStart",void 0),i([u],e.prototype,"fanRange",void 0),i([l],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../Utils/Utils":"Utils"}],GuardConfig:[function(t,e,n){"use strict";cc._RF.push(e,"48749CxSFBKvokEhCTbmgjX","GuardConfig"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],GuardItem:[function(t,e,n){"use strict";cc._RF.push(e,"e1d9cJcCm9Ph6hgvoi5tfel","GuardItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Component/Utils/TableView/TableViewItem")),c=t("../../Gameplay/System/WeaponSystem"),l=t("../../Module/ConfigManager"),u=a(t("../../Module/ViewModule")),p=a(t("../../Utils/Path")),f=a(t("../../Utils/Utils")),h=cc._decorator,d=h.ccclass,y=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.img=null,e.outline=null,e.focus=null,e.labelType=null,e._handbookView=null,e._data=null,e}return r(e,t),e.prototype.init=function(t,e){var n=this;this._handbookView=e,this._data=t,this._view=this._data.view;var o=l.ConfigManager.instance.getGuardConfig(this._data.id),r=p.default.getAvatar(o.avatarAsset),i=p.default.getItemOutlinePath(t.quality);if(f.default.loadImg(this.img,r,60),f.default.loadImg(this.outline,i),o.tags[1]){var a="guard_"+o.tags[1];f.default.localize(this.labelType,a)}this.img.node.opacity=t.isUnlock?255:50,this.labelType.node.parent.active=!!t.isUnlock,t.isUnlock?f.default.ungray(this.img.node):f.default.gray(this.img.node),c.WeaponSystem.instance.targetOff(this),c.WeaponSystem.instance.on(c.WeaponSystem.Events.HandbookGuard,function(t){n.onHighlight(n._data.id==t)},this);var s=this._view.getSelectGuardId();s&&this._data.id==s&&this.onHighlight(!0)},e.prototype.onSelect=function(){this._data.isUnlock?this._view.updateGuardView(this._data.id):u.default.instance.toast("toast_unlock")},e.prototype.onHighlight=function(t){this.focus.active=t},i([y(cc.Sprite)],e.prototype,"img",void 0),i([y(cc.Sprite)],e.prototype,"outline",void 0),i([y(cc.Node)],e.prototype,"focus",void 0),i([y(cc.Label)],e.prototype,"labelType",void 0),i([d],e)}(s.default);n.default=_,cc._RF.pop()},{"../../Component/Utils/TableView/TableViewItem":"TableViewItem","../../Gameplay/System/WeaponSystem":"WeaponSystem","../../Module/ConfigManager":"ConfigManager","../../Module/ViewModule":"ViewModule","../../Utils/Path":"Path","../../Utils/Utils":"Utils"}],GuardStateMachine:[function(t,e,n){"use strict";cc._RF.push(e,"d12a6QOCVpN4bnE6f6gC3Hc","GuardStateMachine");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0}),n.GuardStateMachine=n.GuardStatus=void 0;var i,a=t("../../../Module/ConfigManager"),s=t("../../../Utils/StateMachine"),c=t("../../../Utils/Timer"),l=t("../AvatarEntity");(function(t){t[t.Idle=0]="Idle",t[t.Chase=1]="Chase",t[t.Move=2]="Move",t[t.Attack=3]="Attack"})(i=n.GuardStatus||(n.GuardStatus={}));var u=function(t){function e(e){var n=t.call(this)||this;return n.battleContext=e,n.entityContext=e.entityManager,n}return r(e,t),Object.defineProperty(e.prototype,"guard",{get:function(){return this.context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"avatar",{get:function(){return this.context.avatar},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this.context.config},enumerable:!1,configurable:!0}),e}(s.BaseState),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=i.Idle,e}return r(e,t),e.prototype.onEnter=function(){this.guard.playAnimByType(l.EntityAnimType.Idle),this.timer=new c.IntervalTimer(this.trySearchTarget.bind(this),e.SEARCH_CD,Number.MAX_SAFE_INTEGER,0)},e.prototype.onExit=function(){},e.prototype.update=function(t){null!=this.avatar&&this.timer.step(t)},e.prototype.trySearchTarget=function(){var t=a.ConfigManager.instance.getAbilityConfig(this.config.ability),e=this.context.findTarget(t.targetType);e&&(this.context.setTarget(e),this.guard.canMove()?this.changeState(i.Chase):this.changeState(i.Attack))},e.SEARCH_CD=.1,e}(u),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=i.Move,e}return r(e,t),e.prototype.onEnter=function(t){this.targetPos=t},e.prototype.execute=function(t){this.targetPos=t},e.prototype.update=function(t){var e=this.guard.avatar.getPosition(),n=cc.Vec2.distance(this.targetPos,e);if(n<=10)this.changeState(i.Idle);else{var o=Math.min(this.guard.getMoveSpeed()*t,n),r=this.targetPos.sub(e);r.normalizeSelf(),r.mulSelf(o),e.addSelf(r),this.guard.avatar.setPosition(e),this.guard.anim&&(this.guard.anim.node.scaleX=(r.x>=0?1:-1)*Math.abs(this.guard.anim.node.scaleX))}},e}(u),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=i.Chase,e.isRechasing=!1,e}return r(e,t),e.prototype.onEnter=function(t){void 0===t&&(t=!1),this.guard.playAnimByType(l.EntityAnimType.Walk),this.isRechasing=t},e.prototype.onExit=function(){this.guard.stopAnim()},e.prototype.update=function(t){var e=this.guard.target;if(e&&e.isAlive()){var n=this.guard.avatar.getPosition(),o=e.avatar.getPosition(),r=cc.Vec2.distance(o,n),a=this.guard.getAttackDistance();if(this.isRechasing&&(a*=.7),r<=a)this.changeState(i.Attack);else{var s=Math.min(this.guard.getMoveSpeed()*t,r),c=o.sub(n);c.normalizeSelf(),c.mulSelf(s),n.addSelf(c),this.guard.avatar.setPosition(n),this.guard.anim&&(this.guard.anim.node.scaleX=(c.x>=0?1:-1)*Math.abs(this.guard.anim.node.scaleX))}}else this.changeState(i.Idle)},e}(u),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=i.Attack,e._attachInterval=.01,e._animSpeed=1,e._isInAnim=!1,e}return r(e,t),e.prototype.onEnter=function(){var t;this._attachInterval=this.guard.getAttackInterval(),this._isInAnim=!1;var e=this.guard.getClipByType(l.EntityAnimType.Attack),n=null!==(t=null==e?void 0:e.duration)&&void 0!==t?t:0;this._animSpeed=Math.max(1,n/this._attachInterval),cc.log("duration: "+n+", interval: "+this._attachInterval+", speed: "+this._animSpeed)},e.prototype.onExit=function(){},e.prototype.update=function(){var t=this;if(!this._isInAnim){var e=this.guard.target;if(null==e||!e.isAlive())return this.guard.setTarget(null),void this.changeState(i.Idle);if(this.guard.canAttack()){var n=this.guard.avatar.getPosition(),o=e.avatar.getPosition(),r=cc.Vec2.squaredDistance(o,n),a=this.guard.getAttackDistance();if(r>a*a)this.guard.canMove()?this.changeState(i.Chase,!0):(cc.warn("\u76ee\u6807\uff08"+e+"\uff09\u8ddd\u79bb\u8fc7\u8fdc\uff0c\u5b88\u536b\uff08"+this.guard+"\uff09\u65e0\u6cd5\u79fb\u52a8\uff0c\u91cd\u65b0\u641c\u7d22"),this.guard.setTarget(null),this.changeState(i.Idle));else for(this._isInAnim=!0,this.guard.playAnimByType(l.EntityAnimType.Attack,this._animSpeed,function(){return t._isInAnim=!1});this.guard.canAttack();)this.guard.castAbility(this.guard.config.ability,e),this.guard.onAttackOnce()}}},e}(u),y=function(t){function e(e,n){var o=t.call(this,e)||this;return o.addInitState(new p(n)),o.addState(new h(n)),o.addState(new f(n)),o.addState(new d(n)),o}return r(e,t),e}(s.StateMachine);n.GuardStateMachine=y,cc._RF.pop()},{"../../../Module/ConfigManager":"ConfigManager","../../../Utils/StateMachine":"StateMachine","../../../Utils/Timer":"Timer","../AvatarEntity":"AvatarEntity"}],Guard:[function(t,e,n){"use strict";cc._RF.push(e,"27994wYqlRF96uHmlb1zAtN","Guard");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.Guard=void 0;var s=t("../../Module/ConfigManager"),c=a(t("../../Utils/Path")),l=t("./AI/GuardStateMachine"),u=t("./BattleEntity"),p=a(t("../GameDefine")),f=t("../../Interface/Config/AbilityConfig"),h=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.config=s.ConfigManager.instance.getGuardConfig(o.id),o.type=o.config.type,o.initProperty(),o}return r(e,t),Object.defineProperty(e.prototype,"targetType",{get:function(){return f.AbilityTargetType.Guard},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sm",{get:function(){return this._sm},enumerable:!1,configurable:!0}),e.prototype.initProperty=function(){this._prop.maxHp.setInit(1),this._prop.attack.setInit(this.config.attack),this._prop.attackSpeed.setInit(this.config.attackSpeed),this._prop.attackDistance.setInit(this.config.attackDistance),this._prop.moveSpeed.setInit(this.config.moveSpeed),this._prop.hurt.setInit(0),this._prop.defense.setInit(p.default.InvincibleDefense),this._prop.critRate.setInit(this.config.crit),this._prop.critDamage.setInit(this.config.critDamage),this.fullHp()},e.prototype.getRawAttackCd=function(){var t=s.ConfigManager.instance.getAbilityConfig(this.config.ability);return null==t?void 0:t.cd},e.prototype.getName=function(){var t="guard_"+this.id+"_name";return s.ConfigManager.instance.getLanConfig(t)},e.prototype.getDesc=function(){var t="guard_"+this.id+"_desc";return s.ConfigManager.instance.getLanConfig(t)},e.prototype.onAvatarReady=function(){this._sm.initState();var t=this.avatar.getChildByName("labelName");if(t){var e=t.getComponent(cc.Label);e&&(e.string=this.getName())}},e.prototype.getAssetPath=function(){return c.default.getEntityPath(this.config.asset)},e.prototype.setContext=function(e){t.prototype.setContext.call(this,e),this._sm=new l.GuardStateMachine(this,this._context)},e.prototype.canMove=function(){return this.getMoveSpeed()>0},e.prototype.getDistance=function(t){return!this.avatar||t.avatar?Number.MAX_VALUE:cc.Vec2.distance(this.avatar.getPosition(),t.avatar.getPosition())},e.prototype.isAlive=function(){return!0},e.prototype.findTarget=function(t){var e,n,o=this,r=null;switch(t){case f.AbilityTargetType.Player:r=this._entityContext.getPlayer();break;case f.AbilityTargetType.Guard:var a=Array.from(this._entityContext.getAllGuards().values());r=this.getNeareastEntityWithCondition(a,function(t){return!t.followers.has(o)});break;case f.AbilityTargetType.Enemy:a=Array.from(this._entityContext.getAllEnemies().values());var s=this._context.terrain.guardFrontierY+this._prop.attackDistance.get();a=a.filter(function(t){return!t.isGuardAttackerFull()&&t.avatar&&t.isAlive()&&t.position.y<=s});var c=Number.MAX_VALUE;try{for(var l=i(a),u=l.next();!u.done;u=l.next()){var p=u.value;p.position.y<c&&(r=p,c=p.position.y)}}catch(h){e={error:h}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}}return r},e.prototype.setTarget=function(e){t.prototype.setTarget.call(this,e),this._assignedTarget=null},e.prototype.assignTarget=function(t){this.target!==t&&(this.setTarget(t),this._assignedTarget=t,t&&this._sm.changeState(l.GuardStatus.Chase))},e.prototype.hasAssignedTarget=function(){return null!=this._assignedTarget},e.prototype.moveTo=function(t){this._sm.getCurrentStateName()!=l.GuardStatus.Move?this._sm.changeState(l.GuardStatus.Move,t):this._sm.execute(t)},e.prototype.update=function(e){t.prototype.update.call(this,e),this._sm.update(e),this._avatar&&(this._avatar.zIndex=-this._avatar.getPosition().y)},e.prototype.toString=function(){return"Guard: "+this.getName()+"["+this.uid+"]"},e}(u.BattleEntity);n.Guard=h,cc._RF.pop()},{"../../Interface/Config/AbilityConfig":"AbilityConfig","../../Module/ConfigManager":"ConfigManager","../../Utils/Path":"Path","../GameDefine":"GameDefine","./AI/GuardStateMachine":"GuardStateMachine","./BattleEntity":"BattleEntity"}],GuideData:[function(t,e,n){"use strict";cc._RF.push(e,"69a97nnxn1FXZRrL31PbYeF","GuideData"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],GuideMask:[function(t,e,n){"use strict";cc._RF.push(e,"708a8zUQXVCMqY7u6gdCAdk","GuideMask");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.ClawLayer=void 0;var l,u=c(t("../../Module/Loader")),p=c(t("../../Utils/Path")),f=c(t("../../Utils/Utils")),h=cc._decorator,d=h.ccclass;h.property,function(t){t[t.NONE=0]="NONE",t[t.TRANSPARENT_MASK=1]="TRANSPARENT_MASK",t[t.FULL_MASK=2]="FULL_MASK",t[t.NODE_MASK=3]="NODE_MASK"}(l||(l={}));var y,_=function(){this.isTargetExternal=!0};(function(t){t[t.Upper=0]="Upper",t[t.Lower=1]="Lower"})(y=n.ClawLayer||(n.ClawLayer={}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._maskMode=l.NONE,e._mask=null,e._maskGraphics=null,e._maskBg=null,e._focusTargetNodes=[],e._focusBoundingMap=new Map,e._focusTouchMap=new Map,e._focusExtraBounding=new Map,e._focusMaskDirty=!1,e._clawPrefab=null,e._maxClawHandle=0,e._clawInfoMap=new Map,e._clawNodePool=new cc.NodePool,e}var n;return r(e,t),n=e,e.get=function(){return cc.find("Canvas/MainCamera/GuideLayer").getComponent(n)},e.prototype.onLoad=function(){var t=this;this._lowerContainer=cc.find("Canvas/MainCamera/GuideLayerLower"),this.node.setContentSize(cc.winSize),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this._mask=this.node.getComponentInChildren(cc.Mask),this._mask.inverted=!0,this._mask.node.active=!1,this._maskGraphics=this._mask._graphics,this._maskBg=this._mask.getComponentInChildren(cc.Sprite),u.default.loadRes(p.default.guideClawPath(),cc.Prefab,function(e){t._clawPrefab=e},this)},e.prototype.onTouchStart=function(t){var e,n,o=this.node._touchListener;switch(this._maskMode){case l.NONE:o.setSwallowTouches(!1);break;case l.TRANSPARENT_MASK:case l.FULL_MASK:o.setSwallowTouches(!0);break;case l.NODE_MASK:var r=!1,i=cc.v2(cc.Camera.main.getScreenToWorldPoint(t.getLocation()));try{for(var s=a(this._focusTargetNodes),c=s.next();!c.done;c=s.next()){var u=c.value;if(cc.isValid(u)&&this._focusTouchMap.get(u)&&u.getBoundingBoxToWorld().contains(i)){r=!0;break}}}catch(p){e={error:p}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}o.setSwallowTouches(!r);break;default:cc.warn("[GuideMask] unexpected MaskMode: "+this._maskMode)}},e.prototype.update=function(t){var e,n,o,r,i,c;if(this._maskMode===l.NODE_MASK){this._focusMaskDirty=!1;var u=[];try{for(var p=a(this._focusTargetNodes),f=p.next();!f.done;f=p.next()){var h=f.value;cc.isValid(h)?this._updateFollowTarget(h):u.push(h)}}catch(P){e={error:P}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(e)throw e.error}}try{for(var d=a(u),y=d.next();!y.done;y=d.next())h=y.value,this.hideNodeMask(h)}catch(E){o={error:E}}finally{try{y&&!y.done&&(r=d.return)&&r.call(d)}finally{if(o)throw o.error}}this._focusTargetNodes.length>0?this._updateMaskHole():this.clearMask()}if(this._clawInfoMap.size>0)try{for(var _=a(this._clawInfoMap),g=_.next();!g.done;g=_.next()){var v=s(g.value,2),m=v[0],b=v[1],w=b.target;if(cc.isValid(w,!0)&&w.activeInHierarchy){var S=b.clawNode;if(S){var C=w.convertToWorldSpaceAR(cc.Vec2.ZERO);if(C=S.parent.convertToNodeSpaceAR(C),b.tweenTime){var A=S.getPosition(),M=cc.Vec2.lerp(cc.v2(),A,C,cc.misc.clamp01(t/b.tweenTime));S.setPosition(M),b.tweenTime-=t,b.tweenTime<=0&&(b.tweenTime=null,this._lastClawPos=M)}else S.setPosition(C)}}else this.hideClaw(m)}}catch(O){i={error:O}}finally{try{g&&!g.done&&(c=_.return)&&c.call(_)}finally{if(i)throw i.error}}},e.prototype.showFullMask=function(){this._maskMode!==l.FULL_MASK&&(this._clean(),this._maskMode=l.FULL_MASK,this._mask.node.active=!0,this._mask.enabled=!1,this._maskBg.enabled=!0)},e.prototype.showTransparentMask=function(){this._maskMode!==l.TRANSPARENT_MASK&&(this._clean(),this._maskMode=l.TRANSPARENT_MASK,this._mask.node.active=!0,this._mask.enabled=!1,this._maskBg.enabled=!1)},e.prototype.showNodeMask=function(t,e,n){void 0===e&&(e=!0),this._maskMode===l.NODE_MASK&&this._focusTargetNodes.includes(t)&&1===this._focusTargetNodes.length?this._focusTouchMap.set(t,e):(this._clean(),this.addNodeMask(t,e,n))},e.prototype.addNodeMask=function(t,e,n){void 0===e&&(e=!0),this._maskMode===l.NODE_MASK&&this._focusTargetNodes.includes(t)?this._focusTouchMap.set(t,e):(this._maskMode=l.NODE_MASK,this._mask.node.active=!0,this._mask.enabled=!0,this._maskBg.enabled=!0,this._focusTargetNodes.push(t),this._focusTouchMap.set(t,e),n&&this._focusExtraBounding.set(t,n),this._focusMaskDirty=!0,this._updateMaskHole())},e.prototype.hideNodeMask=function(t){var e=this._focusTargetNodes.indexOf(t);e>=0&&(this._focusTargetNodes.splice(e,1),this._focusTouchMap.delete(t),this._focusBoundingMap.delete(t),this._focusExtraBounding.delete(t),this._focusMaskDirty=!0)},e.prototype._updateFollowTarget=function(t){var e=this._getBoundingBox(t),n=this._focusBoundingMap.get(t);n&&e.equals(n)||(this._focusBoundingMap.set(t,e),this._focusMaskDirty=!0)},e.prototype._getBoundingBox=function(t){var e=t.getBoundingBoxToWorld(),n=this._focusExtraBounding.get(t);if(n){var o=n.left,r=n.right,i=n.top,a=n.bottom;o&&(e.x-=o,e.width+=o),r&&(e.width+=r),a&&(e.y-=a,e.height+=a),i&&(e.height+=i)}return f.default.transformRectTo(this.node,e)},e.prototype._updateMaskHole=function(){var t,e;if(this._focusMaskDirty){this._maskGraphics.clear(!0);try{for(var n=a(this._focusBoundingMap.values()),o=n.next();!o.done;o=n.next()){var r=o.value;this._maskGraphics.fillRect(r.x,r.y,r.width,r.height)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this._focusMaskDirty=!1}},e.prototype.clearMask=function(){this._maskMode=l.NONE,this._clean()},e.prototype._clean=function(){this._focusTargetNodes.splice(0),this._focusBoundingMap.clear(),this._focusTouchMap.clear(),this._focusMaskDirty=!1,this._mask._graphics.clear(!0),this._mask.node.active=!1},e.prototype.isInFocus=function(){return this._focusTargetNodes.length>0},e.prototype.showClaw=function(t){var e=this,n=t.node,o=t.tips,r=t.tipsOffset,i=t.repeat,a=t.onFinish,s=t.noTween,c=t.upsidedown,l=t.targetOffset,u=t.layer,p=t.showFocusCircle,h=this.getTargetHandle(n);h&&this.hideClaw(h),h=++this._maxClawHandle;var d=new _;return d.target=n,d.isTargetExternal=!0,this._clawInfoMap.set(h,d),this._getClaw(null!=u?u:y.Upper).then(function(t){var u;if(!n||!cc.isValid(n,!0))return e.hideClaw(h),h;if(e._clawInfoMap.has(h)){d.clawNode=t,t.active=!0;var y=f.default.convertNodePositionToNode(n,cc.Vec2.ZERO,e.node),_=null!==(u=e._lastClawPos)&&void 0!==u?u:cc.Vec2.ZERO,g=0;if(!s){var v=cc.Vec2.distance(y,_);v>800&&(g=v/800,d.tweenTime=g)}t.setPosition(_);var m=cc.find("labelContainer/label",t).getComponent(cc.Label),b=cc.find("img",t).getComponent(cc.Sprite),w=m.node.parent;w.active=!!o,w.stopAllActions(),o&&(m.string=o,g>0&&(w.active=!1,cc.tween(w).delay(g+.2).call(function(){return w.active=!0}).start()),r?w.setPosition(r.x,r.y):w.setPosition(cc.v2(0,-120)));var S=c?-30:30;b.node.scaleY=c?-1:1,b.node.stopAllActions(),l?b.node.setPosition(l.x,l.y-S):b.node.setPosition(0,-S),null!=i&&i>0?cc.tween(b.node).delay(g).repeat(i,cc.tween().by(.5,{y:S},{easing:"sineIn"}).by(.5,{y:-S},{easing:"sineOut"})).call(function(){e.hideClaw(h),a&&a()}).start():cc.tween(b.node).delay(g).repeatForever(cc.tween().by(.5,{y:S},{easing:"sineIn"}).by(.5,{y:-S},{easing:"sineOut"})).start();var C=t.getChildByName("focusCircle");if(C.active=!!p,p){C.stopAllActions(),l?C.setPosition(l.x,l.y):C.setPosition(0,0);var A=n.getBoundingBoxToWorld();A=f.default.transformRectTo(t,A);var M=cc.misc.clampf(1.3*Math.min(A.height,A.width),100,250),P=Math.min(M+200,1.8*M),E=C.width;cc.tween(C).delay(g).repeatForever(cc.tween().show().set({scale:P/E,opacity:255}).to(.5,{scale:M/E}).to(.3,{opacity:0}).delay(.2)).start()}}else e._clawNodePool.put(t)}),h},e.prototype.showMoveClaw=function(t,e,n,o,r){var i=this,a=++this._maxClawHandle,s=new cc.Node("moveClawTarget");s.parent=this.node,t=this.node.convertToNodeSpaceAR(t),e=this.node.convertToNodeSpaceAR(e),s.setPosition(t);var c=new _;return c.target=s,c.isTargetExternal=!1,this._clawInfoMap.set(a,c),this._getClaw(y.Upper).then(function(l){if(i._clawInfoMap.has(a)){c.clawNode=l,l.active=!0,l.setPosition(t);var u=cc.Vec2.distance(t,e)/800;o?cc.tween(s).repeat(n,cc.tween().delay(.3).to(u,{position:cc.v3(e)}).delay(.3).to(u,{position:cc.v3(t)})).call(function(){i.hideClaw(a),r&&r()}).start():cc.tween(s).repeat(n,cc.tween().delay(.3).to(u,{position:cc.v3(e)}).delay(.3).set({position:cc.v3(t)})).call(function(){i.hideClaw(a),r&&r()}).start();var p=l.getComponentInChildren(cc.Label),f=l.getComponentInChildren(cc.Sprite);p.node.parent.active=!1,f.node.stopAllActions(),f.node.y=0}else i._clawNodePool.put(l)}),a},e.prototype.hideClaw=function(t){var e=this._clawInfoMap.get(t);console.log("[GuideMask] hideClaw: "+t+", exist: "+!!e),e&&(e.clawNode&&(this._lastClawPos=e.clawNode.getPosition(),this._clawNodePool.put(e.clawNode)),e.isTargetExternal||e.target.destroy(),this._clawInfoMap.delete(t))},e.prototype.hideAllClaws=function(){var t,e;try{for(var n=a(this._clawInfoMap),o=n.next();!o.done;o=n.next()){var r=s(o.value,2),i=(r[0],r[1]);i.clawNode&&this._clawNodePool.put(i.clawNode),i.isTargetExternal||i.target.destroy()}}catch(c){t={error:c}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this._clawInfoMap.clear()},e.prototype.clearClawPos=function(){this._lastClawPos=null},e.prototype.isClawShowing=function(t){return this._clawInfoMap.has(t)},e.prototype.isAnyClawShowing=function(){return this._clawInfoMap.size>0},e.prototype.getTargetHandle=function(t){var e,n;try{for(var o=a(this._clawInfoMap),r=o.next();!r.done;r=o.next()){var i=s(r.value,2),c=i[0];if(i[1].target===t)return c}}catch(l){e={error:l}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return null},e.prototype._getClaw=function(t){var e=this;return new Promise(function(t){e._clawPrefab?t(e._clawPrefab):u.default.loadResAsync(p.default.guideClawPath(),cc.Prefab,e).then(function(n){e._clawPrefab=n,t(e._clawPrefab)})}).then(function(n){var o,r=null!==(o=e._clawNodePool.get())&&void 0!==o?o:cc.instantiate(n);return r.parent=t===y.Upper?e.node:e._lowerContainer,r})},e.MaskMode=l,n=i([d],e)}(cc.Component);n.default=g,cc._RF.pop()},{"../../Module/Loader":"Loader","../../Utils/Path":"Path","../../Utils/Utils":"Utils"}],HandbookView:[function(t,e,n){"use strict";cc._RF.push(e,"50fabdKRrtJTLdSxwyVi+rA","HandbookView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.HandBookTabType=void 0;var p,f=u(t("../../Component/Utils/TableView/TableView")),h=t("../../Gameplay/System/BattleSystem"),d=t("../../Gameplay/System/WeaponSystem"),y=t("../../Interface/SaveData/BattleData"),_=t("../../Interface/SaveData/WeaponData"),g=t("../../Module/ConfigManager"),v=u(t("../../Module/Loader")),m=u(t("../../Module/ViewHandler")),b=u(t("../../Module/ViewModule")),w=u(t("../../Utils/Path")),S=u(t("../../Utils/Utils")),C=cc._decorator,A=C.ccclass,M=C.property;(function(t){t[t.Guard=1]="Guard",t[t.Enemy=2]="Enemy"})(p=n.HandBookTabType||(n.HandBookTabType={}));var P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelBtnGuard=null,e.labelNoEnemyInfo=null,e.labelBtnEnemy=null,e.enemyView=null,e.guardView=null,e.btnEnemyNode=null,e.btnGuardNode=null,e.guardRoot=null,e.enemyRoot=null,e.labelName=null,e.labelGuardName=null,e.labelGuardContent=null,e.enemyInfoNode=null,e.labelEnemyName=null,e.labelEnemyContent=null,e.labelAbility=null,e.labelAbilityDesc=null,e.lightBg=null,e.labelCd=null,e.labelAttack=null,e.labelAttackRange=null,e.labelAttackSpeed=null,e.labelMoveSpeed=null,e.labelCrit=null,e.labelCritDamage=null,e.labelType=null,e._curTabType=null,e._viewNodeMap=new Map,e._btnNodeMap=new Map,e._selectGuardId=1,e._selectEnemyId=1,e}return r(e,t),e.prototype.initiateView=function(t){S.default.localize(this.labelNoEnemyInfo,"warn_noEnemyInfo"),S.default.localize(this.labelBtnGuard,"ui_guard"),S.default.localize(this.labelBtnEnemy,"ui_enemy"),S.default.localize(this.labelName,"ui_handbook"),this._viewNodeMap.set(p.Guard,this.guardView.node),this._viewNodeMap.set(p.Enemy,this.enemyView.node),this._btnNodeMap.set(p.Guard,this.btnGuardNode),this._btnNodeMap.set(p.Enemy,this.btnEnemyNode),this.guardView.setLinesData(this._handleGuardData()),this.enemyView.setLinesData(this._handleEnemyData()),this.updateGuardView(this._selectGuardId),this.updateEnemyView(this._selectEnemyId),this.onTab(null,t)},e.prototype.initShowBox=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a,c,l,u,f,d;return s(this,function(s){switch(s.label){case 0:return t==p.Guard?(this.guardRoot.removeAllChildren(),e=w.default.getEntityPath("Guards/Guard_"+this._selectGuardId),n=this.guardRoot,o=g.ConfigManager.instance.getGuardConfig(this._selectGuardId),r=o.ability,i="ability_"+r+"_name",a="ability_"+r+"_desc",S.default.localize(this.labelAbility,i),S.default.localize(this.labelAbilityDesc,a),o.tags[1]&&(c="guard_"+o.tags[1],S.default.localize(this.labelType,c)),l=w.default.getItemLightPath(o.quality),S.default.loadImg(this.lightBg,l),u=g.ConfigManager.instance.getAbilityConfig(r),f=u.cd,this.labelCd.string=S.default.replaceStr("info_cd",f),this.labelAttack.string=""+o.attack,this.labelAttackRange.string=""+o.attackDistance,this.labelAttackSpeed.string=""+o.attackSpeed,this.labelMoveSpeed.string=""+o.moveSpeed,this.labelCrit.string=100*o.crit+"%",this.labelCritDamage.string=100*o.critDamage+"%"):t==p.Enemy&&h.BattleSystem.instance.getUnlockEnemyNum()>0&&(this.enemyRoot.removeAllChildren(),e=w.default.getEntityPath("Enemies/Enemy_"+this._selectEnemyId),n=this.enemyRoot,this.labelNoEnemyInfo.node.active=!1,this.enemyInfoNode.active=!0),e?[4,v.default.loadResAsync(e,cc.Prefab,null)]:[3,2];case 1:d=s.sent(),cc.instantiate(d).parent=n,s.label=2;case 2:return[2]}})})},e.prototype.onAnimateFinish=function(){},e.prototype.getSelectGuardId=function(){return this._selectGuardId},e.prototype.getSelectEnemeyId=function(){return this._selectEnemyId},e.prototype.updateEnemyView=function(t){this._selectEnemyId=t,S.default.localize(this.labelEnemyContent,"enemy_"+t+"_desc"),S.default.localize(this.labelEnemyName,"enemy_"+t+"_name"),this.initShowBox(p.Enemy),d.WeaponSystem.instance.sendMessage(d.WeaponSystem.Events.HandbookEnemy,t)},e.prototype.updateGuardView=function(t){this._selectGuardId=t,S.default.localize(this.labelGuardContent,"guard_"+t+"_desc"),S.default.localize(this.labelGuardName,"guard_"+t+"_name"),this.initShowBox(p.Guard),d.WeaponSystem.instance.sendMessage(d.WeaponSystem.Events.HandbookGuard,t)},e.prototype._handleGuardData=function(){var t=g.ConfigManager.instance.getConfig("CardGroup"),e=[];for(var n in t){for(var o=[],r=t[n],i=r.guards,a=d.WeaponSystem.instance.getAllCards()[r.id].status!=_.ICardStatus.Lock,s="cardGroup_"+n,c=g.ConfigManager.instance.getLanConfig(s),l=0;l<i.length;l++){var u=i[l],p=g.ConfigManager.instance.getGuardConfig(u),f={id:i[l],isUnlock:a,quality:p.quality,view:this};o.push(f)}e.push({title:c,data:o})}return e},e.prototype._handleEnemyData=function(){var t=g.ConfigManager.instance.getConfig("Enemy"),e=h.BattleSystem.instance.getEnemysInfo(),n=[],o=[];for(var r in t){var i={id:+r,isUnlock:e[t[r].id].status!=y.IEnemyStatus.Lock,view:this};o.push(i)}return n.push({data:o}),n},e.prototype.onTab=function(t,e){var n,o,r,i;if(this._curTabType!=e){this._curTabType=e;try{for(var a=c(this._viewNodeMap),s=a.next();!s.done;s=a.next()){var u=l(s.value,2),p=u[0];(d=u[1]).active=p==e}}catch(v){n={error:v}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}try{for(var f=c(this._btnNodeMap),h=f.next();!h.done;h=f.next()){var d,y=l(h.value,2),_=(p=y[0],(d=y[1]).getChildByName("off")),g=d.getChildByName("on");g.active=p==e,_.active=!g.active}}catch(m){r={error:m}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}},e.prototype._closeTableViews=function(){this.guardView.clear(),this.enemyView.clear()},e.prototype.onClose=function(){this._closeTableViews(),b.default.instance.popView(this)},i([M(cc.Label)],e.prototype,"labelBtnGuard",void 0),i([M(cc.Label)],e.prototype,"labelNoEnemyInfo",void 0),i([M(cc.Label)],e.prototype,"labelBtnEnemy",void 0),i([M(f.default)],e.prototype,"enemyView",void 0),i([M(f.default)],e.prototype,"guardView",void 0),i([M(cc.Node)],e.prototype,"btnEnemyNode",void 0),i([M(cc.Node)],e.prototype,"btnGuardNode",void 0),i([M(cc.Node)],e.prototype,"guardRoot",void 0),i([M(cc.Node)],e.prototype,"enemyRoot",void 0),i([M(cc.Label)],e.prototype,"labelName",void 0),i([M(cc.Label)],e.prototype,"labelGuardName",void 0),i([M(cc.Label)],e.prototype,"labelGuardContent",void 0),i([M(cc.Node)],e.prototype,"enemyInfoNode",void 0),i([M(cc.Label)],e.prototype,"labelEnemyName",void 0),i([M(cc.Label)],e.prototype,"labelEnemyContent",void 0),i([M(cc.Label)],e.prototype,"labelAbility",void 0),i([M(cc.Label)],e.prototype,"labelAbilityDesc",void 0),i([M(cc.Sprite)],e.prototype,"lightBg",void 0),i([M(cc.Label)],e.prototype,"labelCd",void 0),i([M(cc.Label)],e.prototype,"labelAttack",void 0),i([M(cc.Label)],e.prototype,"labelAttackRange",void 0),i([M(cc.Label)],e.prototype,"labelAttackSpeed",void 0),i([M(cc.Label)],e.prototype,"labelMoveSpeed",void 0),i([M(cc.Label)],e.prototype,"labelCrit",void 0),i([M(cc.Label)],e.prototype,"labelCritDamage",void 0),i([M(cc.Label)],e.prototype,"labelType",void 0),i([A],e)}(m.default);n.default=P,cc._RF.pop()},{"../../Component/Utils/TableView/TableView":"TableView","../../Gameplay/System/BattleSystem":"BattleSystem","../../Gameplay/System/WeaponSystem":"WeaponSystem","../../Interface/SaveData/BattleData":"BattleData","../../Interface/SaveData/WeaponData":"WeaponData","../../Module/ConfigManager":"ConfigManager","../../Module/Loader":"Loader","../../Module/ViewHandler":"ViewHandler","../../Module/ViewModule":"ViewModule","../../Utils/Path":"Path","../../Utils/Utils":"Utils"}],Heap:[function(t,e,n){"use strict";cc._RF.push(e,"efb3fqYA8lIeaNfwiz2Umgc","Heap"),Object.defineProperty(n,"__esModule",{value:!0}),n.Heap=n.MaxNumberComparer=n.minNumberCompare=void 0,n.minNumberCompare=function(t,e){return t-e},n.MaxNumberComparer=function(t,e){return e-t};var o=function(){function t(t){this.items=[],this.itemToIndexMap=new Map,this.innerCompare=t}return t.prototype.peek=function(){return this.items[0]},t.prototype.add=function(t){if(this.itemToIndexMap.has(t))throw new Error("Connot add an item that is already in the heap.");this.items.push(t),this.itemToIndexMap.set(t,this.items.length-1),this.bubbleUpToPlace(this.items.length-1)},t.prototype.pop=function(){if(!this.isEmpty){var t=this.items[0];return this.removeAt(0),t}},Object.defineProperty(t.prototype,"size",{get:function(){return this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),t.prototype.remove=function(t){var e=this.itemToIndexMap.get(t);return void 0!==e&&(this.removeAt(e),!0)},t.prototype.clear=function(){this.items.length=0,this.itemToIndexMap.clear()},t.prototype.contains=function(t){return this.itemToIndexMap.has(t)},t.prototype[Symbol.iterator]=function(){return this.items[Symbol.iterator]()},t.prototype.compare=function(t,e){var n=this.innerCompare(t,e);if("number"!=typeof n)throw new Error("The typeof compare result cannot be different from number: "+n);if(isNaN(n))throw new Error("Compare result cannot be is NaN.");return n},t.prototype.removeAt=function(t){if(1!==this.items.length){if(t===this.items.length-1)return this.itemToIndexMap.delete(this.items[this.items.length-1]),void(this.items.length=this.items.length-1);var e=this.items[t];this.itemToIndexMap.delete(e),this.items[t]=this.items[this.items.length-1],this.items.splice(this.items.length-1,1),this.itemToIndexMap.set(this.items[t],t);var n=this.compare(this.items[t],e);n<0?this.bubbleUpToPlace(t):n>0&&this.bubbleDownToPlace(t)}else this.clear()},t.prototype.getLeftChildIndex=function(t){return 2*t+1},t.prototype.getParentIndex=function(t){return Math.floor((t-1)/2)},t.prototype.getSmallerChildIndex=function(t,e){return e>=this.items.length?t>=this.items.length?void 0:t:t>=this.items.length?e:this.compare(this.items[t],this.items[e])<=0?t:e},t.prototype.bubbleUpToPlace=function(t){if(0!==t)for(var e=this.items[t];;){var n=this.getParentIndex(t),o=this.items[n];if(this.compare(o,e)<=0)break;if(this.swap(t,n,e,o),0===n)break;t=n}},t.prototype.bubbleDownToPlace=function(t){for(var e=this.getLeftChildIndex(t),n=this.getSmallerChildIndex(e,e+1);void 0!==n;){var o=this.items[t],r=this.items[n];if(this.compare(o,r)<0)break;this.swap(t,n,o,r),t=n,e=this.getLeftChildIndex(t),n=this.getSmallerChildIndex(e,e+1)}},t.prototype.swap=function(t,e,n,o){n=n||this.items[t],o=o||this.items[e];var r=n;this.items[t]=o,this.items[e]=r,this.itemToIndexMap.set(n,e),this.itemToIndexMap.set(o,t)},t}();n.Heap=o,cc._RF.pop()},{}],HomeBottomUI:[function(t,e,n){"use strict";cc._RF.push(e,"03f57kPT25KVoVziCPgRWkh","HomeBottomUI");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.BottomTabType=void 0;var p,f=t("../Enum/ItemType"),h=u(t("../Gameplay/GameDefine")),d=t("../Gameplay/System/BagSystem"),y=t("../Gameplay/System/HomeSystem"),_=t("../Gameplay/System/WeaponSystem"),g=t("../Interface/SaveData/WeaponData"),v=u(t("../Module/Loader")),m=u(t("../Module/ViewModule")),b=t("../Utils/NodePool"),w=u(t("../Utils/Path")),S=u(t("../Utils/Utils")),C=t("./Bag/BagView"),A=cc._decorator,M=A.ccclass,P=A.property;(function(t){t[t.Lineup=1]="Lineup",t[t.Bag=2]="Bag",t[t.Main=3]="Main",t[t.Shop=4]="Shop",t[t.More=5]="More"})(p=n.BottomTabType||(n.BottomTabType={}));var E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.slotRoot=null,e.btnNodes=null,e.other=null,e.autoAttackToggle=null,e.labelAutoAttack=null,e.labelEnergy=null,e.labelCoin=null,e.labelHeroSoul=null,e.labelLevel=null,e.labelUserName=null,e.labelLineup=null,e.labelShop=null,e.labelMore=null,e.labelMain=null,e.labelBag=null,e._slots=null,e._slotMap=new Map,e._autoAttack=!1,e._btnNodeMap=new Map,e._floatNodeReady=!1,e._gap=h.default.CreateGuardGap,e._canCreateGuard=!1,e}return r(e,t),e.prototype.update=function(t){this._autoAttack&&this.onSummon(),this._gap-=t,this._gap<=0&&(this._gap=h.default.CreateGuardGap,this._canCreateGuard||(this._canCreateGuard=!0))},e.prototype.init=function(){var t=this;_.WeaponSystem.instance.targetOff(this),_.WeaponSystem.instance.on(_.WeaponSystem.Events.UpdateSlot,function(){t.initSlots()},this),y.HomeSystem.instance.targetOff(this),y.HomeSystem.instance.on(y.HomeSystem.Events.OnAutoAttack,function(e){t._autoAttack=e,t.checkAutoAttack()},this),d.BagSystem.instance.targetOff(this),d.BagSystem.instance.on(d.BagSystem.Events.GemChanged,function(){t.initSlots()},this),d.BagSystem.instance.on(d.BagSystem.Events.ItemChanged,function(e,n,o){e==f.ItemType.Energy?t.labelEnergy.string=o:e==f.ItemType.Coin?t.labelCoin.string=o:e==f.ItemType.HeroSoul&&(t.labelHeroSoul.string=o),t.showFloatLabel(e,n,o)},this),this.initFloatLabelNode(),this.initSlots(),this.initBtnNodes(),this.initMoneyNode(),this.checkAutoAttack(),this.initUserInfo(),this.initStr()},e.prototype.initStr=function(){S.default.localize(this.labelBag,"ui_bag"),S.default.localize(this.labelMain,"ui_main"),S.default.localize(this.labelMore,"ui_more"),S.default.localize(this.labelLineup,"ui_lineup"),S.default.localize(this.labelShop,"ui_shop"),S.default.localize(this.labelAutoAttack,"ui_autoAttack");var t=y.HomeSystem.instance.getCurStage();this.labelLevel.string=""+t},e.prototype.initFloatLabelNode=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return t=w.default.getPrefabByName("FloatNode"),[4,v.default.loadResAsync(t,cc.Prefab,null)];case 1:return e=n.sent(),b.NodePool.instance.tryCreatePool(t,e),this._floatNodeReady=!0,[2]}})})},e.prototype.showFloatLabel=function(t,e,n){if(this._floatNodeReady){var o=b.NodePool.instance.getNode(w.default.getPrefabByName("FloatNode")),r=null,i=null;if(t==f.ItemType.Coin?(i=this.labelCoin,r=this.labelCoin.node):t==f.ItemType.HeroSoul?(i=this.labelHeroSoul,r=this.labelHeroSoul.node):t==f.ItemType.Energy&&(i=this.labelEnergy,r=this.labelEnergy.node),r){o.parent=r.parent,o.setPosition(r.getPosition());var a=e>0?"+":"-";o.getChildByName("labelFloat").getComponent(cc.Label).string=a+Math.abs(e),cc.tween(o).by(.5,{y:50}).call(function(){b.NodePool.instance.putNode(o),i.string=""+n}).start()}}},e.prototype.initUserInfo=function(){this.labelUserName.string="\u65e0\u540d\u6c0f"},e.prototype.initBtnNodes=function(){for(var t=this.btnNodes.children.length,e=0;e<t;e++)this._btnNodeMap.set(e+1,this.btnNodes.children[e]);this.changeOnOff(p.Main)},e.prototype.initMoneyNode=function(){var t=d.BagSystem.instance.getItemCount(2);this.labelEnergy.string=""+t;var e=d.BagSystem.instance.getItemCount(f.ItemType.Coin),n=d.BagSystem.instance.getItemCount(f.ItemType.HeroSoul);this.labelCoin.string=""+e,this.labelHeroSoul.string=""+n},e.prototype.updateToggle=function(){this._autoAttack?this.autoAttackToggle.check():this.autoAttackToggle.uncheck()},e.prototype.onAutoAttackToggle=function(){var t=this.autoAttackToggle.isChecked;y.HomeSystem.instance.setAutoAttack(t)},e.prototype.checkAutoAttack=function(){this._autoAttack=y.HomeSystem.instance.isAutoAttack(),this.updateToggle()},e.prototype.initSlots=function(){var t=this,e=_.WeaponSystem.instance.getSlots(),n=function(n){var r=e[n],i="slot"+r.index,a=o.slotRoot.getChildByName(i);a.getChildByName("img_lock").active=r.status==g.ISlotStatus.Lock;var s=a.getChildByName("checked");if(s.active=!1,r.gem){s.active=!0;var c=a.getChildByName("light").getComponent(cc.Sprite),l=w.default.getItemLightPath(r.gem.quality);S.default.loadImg(c,l,110);var u=a.getComponent(cc.Button);u.node.targetOff(o),u.node.on("click",function(){t.onShowGemProp(r.index)},o)}o._slotMap.set(r.index,a)},o=this;for(var r in e)n(r);for(var r in this._slots=_.WeaponSystem.instance.getSlots(),this._slots){var i=this._slots[r];i.gem&&this.onUpdateSlotView(i)}},e.prototype.onUpdateSlotView=function(t){if(!(t.index>_.WeaponSystem.instance.getWeaponSlotNum())){var e=t.index,n=this._slotMap.get(e);if(t.gem){var o=n.getChildByName("img").getComponent(cc.Sprite),r=w.default.getGemPath(t.gem.id);S.default.loadImg(o,r,40);var i=n.getChildByName("light").getComponent(cc.Sprite),a=w.default.getItemLightPath(t.gem.quality);S.default.loadImg(i,a,110),n.getChildByName("checked").active=!0}}},e.prototype.onShowGemProp=function(t){var e=_.WeaponSystem.instance.getSlotByIndex(t);e.status!=g.ISlotStatus.Lock?e.gem?m.default.instance.pushView("GemPropView",e):m.default.instance.toast("toast_noGem"):m.default.instance.toast("toast_lock")},e.prototype.changeOnOff=function(t){var e,n;try{for(var o=c(this._btnNodeMap),r=o.next();!r.done;r=o.next()){var i=l(r.value,2),a=i[0],s=i[1],u=s.getChildByName("btn_off"),p=s.getChildByName("btn_on");p.active=a==t,u.active=!p.active}}catch(f){e={error:f}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},e.prototype.onLineup=function(){this.other.active=!1,this.changeOnOff(p.Lineup),m.default.instance.pushView("LineupView",null,{onLoaded:this.switchFullScreenView.bind(this)})},e.prototype.onBag=function(){this.other.active=!1,this.changeOnOff(p.Bag),m.default.instance.pushView("BagView",C.BagTabType.Gem,{onLoaded:this.switchFullScreenView.bind(this)})},e.prototype.onShop=function(){this.other.active=!1,this.changeOnOff(p.Shop),m.default.instance.pushView("ShopView",null,{onLoaded:this.switchFullScreenView.bind(this)})},e.prototype.onMore=function(){this.other.active=!1,this.changeOnOff(p.More),m.default.instance.pushView("SettingView",null,{onLoaded:this.switchFullScreenView.bind(this)})},e.prototype.onMain=function(){this.other.active=!0,this.changeOnOff(p.Main),this.switchFullScreenView(null)},e.prototype.switchFullScreenView=function(t){this._fullScreenView!==t&&(this._fullScreenView&&(this._fullScreenView.close(),this._fullScreenView=null),this._fullScreenView=t)},e.prototype.onSummon=function(){if(this._canCreateGuard)return this._canCreateGuard=!1,d.BagSystem.instance.isGemCapacityEnough(1)?d.BagSystem.instance.getItemCount(f.ItemType.Energy)<=0?(m.default.instance.toast("warn_noEnergy"),void y.HomeSystem.instance.setAutoAttack(!1)):void(y.HomeSystem.instance.isHomeWorldLoaded()&&(d.BagSystem.instance.addItemCount(f.ItemType.Energy,-1),y.HomeSystem.instance.createGuard())):(m.default.instance.toast("warn_noCapacity"),void y.HomeSystem.instance.setAutoAttack(!1))},i([P(cc.Node)],e.prototype,"slotRoot",void 0),i([P(cc.Node)],e.prototype,"btnNodes",void 0),i([P(cc.Node)],e.prototype,"other",void 0),i([P(cc.Toggle)],e.prototype,"autoAttackToggle",void 0),i([P(cc.Label)],e.prototype,"labelAutoAttack",void 0),i([P(cc.Label)],e.prototype,"labelEnergy",void 0),i([P(cc.Label)],e.prototype,"labelCoin",void 0),i([P(cc.Label)],e.prototype,"labelHeroSoul",void 0),i([P(cc.Label)],e.prototype,"labelLevel",void 0),i([P(cc.Label)],e.prototype,"labelUserName",void 0),i([P(cc.Label)],e.prototype,"labelLineup",void 0),i([P(cc.Label)],e.prototype,"labelShop",void 0),i([P(cc.Label)],e.prototype,"labelMore",void 0),i([P(cc.Label)],e.prototype,"labelMain",void 0),i([P(cc.Label)],e.prototype,"labelBag",void 0),i([M],e)}(cc.Component);n.default=E,cc._RF.pop()},{"../Enum/ItemType":"ItemType","../Gameplay/GameDefine":"GameDefine","../Gameplay/System/BagSystem":"BagSystem","../Gameplay/System/HomeSystem":"HomeSystem","../Gameplay/System/WeaponSystem":"WeaponSystem","../Interface/SaveData/WeaponData":"WeaponData","../Module/Loader":"Loader","../Module/ViewModule":"ViewModule","../Utils/NodePool":"NodePool","../Utils/Path":"Path","../Utils/Utils":"Utils","./Bag/BagView":"BagView"}],HomeData:[function(t,e,n){"use strict";cc._RF.push(e,"1b9dclumqdNK7LplPoMAXNh","HomeData"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],HomeSystem:[function(t,e,n){"use strict";cc._RF.push(e,"3f6082YpvFLh6n48Ls7vxH1","HomeSystem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.HomeSystem=void 0;var c=t("../../Enum/ItemType"),l=s(t("../../Module/Audio")),u=t("../../Module/ConfigManager"),p=s(t("../../Module/Database/Db")),f=s(t("../../Utils/Path")),h=s(t("../../Utils/Utils")),d=s(t("../GameDefine")),y=t("./BagSystem"),_=t("./Common/DataSaver"),g={OnSummon:"OnSummon",OnSummonEnd:"OnSummonEnd",OnAutoAttack:"OnAutoAttack",OnStageUp:"OnStageUp",onHurt:"onHurt"},v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="HomeSystem",e._saver=new _.DataSaver,e._config=null,e._homeWorld=null,e}return r(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.init=function(){return i(this,void 0,void 0,function(){var t,n;return a(this,function(){return this._data=p.default.instance.getData("home"),this._data?(n=e.instance.getCurStage(),this._config=u.ConfigManager.instance.getStageConfig(n)):(this._config=u.ConfigManager.instance.getStageConfig(1),t=this._config.stageHp,this._data={version:1,magic:1,curStage:1,leftHp:t,autoAttack:!1,music:!0,effect:!0},this.setDirty()),this._saver.init("home",this._data),this._initMusicAndEffect(),this.setAutoAttack(!1),[2]})})},e.prototype.onHomeWorldLoaded=function(t){this._homeWorld=t},e.prototype.isHomeWorldLoaded=function(){return null!=this._homeWorld},e.prototype.setDirty=function(){this._saver.setDirty()},e.prototype.destroy=function(){this._saver.save()},e.prototype.createGuard=function(t){var e=this;if(this._homeWorld){var n=h.default.randomRangeInt(1,10),o=h.default.randomRangeInt(1,3);this.emit(g.OnSummon,{guardId:n,heroSoul:o}),this._homeWorld.showGuardAttackAnim(n,function(){y.BagSystem.instance.addItemCount(c.ItemType.HeroSoul,o),e.emit(g.OnSummonEnd),t&&t()})}},e.prototype._initMusicAndEffect=function(){var t=this._data.music?1:0,e=this._data.effect?1:0;l.default.instance.setMusicVolume(t),l.default.instance.setEffectsVolume(e),this.playBgm(d.default.StartBGM)},e.prototype.playBgm=function(t){var e=f.default.soundPath(t);l.default.instance.stopMusic(),l.default.instance.playMusic(e)},e.prototype.logicUpdate=function(){},e.prototype.getLeftHp=function(){return this._data.leftHp},e.prototype.getCurStage=function(){return this._data.curStage},e.prototype.onHurt=function(t){this._data.leftHp>0&&(this._data.leftHp-=t,this._data.leftHp=Math.max(0,this._data.leftHp),this.emit(g.onHurt),this._data.leftHp<=0&&(this._data.leftHp=d.default.StageHp,this._data.curStage+=1,this.emit(g.OnStageUp)),this.setDirty())},e.prototype.isAutoAttack=function(){return this._data.autoAttack},e.prototype.setAutoAttack=function(t){this._data.autoAttack=t,this.setDirty(),this.emit(g.OnAutoAttack,this._data.autoAttack)},e.prototype.getMusic=function(){return this._data.music},e.prototype.getEffect=function(){return this._data.effect},e.prototype.startMusic=function(){this._data.music=!0,this.setDirty(),l.default.instance.setMusicVolume(1)},e.prototype.stopMusic=function(){this._data.music=!1,this.setDirty(),l.default.instance.setMusicVolume(0)},e.prototype.startEffect=function(){this._data.effect=!0,this.setDirty(),l.default.instance.setEffectsVolume(1)},e.prototype.stopEffect=function(){this._data.effect=!1,this.setDirty(),l.default.instance.setEffectsVolume(0)},e._instance=null,e.Events=g,e}(cc.EventTarget);n.HomeSystem=v,cc._RF.pop()},{"../../Enum/ItemType":"ItemType","../../Module/Audio":"Audio","../../Module/ConfigManager":"ConfigManager","../../Module/Database/Db":"Db","../../Utils/Path":"Path","../../Utils/Utils":"Utils","../GameDefine":"GameDefine","./BagSystem":"BagSystem","./Common/DataSaver":"DataSaver"}],HomeTopUI:[function(t,e,n){"use strict";cc._RF.push(e,"555325+IkJKq6oXJDcFg/Jv","HomeTopUI");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._showChatNode=!1,e._chatNodeOutOrIn=!1,e}return r(e,t),e.prototype.init=function(){},e.prototype.onShowChatNode=function(){},i([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],HomeWorld:[function(t,e,n){"use strict";cc._RF.push(e,"55eb9DE7U9MUa1a/1erpYZE","HomeWorld");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../../Enum/ItemType"),u=c(t("../../Enum/ViewType")),p=c(t("../../Gameplay/GameDefine")),f=t("../../Gameplay/System/BagSystem"),h=t("../../Gameplay/System/BattleSystem"),d=t("../../Gameplay/System/HomeSystem"),y=c(t("../../Module/Loader")),_=c(t("../../Module/ViewHandler")),g=c(t("../../Module/ViewModule")),v=c(t("../../Utils/Path")),m=c(t("../../Utils/Utils")),b=cc._decorator,w=b.ccclass,S=b.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewType=u.default.World,e.stagePrefab=null,e.stageRoot=null,e.labelStart=null,e.labelHp=null,e.labelCurStage=null,e.btnNode=null,e._stageNode=null,e.stage=null,e}return r(e,t),e.prototype.initiateView=function(){var t=this;m.default.localize(this.labelStart,"ui_start"),this.labelCurStage.string=""+d.HomeSystem.instance.getCurStage(),this.labelHp.string=""+d.HomeSystem.instance.getLeftHp(),this.btnNode.targetOff(this),this.btnNode.on("click",this.onStart,this),d.HomeSystem.instance.targetOff(this),d.HomeSystem.instance.on(d.HomeSystem.Events.OnStageUp,function(){t.labelCurStage.string=""+d.HomeSystem.instance.getCurStage()},this),d.HomeSystem.instance.on(d.HomeSystem.Events.onHurt,function(){t.labelHp.string=""+d.HomeSystem.instance.getLeftHp()},this),this._stageNode=this.stageRoot.getChildByName("infinity")},e.prototype.onStart=function(){if(f.BagSystem.instance.isItemEnough(l.ItemType.Energy,p.default.CostEnergyToBattle)){var t=h.BattleSystem.instance.getCurrentLevel();h.BattleSystem.instance.startBattle(t)}else g.default.instance.toast("warn_noEnergy")},e.prototype.showGuardAttackAnim=function(t,e){return a(this,void 0,void 0,function(){var n,o,r,i,a,c,l,u,p,f,h,d,_,g;return s(this,function(s){switch(s.label){case 0:return n=v.default.getEntityPath("Guards/Guard_"+t),[4,y.default.loadResAsync(n,cc.Prefab,null)];case 1:return o=s.sent(),(r=cc.instantiate(o)).parent=this.stageRoot,i=this._stageNode.getPosition(),a=this.stageRoot.getChildByName("rect"),c=m.default.randomRange(-1,1),l={x:a.x+a.width*c,y:a.y},u=200*Math.random()+100,h=Math.random()>.5,p=h?i.x+u:i.x-u,f=i.y-u,r.setPosition(p,f),(d=r.getChildByName("img").getComponent(cc.Animation)).play("guard_"+t+"_walk"),_=Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2)),g=_/100,p>0&&(r.scaleX*=-1),cc.tween(r).to(g,{x:l.x,y:l.y}).call(function(){m.default.playAnim(d,"guard_"+t+"_attack",3,function(){cc.tween(r).to(.5,{opacity:0}).call(function(){r.removeFromParent(),r.destroy(),e&&e()}).start()},.5)}).start(),[2]}})})},i([S(cc.Prefab)],e.prototype,"stagePrefab",void 0),i([S(cc.Node)],e.prototype,"stageRoot",void 0),i([S(cc.Label)],e.prototype,"labelStart",void 0),i([S(cc.Label)],e.prototype,"labelHp",void 0),i([S(cc.Label)],e.prototype,"labelCurStage",void 0),i([S(cc.Node)],e.prototype,"btnNode",void 0),i([w],e)}(_.default);n.default=C,cc._RF.pop()},{"../../Enum/ItemType":"ItemType","../../Enum/ViewType":"ViewType","../../Gameplay/GameDefine":"GameDefine","../../Gameplay/System/BagSystem":"BagSystem","../../Gameplay/System/BattleSystem":"BattleSystem","../../Gameplay/System/HomeSystem":"HomeSystem","../../Module/Loader":"Loader","../../Module/ViewHandler":"ViewHandler","../../Module/ViewModule":"ViewModule","../../Utils/Path":"Path","../../Utils/Utils":"Utils"}],Http:[function(t,e,n){"use strict";cc._RF.push(e,"9ccbf30CZtJfo+VNnocKbC9","Http"),Object.defineProperty(n,"__esModule",{value:!0}),n.httpReq=void 0,n.httpReq=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState&&n.status>=200&&n.status<300){var t=void 0;try{t=JSON.parse(n.responseText)}catch(o){return void(e&&e("wrong json",null))}e&&e(null,t)}},n.open(t.method||"POST",t.url,!0),n.send(JSON.stringify(t.msg||null)),n.addEventListener("error",function(t){e&&e(t,null)})},cc._RF.pop()},{}],IBaseData:[function(t,e,n){"use strict";cc._RF.push(e,"22057+z7bdKGI+ID4U/spoA","IBaseData"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],IBattleContext:[function(t,e,n){"use strict";cc._RF.push(e,"f5498sN/utKFJ0deWwxqdxq","IBattleContext"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],IDGenerator:[function(t,e,n){"use strict";cc._RF.push(e,"a7d2bS2du5C86PRtr1aeBMD","IDGenerator"),Object.defineProperty(n,"__esModule",{value:!0});var o=".",r=function(){function t(t){this._id=0,this._prefix=null,this._id=0,this._prefix=t?t+o:""}return t.prototype.getNewId=function(){return this._prefix+ ++this._id},t}();n.default=r,cc._RF.pop()},{}],IEntityContext:[function(t,e,n){"use strict";cc._RF.push(e,"1c116wEEDxLQZUUOXZQ9CIt","IEntityContext"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],ISerializable:[function(t,e,n){"use strict";cc._RF.push(e,"364937qCqpAO6iJy+u6OqM1","ISerializable"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],ISystem:[function(t,e,n){"use strict";cc._RF.push(e,"9c233bin2tHr6HSs6zSCFrr","ISystem"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],ItemType:[function(t,e,n){"use strict";cc._RF.push(e,"5bf2eyYms9KZ7ysHTr1uDEn","ItemType"),Object.defineProperty(n,"__esModule",{value:!0}),n.ItemType=void 0,function(t){t[t.Coin=1]="Coin",t[t.Energy=2]="Energy",t[t.HeroSoul=3]="HeroSoul"}(n.ItemType||(n.ItemType={})),cc._RF.pop()},{}],LanConfig:[function(t,e,n){"use strict";cc._RF.push(e,"a1242FlPRZOcK06+6zZfsK/","LanConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.LanType=void 0,function(t){t.cn="cn",t.tw="tw",t.en="en"}(n.LanType||(n.LanType={})),cc._RF.pop()},{}],LevelConfig:[function(t,e,n){"use strict";cc._RF.push(e,"170e4OMJIZNFbhep3LIbOt5","LevelConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.FormationType=void 0,function(t){t.Rect="Rect",t.Line="Line",t.Tri="Tri"}(n.FormationType||(n.FormationType={})),cc._RF.pop()},{}],LineupCardItem:[function(t,e,n){"use strict";cc._RF.push(e,"33907k2MRxCFJ4AC3aHFgZw","LineupCardItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Component/Utils/TableView/TableViewItem")),c=t("../../Gameplay/System/WeaponSystem"),l=a(t("../../Module/ViewModule")),u=cc._decorator,p=u.ccclass,f=u.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.img=null,e.focus=null,e.tagNode=null,e._lineupView=null,e._data=null,e}return r(e,t),e.prototype.init=function(t,e){var n=this;this._lineupView=e,this._data=t,this._view=this._data.view,this.tagNode.active=this._data.isEquipt,c.WeaponSystem.instance.targetOff(this),c.WeaponSystem.instance.on(c.WeaponSystem.Events.SelectCardGroup,function(t){n.onHighlight(n._data.id==t)},this),c.WeaponSystem.instance.on(c.WeaponSystem.Events.RemoveCardGroupFromLineup,function(t){n.updateTagStr(t)},this),c.WeaponSystem.instance.on(c.WeaponSystem.Events.AddCardGroupToLineup,function(t){n.updateTagStr(t)}),this.onHighlight(!1)},e.prototype.updateTagStr=function(t){c.WeaponSystem.instance.getAllLineups()[t].includes(this._data.id)?this.tagNode.active=!0:this.tagNode.active=!1},e.prototype.onSelect=function(){this._data.isUnlock?this._view.onChangeSelectId(this._data.id):l.default.instance.toast("toast_unlock")},e.prototype.onHighlight=function(t){this.focus.active=t},i([f(cc.Sprite)],e.prototype,"img",void 0),i([f(cc.Node)],e.prototype,"focus",void 0),i([f(cc.Node)],e.prototype,"tagNode",void 0),i([p],e)}(s.default);n.default=h,cc._RF.pop()},{"../../Component/Utils/TableView/TableViewItem":"TableViewItem","../../Gameplay/System/WeaponSystem":"WeaponSystem","../../Module/ViewModule":"ViewModule"}],LineupView:[function(t,e,n){"use strict";cc._RF.push(e,"55ed4QUeUJGgqdlar16US9C","LineupView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var p=u(t("../../Component/Utils/TableView/TableView")),f=t("../../Gameplay/System/WeaponSystem"),h=t("../../Interface/SaveData/WeaponData"),d=t("../../Module/ConfigManager"),y=u(t("../../Module/ViewHandler")),_=u(t("../../Module/ViewModule")),g=u(t("../../Utils/Utils")),v=u(t("lodash")),m=u(t("../../Gameplay/GameDefine")),b=u(t("../../Module/Loader")),w=u(t("../../Utils/Path")),S=u(t("../../Enum/ViewType")),C=cc._decorator,A=C.ccclass,M=C.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewType=S.default.BaseView,e.cardGroupView=null,e.lineupRoot=null,e.topBtns=null,e.lineupCardItem=null,e.labelNothing=null,e.labelEquipt=null,e._selectGroupIndex=null,e._selectLineupIndex=null,e._btnMap=new Map,e}return r(e,t),e.prototype.initiateView=function(){this._selectLineupIndex=f.WeaponSystem.instance.getCurLineupIndex(),g.default.localize(this.labelNothing,"warn_noCardGroup"),g.default.localize(this.labelEquipt,"ui_equip"),this.cardGroupView.setLinesData(this._handleData()),this.initBtnMap(),this.initShowBox()},e.prototype.initBtnMap=function(){for(var t=this.topBtns.children,e=0;e<t.length;e++)this._btnMap.set(e+1,t[e]);var n=this._btnMap.get(this._selectLineupIndex),o=n.getChildByName("on"),r=n.getChildByName("off");o.active=!0,r.active=!o.active},e.prototype.initShowBox=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return this.lineupRoot.removeAllChildren(),this.labelNothing.node.active=!this._selectGroupIndex,this._selectGroupIndex?(t=d.ConfigManager.instance.getCardGroupConfig(this._selectGroupIndex),[4,b.default.loadPrefabAsync(w.default.getLineupPath(t.asset),null)]):[2];case 1:return e=n.sent(),cc.instantiate(e).parent=this.lineupRoot,[2]}})})},e.prototype.getSelectLineupIndex=function(){return this._selectLineupIndex},e.prototype.onChangeSelectId=function(t){this._selectGroupIndex=t,this.initShowBox(),f.WeaponSystem.instance.sendMessage(f.WeaponSystem.Events.SelectCardGroup,t)},e.prototype.onChangeLineup=function(t,e){var n,o;if(e!=this._selectLineupIndex){this._selectLineupIndex=e;try{for(var r=c(this._btnMap),i=r.next();!i.done;i=r.next()){var a=l(i.value,2),s=a[0],u=a[1],p=u.getChildByName("on"),f=u.getChildByName("off");p.active=s==e,f.active=!p.active}}catch(h){n={error:h}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}this.cardGroupView.clear(),this._selectGroupIndex=null,this.cardGroupView.setLinesData(this._handleData()),this.initShowBox()}},e.prototype.onEquipt=function(){if(this._selectGroupIndex){var t=f.WeaponSystem.instance.getAllLineups();t[this._selectLineupIndex].length>=m.default.MaxLineupCardNum?_.default.instance.toast("warn_maxCardNum"):t[this._selectLineupIndex].includes(this._selectGroupIndex)?_.default.instance.toast("warn_sameCard"):f.WeaponSystem.instance.updateLineup(this._selectLineupIndex,this._selectGroupIndex,f.UpdateLineup.add)}else _.default.instance.toast("warn_noCard")},e.prototype.onClose=function(){this._closeTableViews(),_.default.instance.popView(this)},e.prototype._closeTableViews=function(){this.cardGroupView.clear()},e.prototype._handleData=function(){var t=[],e=f.WeaponSystem.instance.getAllCards(),n=f.WeaponSystem.instance.getAllLineups()[this._selectLineupIndex],o=[];for(var r in e){var i=+r,a=d.ConfigManager.instance.getCardGroupConfig(i),s={id:+r,isUnlock:e[r].status!=h.ICardStatus.Lock,isEquipt:n.includes(i)?1:0,quality:a.quality,view:this};o.push(s)}return o=v.default.orderBy(o,["isEquipt","quality"],["desc","asc"]),t.push({data:o}),t},i([M(p.default)],e.prototype,"cardGroupView",void 0),i([M(cc.Node)],e.prototype,"lineupRoot",void 0),i([M(cc.Node)],e.prototype,"topBtns",void 0),i([M(cc.Prefab)],e.prototype,"lineupCardItem",void 0),i([M(cc.Label)],e.prototype,"labelNothing",void 0),i([M(cc.Label)],e.prototype,"labelEquipt",void 0),i([A],e)}(y.default);n.default=P,cc._RF.pop()},{"../../Component/Utils/TableView/TableView":"TableView","../../Enum/ViewType":"ViewType","../../Gameplay/GameDefine":"GameDefine","../../Gameplay/System/WeaponSystem":"WeaponSystem","../../Interface/SaveData/WeaponData":"WeaponData","../../Module/ConfigManager":"ConfigManager","../../Module/Loader":"Loader","../../Module/ViewHandler":"ViewHandler","../../Module/ViewModule":"ViewModule","../../Utils/Path":"Path","../../Utils/Utils":"Utils",lodash:13}],Loader:[function(t,e,n){"use strict";cc._RF.push(e,"dd1a6ygV1VBWpvlJhS4TLYY","Loader");var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var r=o(t("../Utils/Path")),i=o(t("./AutoRelease")),a=function(){function t(){}return t.loadPrefab=function(t,e,n){this.loadRes(t,cc.Prefab,e,n)},t.loadPrefabAsync=function(t,e){return this.loadResAsync(t,cc.Prefab,e)},t.loadRes=function(e,n,o,r){var i=t._parseParams(e),a=i.bundleName,s=i.resPath;t.loadBundle(a,function(t){function i(t){r&&!cc.isValid(r,!0)||o&&o(t)}t.load(s,n,function(t,n){t&&console.warn("[Loader] loadRes failed, res: "+e.toString(),t),i(n)})})},t.loadResAsync=function(t,e,n){var o=this;return new Promise(function(r){o.loadRes(t,e,r,n)})},t.loadDir=function(t,e,n,o,r){this.loadBundle(t,function(i){r&&!cc.isValid(r,!0)||i.loadDir(e,n,function(n,i){n&&console.warn("[Loader] loadDir failed, bundleName: "+t+", dir: "+e,n),r&&!cc.isValid(r,!0)||o&&o(i)})})},t.loadDirAsync=function(t,e,n,o){var r=this;return new Promise(function(i){r.loadDir(t,e,n,i,o)})},t.loadBundle=function(e,n){var o;o=Array.isArray(e)?e:[e];var r=[];(function i(){if(o.length>0){var a=o.shift();t._loadBundle(a,function(t){r.push(t),i()})}else n&&(Array.isArray(e)?n(r):n(r[0]))})()},t._loadBundle=function(e,n){var o=t._loadQueue.find(function(t){return t.bundleName==e});o?n&&o.callbacks.push(n):t._loadQueue.push({bundleName:e,callbacks:n?[n]:[]}),t._handleQuery()},t._handleQuery=function(){if(!t._isLoading&&0!==t._loadQueue.length){t._isLoading=!0;var e=t._loadQueue.shift(),n=e.bundleName,o=e.callbacks,r=cc.assetManager.getBundle(n);r?(o.length&&o.forEach(function(t){return t(r)}),t._isLoading=!1,t._handleQuery()):cc.assetManager.loadBundle(n,null,function(e,r){e?console.warn("[Loader] loadBundle failed, bundle: "+n+", err: "+e):(o.length&&o.forEach(function(t){return t(r)}),t._isLoading=!1,t._handleQuery())})}},t._parseParams=function(t){var e,n;if(t instanceof Array)n=[],t.forEach(function(t){var o=r.default.parseBundleName(t);e=o.bundleName,n.push(o.path)});else{var o=r.default.parseBundleName(t);e=o.bundleName,n=o.path}return{bundleName:e,resPath:n}},t.instantiate=function(t){var e=cc.instantiate(t);return e.addComponent(i.default).init(t),e},t._loadQueue=[],t._isLoading=!1,t}();n.default=a,cc._RF.pop()},{"../Utils/Path":"Path","./AutoRelease":"AutoRelease"}],LoadingView:[function(t,e,n){"use strict";cc._RF.push(e,"58400skqeRIy52YWYBjQBME","LoadingView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Utils/Utils")),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelLoading=null,e._loadingQuene=null,e}var n;return r(e,t),n=e,e.show=function(t){return new Promise(function(e){cc.resources.load("View/LoadingView",cc.Prefab,function(o,r){if(t.isFinished())e(null);else{var i=cc.instantiate(r);i.parent=cc.Canvas.instance.node;var a=i.getComponent(n);a.init(t),e(a)}})})},e.prototype.init=function(t){this._loadingQuene=t,this._loadingQuene.onProgress=this.setProgress.bind(this),s.default.switchParent(this.node,null),cc.game.addPersistRootNode(this.node)},e.prototype.setProgress=function(t){this.labelLoading&&(this.labelLoading.string="Loading: "+t.toFixed(0)+"%")},e.prototype.finish=function(){var t=this;if(cc.isValid(this.node)){var e=cc.Camera.findCamera(this.node);s.default.switchParent(this.node,e.node),this.scheduleOnce(function(){cc.game.removePersistRootNode(t.node),t.node.destroy()})}},i([u(cc.Label)],e.prototype,"labelLoading",void 0),n=i([l],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../../Utils/Utils":"Utils"}],Loading:[function(t,e,n){"use strict";cc._RF.push(e,"5ddc0ovHztLN7miIStcX6pG","Loading"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t){this._progress=0,this._tweenObj={progress:0},this._tweenProgress=0,this._minLoadingSec=t}return Object.defineProperty(t.prototype,"progress",{get:function(){return this._progress},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tweenProgress",{get:function(){return this._tweenProgress},enumerable:!1,configurable:!0}),t.prototype.start=function(){var t;this._startTs=Date.now(),this._progress=0,this._tweenProgress=0,this._tweenObj.progress=0,this._tween=null,this._minEndTs=this._startTs+1e3*(null!==(t=this._minLoadingSec)&&void 0!==t?t:0),this._updateHandle=setInterval(this.update.bind(this),16)},t.prototype.stop=function(){this._updateHandle&&(clearInterval(this._updateHandle),this._updateHandle=null)},t.prototype.isFinished=function(){return this._tweenProgress>=100},t.prototype.update=function(){this._tweenObj.progress>this._tweenProgress&&(this._tweenProgress=this._tweenObj.progress,this.onProgress&&this.onProgress(this._tweenProgress),this._tweenProgress>=100&&(this.onComplete&&this.onComplete(),this.stop()))},t.prototype.addProgress=function(t){this.setProgress(this._progress+t)},t.prototype.setProgress=function(t){if(!(t<=this._progress)){this._progress=cc.misc.clampf(t,0,100),this._tween&&(this._tween.stop(),this._tween=null);var e=.5;if(t>=100){var n=Date.now();n+1e3*e<this._minEndTs&&(e=(this._minEndTs-n)/1e3)}else e=1;this._tween=cc.tween(this._tweenObj).to(e,{progress:this._progress}).start()}},t}();n.default=o,cc._RF.pop()},{}],LocalData:[function(t,e,n){"use strict";cc._RF.push(e,"fdb45odkdVHWZUqAslH71aA","LocalData"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],LocalStorage:[function(t,e,n){"use strict";cc._RF.push(e,"33a9eLsEDNAHqJCMlmnaZjF","LocalStorage");var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.LocalStorage=void 0;var r=o(t("../../Utils/Platform")),i=window.wx||window.qq||window.tt,a=function(){function t(){}return t.getItem=function(t){return r.default.isMiniGame()?i.getStorageSync(t):cc.sys.localStorage.getItem(t)},t.getItemAsync=function(t,e){if(!e)return new Promise(function(e){if(r.default.isMiniGame())i.getStorage({key:t,complete:function(t){e(null==t?void 0:t.data)}});else{var n=cc.sys.localStorage.getItem(t);e(n)}});this.getItemAsync(t).then(e)},t.setItem=function(t,e){r.default.isMiniGame()?i.setStorageSync(t,e):cc.sys.localStorage.setItem(t,e)},t.setItemAsync=function(t,e,n){if(!n)return new Promise(function(n){r.default.isMiniGame()?i.setStorage({key:t,data:e,success:function(){n(!0)},fail:function(){n(!1)}}):(cc.sys.localStorage.setItem(t,e),n(!0))});this.setItemAsync(t,e).then(n)},t.removeItem=function(t){this.setItem(t,"")},t}();n.LocalStorage=a,cc._RF.pop()},{"../../Utils/Platform":"Platform"}],MoveTest:[function(t,e,n){"use strict";cc._RF.push(e,"9be97b4JPBESLKmWAtXmZWK","MoveTest");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.offset=cc.v2(),e.duration=1,e}return r(e,t),e.prototype.start=function(){cc.tween(this.node).repeatForever(cc.tween(this.node).by(this.duration,{position:cc.v3(this.offset)}).by(this.duration,{position:cc.v3(this.offset.neg())})).start()},i([c(cc.Vec2)],e.prototype,"offset",void 0),i([c],e.prototype,"duration",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],NetTest:[function(t,e,n){"use strict";cc._RF.push(e,"c7450WF08ZEjo6qSKA47nA3","NetTest");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./CmdClient"),s=t("./Network"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.host="127.0.0.1",e.port=4001,e.infoLabel=null,e.pongLabel=null,e}return r(e,t),e.prototype.start=function(){s.Network.onOpen(this.svr_onOpen,this),s.Network.onClose(this.svr_onClose,this),this.connectSvr()},e.prototype.update=function(){s.Network.readMsg()},e.prototype.connectSvr=function(){this.infoLabel.string="\u8fde\u63a5\u670d\u52a1\u5668\u4e2d...",s.Network.connect(this.host,this.port)},e.prototype.svr_onOpen=function(){console.log("socket onopen"),this.infoLabel.string="\u670d\u52a1\u5668\u5df2\u8fde\u63a5",s.Network.addHandler(a.Cmd.connector_main_ping,this.svr_pingBack,this)},e.prototype.svr_onClose=function(){var t=this;console.log("socket onclose"),this.infoLabel.string="\u8fde\u63a5\u670d\u52a1\u5668\u4e2d...",this.scheduleOnce(function(){t.connectSvr()},2)},e.prototype.btn_ping=function(){s.Network.sendMsg(a.Cmd.connector_main_ping,{msg:"ping"})},e.prototype.svr_pingBack=function(t){this.pongLabel.string=t.msg,this.pongLabel.node.parent.active=!0},e.prototype.btn_yes=function(){this.pongLabel.node.parent.active=!1},i([u(cc.String)],e.prototype,"host",void 0),i([u(cc.Integer)],e.prototype,"port",void 0),i([u(cc.Label)],e.prototype,"infoLabel",void 0),i([u(cc.Label)],e.prototype,"pongLabel",void 0),i([l],e)}(cc.Component);n.default=p,cc._RF.pop()},{"./CmdClient":"CmdClient","./Network":"Network"}],Network:[function(t,e,n){"use strict";cc._RF.push(e,"23771/shQFIP4bXmqv8bs+P","Network");var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.Network=void 0;var r=null,i=[],a=null,s=null,c={},l={},u=[],p={open:"state_open",close:"state_close"},f={len:0,buffer:new Uint8Array(0)},h="",d=function(){function t(){}return t.connect=function(e,n){t.disconnect(!0),f.len=0,f.buffer=new Uint8Array(0),(r=new WebSocket("ws://"+e+":"+n)).binaryType="arraybuffer",r.onopen=function(){var t=v(JSON.stringify({md5:h})),e=1+t.length,n=new Uint8Array(5+t.length);n[0]=e>>24&255,n[1]=e>>16&255,n[2]=e>>8&255,n[3]=255&e,n[4]=2;for(var o=0;o<t.length;o++)n[o+5]=t[o];r.send(n.buffer)},r.onerror=function(){},r.onclose=function(){t.disconnect(!1),u.push({id:p.close,data:null})},r.onmessage=function(t){_(new Uint8Array(t.data))}},t.disconnect=function(t){void 0===t&&(t=!0),r&&(r.onopen=function(){},r.onerror=function(){},r.onclose=function(){},r.onmessage=function(){},r.close(),r=null,f.len=0,f.buffer=new Uint8Array(0),clearInterval(a),clearTimeout(s),s=null),t&&(u.length=0)},t.onOpen=function(t,e){c[p.open]=t.bind(e),l[p.open]=e},t.offOpen=function(){delete c[p.open],delete l[p.open]},t.onClose=function(t,e){c[p.close]=t.bind(e),l[p.close]=e},t.offClose=function(){delete c[p.close],delete l[p.close]},t.addHandler=function(t,e,n){c[t]=e.bind(n),l[t]=n},t.removeThisHandlers=function(t){for(var e in l)l[e]===t&&(delete l[e],delete c[e])},t.sendMsg=function(t,e){if(r&&1===r.readyState){var n=i.indexOf(t);if(-1!==n){void 0===e&&(e=null);var o=y(n,e);r.send(o.buffer)}else console.warn("cmd not exists:",t)}else console.warn("ws is null")},t.readMsg=function(){if(u.length>0){var t=u.shift();c[t.id]&&c[t.id](t.data)}},t}();function y(t,e){var n=v(JSON.stringify(e)),o=n.length+3,r=new Uint8Array(o+4),i=0;return r[i++]=o>>24&255,r[i++]=o>>16&255,r[i++]=o>>8&255,r[i++]=255&o,r[i++]=1,r[i++]=t>>8&255,r[i++]=255&t,b(r,7,n,0,n.length),r}function _(t){try{for(var e=0;e<t.length;){var n=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3];1===t[e+4]?u.push({id:i[t[e+5]<<8|t[e+6]],data:JSON.parse(m(t.subarray(e+7,e+4+n)))}):2===t[e+4]?(o=JSON.parse(m(t.subarray(e+5,e+4+n))),h=o.md5,o.route&&(i=o.route),o.heartbeat>0&&(a=setInterval(g,1e3*o.heartbeat)),u.push({id:p.open,data:null})):3===t[e+4]&&(clearTimeout(s),s=null),e+=n+4}}catch(r){console.log(r)}var o}function g(){var t=new Uint8Array(5);t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=3,r.send(t.buffer),null===s&&(s=setTimeout(function(){d.disconnect(!1),u.push({id:p.close,data:null})},5e3))}function v(t){var e,n,r=[];try{for(var i=o(t),a=i.next();!a.done;a=i.next()){var s=a.value.codePointAt(0);s<=127?r.push(s):s<=2047?r.push(192|s>>6,128|63&s):s<=65535?r.push(224|s>>12,128|(4032&s)>>6,128|63&s):r.push(240|s>>18,128|(258048&s)>>12,128|(4032&s)>>6,128|63&s)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return new Uint8Array(r)}function m(t){for(var e=[],n=0,o=0,r=t.length;n<r;)t[n]<128?(o=t[n],n+=1):t[n]<224?(o=((63&t[n])<<6)+(63&t[n+1]),n+=2):t[n]<240?(o=((15&t[n])<<12)+((63&t[n+1])<<6)+(63&t[n+2]),n+=3):(o=((7&t[n])<<18)+((63&t[n+1])<<12)+((63&t[n+2])<<6)+(63&t[n+3]),n+=4),e.push(o);return String.fromCodePoint.apply(null,e)}function b(t,e,n,o,r){for(var i=0;i<r;i++)t[e++]=n[o++]}n.Network=d,cc._RF.pop()},{}],NodePool:[function(t,e,n){"use strict";cc._RF.push(e,"48d9bHILP9LLaWfHDJ77uQQ","NodePool");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.NodePool=void 0;var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefabMap=new Map,e.templateMap=new Map,e.poolMap=new Map,e}var n;return r(e,t),n=e,e.getInstance=function(){return n._instance},Object.defineProperty(e,"instance",{get:function(){if(null==this._instance){var t=new cc.Node("NodePool");this._instance=t.addComponent(n)}return this._instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){n._instance=this},e.prototype.registerPrefab=function(t,e){e.addRef(),this.prefabMap.set(t,e)},e.prototype.register=function(t,e){this.templateMap.set(t,e)},e.prototype.onDestroy=function(){this.prefabMap.forEach(function(t){return t.decRef()}),this.prefabMap.clear(),this.templateMap.clear(),this.poolMap.forEach(function(t){return t.clear()}),this.poolMap.clear(),n._instance=null},e.recycle=function(t){n.getInstance().putNode(t)},e.genPool=function(t,e){var n=this.getInstance();return e&&n.register(t,cc.instantiate(e)),{get:function(){return n.getNode(t)},put:function(e){n.putNode(e,t)}}},e.prototype.tryCreatePool=function(t,e){var n=this.poolMap.get(t);return n||(n=new cc.NodePool,this.poolMap.set(t,n),this.registerPrefab(t,e)),n},e.prototype.getNode=function(t){var e=this.getPool(t),n=null==e?void 0:e.get(),o=this.prefabMap.get(t);if(o)n?(n.scaleX=o.data.scaleX,n.scaleY=o.data.scaleY,n.setContentSize(o.data.getContentSize())):(n=cc.instantiate(o)).__pool_name__=t;else{var r=this.templateMap.get(t);r&&(n?(n.scaleX=r.scaleX,n.scaleY=r.scaleY,n.setContentSize(r.getContentSize())):(n=cc.instantiate(r)).__pool_name__=t)}return n},e.prototype.putNode=function(t,e){if(e=e||t.__pool_name__){var n=this.getPool(e);n&&n.put(t)}else cc.warn("[NodePool] putNode, cannot find pool name on node: "+t)},e.prototype.getPool=function(t){return this.poolMap.get(t)},n=i([s],e)}(cc.Component));n.NodePool=c,cc._RF.pop()},{}],Path:[function(t,e,n){"use strict";cc._RF.push(e,"b72c1tsrSFLoreTYty+y1L2","Path");var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var r=o(t("../Gameplay/GameDefine")),i=o(t("./Platform")),a=function(){function t(){}return t.parseBundleName=function(e){var n=[t.START_BUNDLE,t.MAIN_BUNDLE,t.BATTLE_BUNDLE,t.AUDIO_BUNDLE,t.RESOURCE_BUNDLE];r.default.ShowDebugPad&&n.push(t.DEBUG_BUNDLE);for(var o=0;o<n.length;++o){var i=n[o],a=i+"/";if(e.startsWith(a))return{bundleName:i,path:e.slice(a.length)}}return{bundleName:t.MAIN_BUNDLE,path:e}},t.getBundlePath=function(t,e){var n=e+"/";return t.startsWith(n)||(t=n+t),t},t.getConfigPath=function(){return this.MAIN_BUNDLE_PREFIX+"Config/JsonCfg"},t.getLevelPath=function(t){return this.BATTLE_BUNDLE_PREFIX+"Level/"+t},t.getEntryBgPath=function(t){return"Res/Entry/entry_bg_"+t},t.getEntryRightBgPath=function(t){return"Res/Entry/entry_rightBg_"+t},t.getEntityPath=function(t){return this.BATTLE_BUNDLE_PREFIX+"Entity/"+t},t.getLineupPath=function(t){return"Prefabs/Lineup/"+t},t.getPlayerEntityPath=function(){return this.getEntityPath("Player/Player")},t.getAvatar=function(t){return this.BATTLE_BUNDLE_PREFIX+"Res/HeadImgs/"+t},t.getAbilityImgPath=function(t){return this.BATTLE_BUNDLE_PREFIX+"Res/AbilityImgs/ability_"+t},t.getItemPath=function(t){return"Res/Items/img_"+t},t.getGemPath=function(t){return"Res/Gem/gem_"+t},t.getGemResource=function(t){return"Res/Gem/slots/"+t},t.getHurtNodePath=function(){return this.BATTLE_BUNDLE_PREFIX+"Prefabs/HurtNode"},t.getSummonInfoNodePath=function(){return"Prefabs/SummonInfoNode"},t.getPrefabByName=function(t){return"Prefabs/"+t},t.getWeapon=function(t){return"Prefabs/Weapons/Weapon_"+t},t.getWeaponImg=function(t){return"Res/Weapon/weapon_"+t},t.getGuardQualityPath=function(t){return this.BATTLE_BUNDLE_PREFIX+"Res/BattleScene/Other/guardBg_"+t},t.getItemOutlinePath=function(t){return"Res/Items/outline_"+t},t.getItemLightPath=function(t){return"Res/Items/light_"+t},t.getTag=function(t){return"Res/Other/icon_"+t},t.getAdIconByPlatForm=function(){return i.default.isBytedance()?"GameTextures/UI/icon_dyAd":"GameTextures/UI/icon_watchAd"},t.guideClawPath=function(){},t.loadingScenePath=function(){return this.START_BUNDLE_PREFIX+"View/LoadingScene"},t.loadingBg=function(){return this.START_BUNDLE_PREFIX+"Prefab/loadingBg"},t.effectPath=function(t){return this.AUDIO_BUNDLE_PREFIX+"Effects/"+t},t.soundPath=function(t){return this.AUDIO_BUNDLE_PREFIX+"Bgm/bgm_"+t},t.viewPath=function(t){return"View/"+t},t.resourcesPath=function(t){return this.RESOURCE_BUNDLE+"/"+t},t.MAIN_BUNDLE="MainBundle",t.BATTLE_BUNDLE="BattleBundle",t.AUDIO_BUNDLE="AudioBundle",t.START_BUNDLE="StartBundle",t.DEBUG_BUNDLE="DebugBundle",t.RESOURCE_BUNDLE="resources",t.MAIN_BUNDLE_PREFIX=t.MAIN_BUNDLE+"/",t.BATTLE_BUNDLE_PREFIX=t.BATTLE_BUNDLE+"/",t.AUDIO_BUNDLE_PREFIX=t.AUDIO_BUNDLE+"/",t.START_BUNDLE_PREFIX=t.START_BUNDLE+"/",t.DEBUG_BUNDLE_PREFIX=t.DEBUG_BUNDLE+"/",t}();n.default=a,cc._RF.pop()},{"../Gameplay/GameDefine":"GameDefine","./Platform":"Platform"}],PauseEndView:[function(t,e,n){"use strict";cc._RF.push(e,"c43a7c9NNVGT78B9sg0stEB","PauseEndView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../Module/ViewHandler")),c=a(t("../Utils/Path")),l=a(t("../Utils/Utils")),u=cc._decorator,p=u.ccclass,f=u.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.labelConfirm=null,e.labelCancel=null,e.labelContent=null,e.itemNodes=null,e.itemNode=null,e._callback=null,e._rewards=null,e}return r(e,t),e.prototype.initiateView=function(t){var e=t.rewards,n=t.contentKey,o=t.cb;this._callback=o,this._rewards=e,l.default.localize(this.labelTitle,"ui_condition"),l.default.localize(this.labelConfirm,"ui_confirm"),l.default.localize(this.labelCancel,"ui_cancel"),l.default.localize(this.labelContent,n),this.initItems()},e.prototype.initItems=function(){this.itemNodes.removeAllChildren();for(var t=0;t<this._rewards.length;t++){var e=this._rewards[t],n=cc.instantiate(this.itemNode);n.parent=this.itemNodes,n.getChildByName("labelNum").getComponent(cc.Label).string=""+e.count;var o=n.getChildByName("img").getComponent(cc.Sprite),r=n.getChildByName("imgOutline").getComponent(cc.Sprite),i=c.default.getItemPath(e.id),a=c.default.getItemOutlinePath(e.quality||1);l.default.loadImg(o,i,80),l.default.loadImg(r,a,100)}},e.prototype.onConfirm=function(){this._callback(!0),this.close()},e.prototype.onCancel=function(){this._callback(!1,"toast_user_cancel"),this.close()},i([f(cc.Label)],e.prototype,"labelTitle",void 0),i([f(cc.Label)],e.prototype,"labelConfirm",void 0),i([f(cc.Label)],e.prototype,"labelCancel",void 0),i([f(cc.Label)],e.prototype,"labelContent",void 0),i([f(cc.Node)],e.prototype,"itemNodes",void 0),i([f(cc.Prefab)],e.prototype,"itemNode",void 0),i([p],e)}(s.default);n.default=h,cc._RF.pop()},{"../Module/ViewHandler":"ViewHandler","../Utils/Path":"Path","../Utils/Utils":"Utils"}],PauseView:[function(t,e,n){"use strict";cc._RF.push(e,"42291un+JJEMLHAKSpHM4BV","PauseView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../Gameplay/Battle"),u=c(t("../Gameplay/GameDefine")),p=t("../Module/ConfigManager"),f=c(t("../Module/Loader")),h=c(t("../Module/ViewHandler")),d=c(t("../Utils/Path")),y=c(t("../Utils/Utils")),_=cc._decorator,g=_.ccclass,v=_.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.labelQuit=null,e.labelAbilityDmg=null,e.dpsNodes=null,e.dpsNode=null,e.labelTime=null,e.labelScore=null,e._callback=null,e._battle=null,e._battleResult=null,e}return r(e,t),e.prototype.initiateView=function(t){var e=this,n=t.battle,o=t.cb;this._battle=n,this._callback=o,this._battleResult=this._battle.getBattleResult();var r=0;this._battleResult.damageStats[u.default.PlayerId]&&(r=this._battleResult.damageStats[u.default.PlayerId].damage);var i,a=this._battleResult.timeSec;i=a>60?y.default.formatMinutesText(1e3*a):a+p.ConfigManager.instance.getLanConfig("ui_second"),this.labelTime.string=y.default.replaceStr("ui_battleTime",i),this.labelScore.string=y.default.replaceStr("ui_battleScore",this._battleResult.score),this.labelAbilityDmg.string=y.default.replaceStr("ui_abilityDmg",r),y.default.localize(this.labelTitle,"ui_pause"),y.default.localize(this.labelQuit,"ui_quit"),this._battle.battleStats.getAllDamages().sort(function(t,e){return e.damage-t.damage}),this._battle.targetOff(this),this._battle.on(l.Battle.Events.BattleEnd,function(){e.close()},this),this.initGuardNode()},e.prototype.createGuard=function(t,e){return a(this,void 0,void 0,function(){var n,o,r;return s(this,function(i){switch(i.label){case 0:return n=p.ConfigManager.instance.getGuardConfig(e),o=d.default.getEntityPath(n.asset),[4,f.default.loadResAsync(o,cc.Prefab,null)];case 1:return r=i.sent(),cc.instantiate(r).parent=t,[2]}})})},e.prototype.initGuardNode=function(){this.dpsNodes.removeAllChildren();for(var t=this._battleResult.damageStats,e=Math.min(3,t.length),n=0;n<e;n++){var o=t[n].id;if(o!=u.default.PlayerId){var r=cc.instantiate(this.dpsNode);r.parent=this.dpsNodes;var i="guard_"+o+"_name";r.getChildByName("labelName").getComponent(cc.Label).string=p.ConfigManager.instance.getLanConfig(i),r.getChildByName("labelDps").getComponent(cc.Label).string=""+t[n].damage;var a=r.getChildByName("animNode");this.createGuard(a,o)}}},e.prototype.onQuit=function(){this._callback&&this._callback(!0)},e.prototype.onClose=function(){this.close(),this._callback&&this._callback(!1)},i([v(cc.Label)],e.prototype,"labelTitle",void 0),i([v(cc.Label)],e.prototype,"labelQuit",void 0),i([v(cc.Label)],e.prototype,"labelAbilityDmg",void 0),i([v(cc.Node)],e.prototype,"dpsNodes",void 0),i([v(cc.Prefab)],e.prototype,"dpsNode",void 0),i([v(cc.Label)],e.prototype,"labelTime",void 0),i([v(cc.Label)],e.prototype,"labelScore",void 0),i([g],e)}(h.default);n.default=m,cc._RF.pop()},{"../Gameplay/Battle":"Battle","../Gameplay/GameDefine":"GameDefine","../Module/ConfigManager":"ConfigManager","../Module/Loader":"Loader","../Module/ViewHandler":"ViewHandler","../Utils/Path":"Path","../Utils/Utils":"Utils"}],Platform:[function(t,e,n){"use strict";var o;cc._RF.push(e,"cc6dfLIrMpJ4rkiQoGgIJGl","Platform"),Object.defineProperty(n,"__esModule",{value:!0}),function(t){t[t.Default=0]="Default",t[t.Wx=1]="Wx",t[t.QQ=2]="QQ",t[t.TT_Douyin=3]="TT_Douyin",t[t.TT_Toutiao=4]="TT_Toutiao",t[t.Android=5]="Android",t[t.Android_Nog=6]="Android_Nog",t[t.Android_Ohayoo=7]="Android_Ohayoo",t[t.Android_Tap=8]="Android_Tap",t[t.iOS=9]="iOS"}(o||(o={}));var r=function(){function t(){}return t.isWx=function(){return cc.sys.platform===cc.sys.WECHAT_GAME&&null!=window.wx&&null==window.qq||!1},t.isQQ=function(){return cc.sys.platform===cc.sys.WECHAT_GAME&&null!=window.qq||!1},t.isWxLike=function(){return cc.sys.platform===cc.sys.WECHAT_GAME||!1},t.isBytedance=function(){return cc.sys.platform===cc.sys.BYTEDANCE_GAME||!1},t.isBytedanceDouyin=function(){return!!this.isBytedance()&&(this._bytedanceAppName||(this._bytedanceAppName=tt.getSystemInfoSync().appName.toUpperCase()),"DOUYIN"===this._bytedanceAppName)},t.isBytedanceToutiao=function(){return!!this.isBytedance()&&(this._bytedanceAppName||(this._bytedanceAppName=tt.getSystemInfoSync().appName.toUpperCase()),"TOUTIAO"===this._bytedanceAppName)},t.isMiniGame=function(){return cc.sys.platform===cc.sys.WECHAT_GAME||cc.sys.platform===cc.sys.BYTEDANCE_GAME||!1},t.isAndroid=function(){return cc.sys.platform===cc.sys.ANDROID||!1},t.isOhayoo=function(){if(cc.sys.platform===cc.sys.ANDROID){var t=SDKBridge.getInstance().getSystemInfo();return t&&!!t.isOhayoo}return!1},t.isTap=function(){if(cc.sys.platform===cc.sys.ANDROID){var t=SDKBridge.getInstance().getSystemInfo();return t&&!!t.isTap}return!1},t.isNog=function(){if(cc.sys.platform===cc.sys.ANDROID){var t=SDKBridge.getInstance().getSystemInfo();return!(t&&(t.isOhayoo||t.isTap))}return!1},t.isIOS=function(){return cc.sys.platform===cc.sys.IPHONE||cc.sys.platform===cc.sys.IPAD||!1},t.isMobile=function(){return this.isAndroid()||this.isIOS()},t.isNative=function(){return cc.sys.isNative||!1},t.isTest=function(){return!0},t._mockInPlatform=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!1},t._mockPlatform=o.Android,t}();n.default=r,cc._RF.pop()},{}],PlayerConfig:[function(t,e,n){"use strict";cc._RF.push(e,"9c9e5t0qLdNB7d0mYsFhw4A","PlayerConfig"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],PlayerData:[function(t,e,n){"use strict";cc._RF.push(e,"42b0bPL3chCE4HYe8tcrPGx","PlayerData"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],Player:[function(t,e,n){"use strict";cc._RF.push(e,"f5262/u3rBEZK0O6sM/pRtx","Player");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.Player=void 0;var a=i(t("../../Utils/Path")),s=t("./BattleEntity"),c=t("../../Interface/Config/AbilityConfig"),l=i(t("../GameDefine")),u=t("../../Module/ConfigManager"),p={Hp:"Hp",Exp:"Exp",Upgrade:"Upgrade"},f=function(t){function e(e,n){var o=t.call(this,e,l.default.PlayerId)||this;return o._level=0,o._exp=0,o._upgradeExp=0,o._oriIndex=0,o._isPerfect=!0,o.data=n,o._upgradeExp=o.getUpgradeExp(o._level),o._isPerfect=!0,o.initProperty(),o}return r(e,t),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLevel",{get:function(){return this.data.maxLevel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exp",{get:function(){return this._exp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"upgradeExp",{get:function(){return this._upgradeExp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPerfect",{get:function(){return this._isPerfect},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targetType",{get:function(){return c.AbilityTargetType.Player},enumerable:!1,configurable:!0}),e.prototype.initProperty=function(){this._prop.maxHp.setInit(this.data.hp),this.fullHp(),this._prop.attack.setInit(this.data.attack)},e.prototype.getRawAttackCd=function(){return u.ConfigManager.instance.getAbilityConfig(this.data.ability).cd},e.prototype.onAvatarReady=function(){},e.prototype.getAssetPath=function(){return a.default.getPlayerEntityPath()},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.addExp=function(t){this._exp+=t,this.emit(p.Exp,this._exp,this._upgradeExp)},e.prototype.canUpgrade=function(){return this.level<this.maxLevel&&this.getUpgradeExp(this.level)<=this._exp},e.prototype.upgrade=function(){this.canUpgrade()&&(this._exp-=this._upgradeExp,this._level+=1,this._upgradeExp=this.getUpgradeExp(this._level),this.emit(p.Exp,this._exp,this._upgradeExp))},e.prototype.isFullLevel=function(){return this.level>=this.maxLevel},e.prototype.getUpgradeExp=function(t){return t>=this.data.upgradeExp.length&&this.data.upgradeExp[this.data.upgradeExp.length-1],this.data.upgradeExp[t]},e.prototype.recoverPerfect=function(){this._isPerfect=!0},e.prototype.onHurt=function(){this._isPerfect=!1;var t=Math.round(this.getMaxHp()/this.getHp());if(t>=1&&this._oriIndex!=t){this._oriIndex=t;var e="wall_"+t;this.anim.play(e)}this.emit(p.Hp,this.getHp(),this.getMaxHp()),this.isAlive()||this.die()},e.prototype.castSelfAbility=function(){this.castAbility(this.data.ability,null)},e.prototype.findTarget=function(t){var e=this,n=null;switch(t){case c.AbilityTargetType.Player:n=this;break;case c.AbilityTargetType.Guard:var o=Array.from(this._entityContext.getAllGuards().values());n=this.getNeareastEntityWithCondition(o,function(t){return!t.followers.has(e)});break;case c.AbilityTargetType.Enemy:o=Array.from(this._entityContext.getAllEnemies().values()),n=this.getNeareastEntity(o)}return n},e.prototype.update=function(e){t.prototype.update.call(this,e)},e.prototype.die=function(){},e.Events=p,e}(s.BattleEntity);n.Player=f,cc._RF.pop()},{"../../Interface/Config/AbilityConfig":"AbilityConfig","../../Module/ConfigManager":"ConfigManager","../../Utils/Path":"Path","../GameDefine":"GameDefine","./BattleEntity":"BattleEntity"}],Profiler:[function(t,e,n){"use strict";var o;cc._RF.push(e,"8dff6YEK2xMWo2Ij8b4VXRJ","Profiler"),Object.defineProperty(n,"__esModule",{value:!0}),n.profile=n.Profiler=void 0,cc.sys.platform===cc.sys.WECHAT_GAME?wx.getPerformance&&(o=wx.getPerformance()):cc.sys.platform===cc.sys.BYTEDANCE_GAME&&tt.getPerformance&&(o=tt.getPerformance()),o||(o=window&&window.performance||Date);var r=function(){function t(){}return t.now=function(){return o.now()},t.lazyInit=function(){},t.start=function(){},t.end=function(){},t.dump=function(){},t.inited=!1,t}();n.Profiler=r,n.profile=function(t,e){return void 0===e&&(e=!1),function(){}},cc._RF.pop()},{}],PseudoRandom:[function(t,e,n){"use strict";cc._RF.push(e,"1f9b9e2bb1Mzpnl63wskuxM","PseudoRandom"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){void 0===e&&(e=2),this._total=0,this._success=0,this._buffer=2,e=Math.max(e,1),this._buffer=e,this.setRate(t)}return t.prototype.setRate=function(t){(t=cc.misc.clamp01(t))!=this._targetRate&&(this._targetRate=t,this._total=0,this._success=0,this.updateDynamicRate())},t.prototype.updateDynamicRate=function(){if(this._dynamicRates=[],0===this._targetRate||1===this._targetRate)this._dynamicRates.push(this._targetRate),this._rateLevel=0;else{for(var t=0;t<this._buffer;++t){var e=this._targetRate*t/this._buffer;this._dynamicRates.push(e)}for(this._dynamicRates.push(this._targetRate),this._rateLevel=this._buffer,t=0;t<this._buffer;++t)e=this._targetRate+(t+1)/this._buffer*(1-this._targetRate),this._dynamicRates.push(e)}cc.log("[PseudoRandom] rate: "+this._targetRate+", dynamic: "+this._dynamicRates.join(",")+", level: "+this._rateLevel)},t.prototype.rand=function(){if(0===this._total)return(e=Math.random()<this._targetRate)&&this._success++,this._total++,cc.log("[PseudoRandom] rand, result: "+e+", target: "+this._targetRate+", real: "+this._success/this._total+", count: "+this._success+"/"+this._total),e;var t=this._success/this._total;t<this._targetRate?this._rateLevel=Math.min(this._rateLevel+1,this._dynamicRates.length-1):t>this._targetRate&&(this._rateLevel=Math.max(this._rateLevel-1,0));var e,n=this._dynamicRates[this._rateLevel];return(e=Math.random()<n)&&this._success++,this._total++,cc.log("[PseudoRandom] rand, result: "+e+", target: "+this._targetRate+", real: "+this._success/this._total+", count: "+this._success+"/"+this._total),e},t}();n.default=o,cc._RF.pop()},{}],Queue:[function(t,e,n){"use strict";cc._RF.push(e,"0d24aEHkpBMPqD+bg6rDdp0","Queue");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var a=function(t){function e(e){return null!=e?t.call(this,null,{capacity:e})||this:t.call(this)||this}return r(e,t),e.prototype.enqueue=function(t){return this.push(t)},e.prototype.dequeue=function(){return this.shift()},e.prototype.peek=function(){return this.peekFront()},e}(i(t("denque")).default);n.default=a,cc._RF.pop()},{denque:12}],ReactProperty:[function(t,e,n){"use strict";cc._RF.push(e,"fcc39slj89K7IPh9ZCVUPmt","ReactProperty");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0}),n.ReactBool=n.ReactNumber=n.ReactProperty=n.CacheNode=n.CacheVec2=n.CacheBool=n.CacheNumber=n.CacheProperty=void 0;var i=t("./Action"),a=function(){function t(t){this._gettter=t}return Object.defineProperty(t.prototype,"value",{get:function(){return void 0===this._value&&(this._value=this._gettter()),this._value},enumerable:!1,configurable:!0}),t}();n.CacheProperty=a;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(a);n.CacheNumber=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(a);n.CacheBool=c;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(a);n.CacheVec2=l;var u=function(t){function e(e){return t.call(this,function(){return cc.find(e)})||this}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return null!=this._value&&cc.isValid(this._value)||(this._value=this._gettter()),this._value},enumerable:!1,configurable:!0}),e}(a);n.CacheNode=u;var p=function(){function t(t){this.onValueChange=new i.Action1,this._value=t}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){t!==this._value&&(this._value=t,this.onValueChange.call(t))},enumerable:!1,configurable:!0}),t.prototype.add=function(t,e){this.onValueChange.add(t,e)},t.prototype.addWithInitValue=function(t,e){this.onValueChange.add(t,e),t.call(e,this._value)},t}();n.ReactProperty=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(p);n.ReactNumber=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(p);n.ReactBool=h,cc._RF.pop()},{"./Action":"Action"}],RemoteImgLoader:[function(t,e,n){"use strict";cc._RF.push(e,"ca8550oO7JMGK42hvH+jIoq","RemoteImgLoader");var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var r=o(t("./CryptoJsMini")),i=function(){function t(){}return t.loadImg=function(t,e){var n=jsb.fileUtils.getWritablePath()+"remoteImgCache/",o=r.default.MD5(t).toString(),i=n+o+".jpg";function a(){e&&e(null,null)}function s(){cc.loader.load(i,function(t,n){if(t)cc.error(t),a();else{var o=new cc.SpriteFrame(n);o&&e&&e(o,i)}})}if(console.log("filepath ->",i),jsb.fileUtils.isFileExist(i))return cc.log("Remote is find"+i),void s();var c=function(t){void 0!==t?(jsb.fileUtils.isDirectoryExist(n)?console.log("\u8def\u5f84exist"):jsb.fileUtils.createDirectory(n),jsb.fileUtils.writeDataToFile(new Uint8Array(t),i)?(cc.log("Remote write file succeed."),s()):(cc.log("Remote write file failed."),a())):(cc.log("Remote download file failed."),a())},l=new XMLHttpRequest;l.onreadystatechange=function(){4===l.readyState&&(200===l.status?c(l.response):c(null))}.bind(this),l.responseType="arraybuffer",l.open("GET",t,!0),l.send()},t}();n.default=i,cc._RF.pop()},{"./CryptoJsMini":"CryptoJsMini"}],RemoteStorage:[function(t,e,n){"use strict";cc._RF.push(e,"1ddf1L0HdRH2bIS/PJL+QFL","RemoteStorage"),Object.defineProperty(n,"__esModule",{value:!0}),n.RemoteStorage=void 0;var o=function(){function t(){}return t.init=function(){throw new Error("Not implemented")},t.getItemAsync=function(t,e){if(!e)throw new Error("Not implemented");this.getItemAsync(t).then(e)},t.setItemAsync=function(t,e,n){if(!n)throw new Error("Not implemented");this.setItemAsync(t,e).then(n)},t}();n.RemoteStorage=o,cc._RF.pop()},{}],RetryPolicy:[function(t,e,n){"use strict";cc._RF.push(e,"3f10c2NPH5BCrvBwT/qQOVA","RetryPolicy"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e,n,o){this._initialTimeoutMs=t,this._maxNumRetries=e,this._backoffMultiplier=n,this._maxTimeoutMs=null!=o?o:1/0}return t.prototype.run=function(t){var e=this;this._running?console.error("[RetryPolicy] run: exists running task!"):(this._task=t,this._currentRetryTimes=0,this._currentTimeoutMs=this._initialTimeoutMs,this._running=!0,this._timeoutHandler=setTimeout(function(){e._timeoutHandler=null,e._task(e)},this._currentTimeoutMs))},t.prototype.continue=function(){var t=this;this._timeoutHandler?console.warn("[RetryPolicy] continue: exists running task!"):(this._currentRetryTimes++,this._currentRetryTimes>=this._maxNumRetries?this._running=!1:(this._currentTimeoutMs=Math.min(this._currentTimeoutMs*this._backoffMultiplier,this._maxTimeoutMs),this._timeoutHandler=setTimeout(function(){t._timeoutHandler=null,t._task(t)},this._currentTimeoutMs)))},t.prototype.finish=function(){this._running=!1,this._timeoutHandler&&(clearTimeout(this._timeoutHandler),this._timeoutHandler=null)},t}();n.default=o,cc._RF.pop()},{}],RewardCardNode:[function(t,e,n){"use strict";cc._RF.push(e,"a24d2vWw+tPzp3C/Fu+XdQu","RewardCardNode");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../../Module/ConfigManager"),u=c(t("../../Module/Loader")),p=c(t("../../Module/ViewHandler")),f=c(t("../../Utils/Path")),h=c(t("../../Utils/Utils")),d=cc._decorator,y=d.ccclass,_=d.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelName=null,e.labelType=null,e.showBox=null,e.cardBg=null,e._guardId=null,e}return r(e,t),e.prototype.initiateView=function(t){h.default.localize(this.labelName,"guard_"+t+"_name");var e=l.ConfigManager.instance.getGuardConfig(t);if(e.tags[1]){var n="guard_"+e.tags[1];h.default.localize(this.labelType,n)}h.default.loadImg(this.cardBg,f.default.getGuardQualityPath(e.quality)),this._guardId=t,this.initShowBox()},e.prototype.initShowBox=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return t=f.default.getEntityPath("Guards/Guard_"+this._guardId),[4,u.default.loadResAsync(t,cc.Prefab,null)];case 1:return e=n.sent(),cc.instantiate(e).parent=this.showBox,[2]}})})},i([_(cc.Label)],e.prototype,"labelName",void 0),i([_(cc.Label)],e.prototype,"labelType",void 0),i([_(cc.Node)],e.prototype,"showBox",void 0),i([_(cc.Sprite)],e.prototype,"cardBg",void 0),i([y],e)}(p.default);n.default=g,cc._RF.pop()},{"../../Module/ConfigManager":"ConfigManager","../../Module/Loader":"Loader","../../Module/ViewHandler":"ViewHandler","../../Utils/Path":"Path","../../Utils/Utils":"Utils"}],RewardCardView:[function(t,e,n){"use strict";cc._RF.push(e,"dbcc5VMb6RDHoTjSpO0sj2D","RewardCardView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../Module/ViewHandler")),c=a(t("../Utils/Utils")),l=a(t("./Card/RewardCardNode")),u=cc._decorator,p=u.ccclass,f=u.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.cardRoot=null,e.rewardCardNode=null,e}return r(e,t),e.prototype.initiateView=function(t){c.default.localize(this.labelTitle,"ui_getCard");for(var e=t.guards,n=0;n<e.length;n++){var o=e[n],r=cc.instantiate(this.rewardCardNode);r.parent=this.cardRoot,r.getComponent(l.default).initiateView(o)}},i([f(cc.Label)],e.prototype,"labelTitle",void 0),i([f(cc.Node)],e.prototype,"cardRoot",void 0),i([f(cc.Prefab)],e.prototype,"rewardCardNode",void 0),i([p],e)}(s.default);n.default=h,cc._RF.pop()},{"../Module/ViewHandler":"ViewHandler","../Utils/Utils":"Utils","./Card/RewardCardNode":"RewardCardNode"}],RotateTest:[function(t,e,n){"use strict";cc._RF.push(e,"fcb69soiwhJ/KNEJSFSdCpM","RotateTest");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.angle=360,e.duration=3,e}return r(e,t),e.prototype.start=function(){cc.tween(this.node).repeatForever(cc.tween(this.node).by(this.duration,{angle:this.angle})).start()},i([c],e.prototype,"angle",void 0),i([c],e.prototype,"duration",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],SDKBridge:[function(t,e){"use strict";cc._RF.push(e,"8d561j4QXRKE6n6702fl60n","SDKBridge");var n=function(){function t(){this.SDK_CLASS_NAME_ANDROID="com/firewing/sdk/SDKBridge",this.SDK_CLASS_NAME_IOS="SDKBridge",this._isAndroid=cc.sys.platform===cc.sys.ANDROID,this._isIOS=cc.sys.platform===cc.sys.IPHONE||cc.sys.platform===cc.sys.IPAD,this._isValid=this._isAndroid||this._isIOS,this._callbackMap=new Map,this._nextCallbackID=1,this._channel=null,this._nogOpenId=null,this._nogUserInfo=null,this._tapAccessToken=null,this._tapUserInfo=null,this._ohayooUserInfo=null}var e=t.prototype;return e.getChannel=function(){return this._channel?this._channel:this._isAndroid?"android":this._isIOS?"ios":"unknown"},e.getSystemInfo=function(){var t=null,e=this.callNative("getSystemInfo","()Ljava/lang/String;");if(e)try{t=JSON.parse(e)}catch(n){}return t},e.login=function(t,e){var n=this;if(this._isValid){this._channel=t;var o=this._addCallback(function(t,o){0===t&&(n._loginResult=JSON.parse(o.data),"nog"===n._channel?(n._nogUserInfo=n._loginResult,n._nogOpenId=n._nogUserInfo.userGameId):"tap"===n._channel?n._tapAccessToken=n._loginResult:"ohayoo"===n._channel&&(n._ohayooUserInfo=n._loginResult)),e&&e(t,o)});this.callNative("login","(Ljava/lang/String;I)V",t,o)}else e&&e(1,null)},e.logout=function(t){var e=this._addCallback(t);this.callNative("logout","(I)V",e)},e.canBindPhone=function(){return this.canInvoke("bindPhone")},e.bindPhone=function(t){var e=this;this.invoke("bindPhone",null,function(n,o){0===n&&(console.log("[SDK] bindPhone",e._channel,JSON.stringify(o)),"nog"===e._channel?e._nogUserInfo=o:"ohayoo"===e._channel&&(e._ohayooUserInfo=o)),t&&t(n,o)})},e.isLoggedIn=function(){return null!=this._nogUserInfo},e.isPhoneBinded=function(){if("nog"==this._channel&&this._nogUserInfo){var t=this._nogUserInfo.phone;return t&&t.length>0}return!("ohayoo"!=this._channel||!this._ohayooUserInfo)&&(this._ohayooUserInfo.mobile||"").length>0},e.getNogOpenId=function(){return this._nogOpenId},e.getNogUserInfo=function(){return this._nogUserInfo},e.getTapAccessToken=function(){return this._tapAccessToken},e.setTapUserInfo=function(t){this._tapUserInfo=t},e.getTapUserInfo=function(){return this._tapUserInfo},e.getOhayooUserInfo=function(){return this._ohayooUserInfo},e.openTapMoment=function(t){var e=this._addCallback(t);this.callNative("openTapMoment","(I)V",e)},e.showBannerAd=function(t,e){var n=this._addCallback(function(t,n){0===t&&cc.log("showBannerAd",JSON.stringify(n)),e&&e(t,n)}),o=JSON.stringify(t);this.callNative("showBannerAd","(Ljava/lang/String;I)V",o,n)},e.hideBannerAd=function(){this.callNative("hideBannerAd","()V")},e.showVideoAd=function(t,e){var n=this._addCallback(function(t,n){0===t&&cc.log("showVideoAd",JSON.stringify(n)),e&&e(t,n)}),o=JSON.stringify(t);this.callNative("showVideoAd","(Ljava/lang/String;I)V",o,n)},e.showSplashAd=function(t){var e=this._addCallback(t);this.callNative("showSplashAd","(I)V",e)},e.wxShareWeb=function(t,e){this.invokeBySdk("wx","wxShareWeb",t,e)},e.shareText=function(t,e){this.invokeBySdk("fw","shareText",t,e)},e.downloadApk=function(t,e){var n=this._addCallback(e),o=JSON.stringify(t);this.callNative("downloadApk","(Ljava/lang/String;I)V",o,n)},e.setupBugly=function(t){var e=JSON.stringify(t);this.callNative("setupBugly","(Ljava/lang/String;)V",e)},e.setClipboardData=function(t,e){var n=this._addCallback(e);this.callNative("setClipboardData","(Ljava/lang/String;I)V",t,n)},e.getClipboardData=function(t){this.invokeBySdk("fw","getClipboard",null,t)},e.reportLog=function(){},e.canInvoke=function(t){return this.callNative("canInvoke","(Ljava/lang/String;)Z",t)},e.invoke=function(t,e,n){var o=this._addCallback(n),r=null!=e?JSON.stringify(e):"{}";this.callNative("invoke","(Ljava/lang/String;Ljava/lang/String;I)V",t,r,o)},e.canInvokeBySdk=function(t,e){return this.callNative("canInvokeBySdk","(Ljava/lang/String;Ljava/lang/String;)Z",t,e)},e.invokeBySdk=function(t,e,n,o){var r=this._addCallback(o),i=null!=n?JSON.stringify(n):"{}";this.callNative("invokeBySdk","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;I)V",t,e,i,r)},e.callNative=function(t,e){for(var n=arguments.length,o=new Array(n>2?n-2:0),r=2;r<n;r++)o[r-2]=arguments[r];var i;if(this._isAndroid)return(i=jsb.reflection).callStaticMethod.apply(i,[this.SDK_CLASS_NAME_ANDROID,t,e].concat(o));if(this._isIOS){for(var a,s=0;s<o.length;++s)t+=":";return(a=jsb.reflection).callStaticMethod.apply(a,[this.SDK_CLASS_NAME_IOS,t].concat(o))}},e.onNativeToJsCallback=function(t,e){var n=this._removeCallback(t);n&&setTimeout(function(){var t=e.code,o=e.data;n(t,o)},0)},e._addCallback=function(t){var e=this._nextCallbackID++;return this._callbackMap.set(e,t),e},e._removeCallback=function(t){var e=this._callbackMap.get(t);return this._callbackMap.delete(t),e},e.clear=function(){this._callbackMap.clear()},t}();n._instance=null,n.getInstance=function(){return n._instance||(n._instance=new n),n._instance},window.SDKBridge=n,cc._RF.pop()},{}],ScaleTest:[function(t,e,n){"use strict";cc._RF.push(e,"992a8Jscg1FcZ9/Rrv3fKKt","ScaleTest");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.offset=cc.v2(1,1),e.duration=1,e}return r(e,t),e.prototype.start=function(){var t=this.node.scaleX,e=this.node.scaleY;cc.tween(this.node).repeatForever(cc.tween(this.node).to(this.duration,{scaleX:this.offset.x*t,scaleY:this.offset.y*e}).to(this.duration,{scaleY:e,scaleX:t})).start()},i([c(cc.Vec2)],e.prototype,"offset",void 0),i([c],e.prototype,"duration",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],SceneType:[function(t,e,n){"use strict";cc._RF.push(e,"bc8d6PtiQFIaae0CdQeMCcB","SceneType"),Object.defineProperty(n,"__esModule",{value:!0}),n.SceneType=void 0,function(t){t[t.HomeScene=1]="HomeScene",t[t.Count=1]="Count"}(n.SceneType||(n.SceneType={})),cc._RF.pop()},{}],SettingData:[function(t,e,n){"use strict";cc._RF.push(e,"a5760sLoWVFQKvaDQD4o/z6","SettingData"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],SettingView:[function(t,e,n){"use strict";cc._RF.push(e,"9d3faEFZ3BHxLPgsFykmu+x","SettingView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../Enum/ViewType")),c=t("../Gameplay/System/HomeSystem"),l=a(t("../Module/ViewHandler")),u=a(t("../Utils/Utils")),p=cc._decorator,f=p.ccclass,h=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewType=s.default.BaseView,e.labelFeedback=null,e.labelGamecircle=null,e.labelUserName=null,e.labelUserUid=null,e.labelMusic=null,e.musicToggle=null,e.labelEffect=null,e.effectToggle=null,e._callback=null,e._music=null,e._effect=null,e}return r(e,t),e.prototype.initiateView=function(){u.default.localize(this.labelFeedback,"ui_feedback"),u.default.localize(this.labelGamecircle,"ui_gamecircle"),u.default.localize(this.labelMusic,"ui_music"),u.default.localize(this.labelEffect,"ui_effect"),this.labelUserName.string="\u7528\u6237\u540d\u79f0",this.labelUserUid.string="uid-000000001",this._music=c.HomeSystem.instance.getMusic(),this._effect=c.HomeSystem.instance.getEffect(),this.initMusicAndEffectToggle()},e.prototype.onConfirm=function(){this.close(),this._callback&&this._callback()},e.prototype.initMusicAndEffectToggle=function(){this._music?this.musicToggle.check():this.musicToggle.uncheck(),this._effect?this.effectToggle.check():this.effectToggle.uncheck()},e.prototype.onMusic=function(){this._music?(this._music=!1,c.HomeSystem.instance.stopMusic(),this.musicToggle.uncheck()):(this._music=!0,c.HomeSystem.instance.startMusic(),this.musicToggle.check())},e.prototype.onEffect=function(){this._effect?(this._effect=!1,c.HomeSystem.instance.stopEffect(),this.effectToggle.uncheck()):(this._effect=!0,c.HomeSystem.instance.startEffect(),this.effectToggle.check())},i([h(cc.Label)],e.prototype,"labelFeedback",void 0),i([h(cc.Label)],e.prototype,"labelGamecircle",void 0),i([h(cc.Label)],e.prototype,"labelUserName",void 0),i([h(cc.Label)],e.prototype,"labelUserUid",void 0),i([h(cc.Label)],e.prototype,"labelMusic",void 0),i([h(cc.Toggle)],e.prototype,"musicToggle",void 0),i([h(cc.Label)],e.prototype,"labelEffect",void 0),i([h(cc.Toggle)],e.prototype,"effectToggle",void 0),i([f],e)}(l.default);n.default=d,cc._RF.pop()},{"../Enum/ViewType":"ViewType","../Gameplay/System/HomeSystem":"HomeSystem","../Module/ViewHandler":"ViewHandler","../Utils/Utils":"Utils"}],ShopView:[function(t,e,n){"use strict";cc._RF.push(e,"01344b7HmpBE5cq3nHMlmQu","ShopView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../Enum/ViewType")),c=t("../Gameplay/System/BagSystem"),l=t("../Gameplay/System/WeaponSystem"),u=t("../Module/ConfigManager"),p=a(t("../Module/ViewHandler")),f=cc._decorator,h=f.ccclass,d=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewType=s.default.BaseView,e._callback=null,e}return r(e,t),e.prototype.initiateView=function(){},e.prototype.onConfirm=function(){this.close(),this._callback&&this._callback()},e.prototype.onUnlockCardGroup=function(){var t=u.ConfigManager.instance.getCardGroupConfig(2).condition;c.BagSystem.instance.showConditionView(t,"condition_unlock_card",function(t){t&&l.WeaponSystem.instance.unlockCards(2)})},i([h],e)}(p.default));n.default=d,cc._RF.pop()},{"../Enum/ViewType":"ViewType","../Gameplay/System/BagSystem":"BagSystem","../Gameplay/System/WeaponSystem":"WeaponSystem","../Module/ConfigManager":"ConfigManager","../Module/ViewHandler":"ViewHandler"}],StageConfig:[function(t,e,n){"use strict";cc._RF.push(e,"9cbb82oGnxFiq6g41/Nc1YM","StageConfig"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],StartSceneLoading:[function(t,e,n){"use strict";cc._RF.push(e,"1af1a/DqwFF7YKH25qito0f","StartSceneLoading");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var a=i(t("../Gameplay/Game")),s=i(t("../Utils/Path")),c=t("./ConfigManager"),l=i(t("./Database/Db")),u=i(t("./Loader")),p=i(t("./Loading")),f=window.performance||Date,h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.start=function(){var e=this;t.prototype.start.call(this);var n=this.timeit("[Loading] loading"),o=function(t){return e.addProgress.bind(e,t)},r=this.loadScene().then(this.addProgress.bind(this,10)).then(this.loadRes.bind(this)).then(this.addProgress.bind(this,10)),i=this.loadBundle(40).then(),a=this.loadConfig().then(o(10)).then(this.loadDatabase.bind(this)).then(o(10)).then(this.login.bind(this)).then(o(10)).then(this.loadGame.bind(this)).then(o(10));Promise.all([i,r,a]).then(n)},e.prototype.loadGame=function(){var t=this.timeit("[Loading] game");return a.default.instance.init().then(t)},e.prototype.loadRes=function(){var t=this;return new Promise(function(e){var n=t.timeit("[Loading] res");u.default.loadRes(s.default.viewPath("HomeWorld"),cc.Prefab,function(){n(),e()},null)})},e.prototype.login=function(){return new Promise(function(t){t()})},e.prototype.loadDatabase=function(){l.default.instance.init()},e.prototype.loadConfig=function(){var t=this.timeit("[Loading] config");return c.ConfigManager.instance.init().then(t)},e.prototype.loadScene=function(){var t=this;return this.loadBaseBundle().then(function(){return new Promise(function(e){var n=t.timeit("[Loading] loading scene");cc.director.preloadScene("GameScene",null,function(){n(),e()})})})},e.prototype.loadBaseBundle=function(){var t=this;return new Promise(function(e){var n=t.timeit("[Loading] loading font");u.default.loadBundle([s.default.MAIN_BUNDLE],function(){n(),e()})})},e.prototype.loadBundle=function(t){var e=this;return new Promise(function(n){var o=e.timeit("[Loading] loading bundle"),r=[s.default.MAIN_BUNDLE,s.default.BATTLE_BUNDLE],i=t/r.length,a=e;(function t(){0===r.length?(o(),n()):u.default.loadBundle(r.shift(),function(){a.addProgress(i),t()})})()})},e.prototype.timeit=function(t){var e=f.now();return console.log(t+" start"),function(){var n=f.now()-e;console.log(t+" finish: "+n+"ms")}},e}(p.default);n.default=h,cc._RF.pop()},{"../Gameplay/Game":"Game","../Utils/Path":"Path","./ConfigManager":"ConfigManager","./Database/Db":"Db","./Loader":"Loader","./Loading":"Loading"}],StartScene:[function(t,e,n){"use strict";cc._RF.push(e,"179adkLG4dM+r9siYAbK2+F","StartScene");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=c(t("../../Gameplay/GameDefine")),u=c(t("../../Module/Audio")),p=c(t("../../Module/StartSceneLoading")),f=t("../../Module/Statistics"),h=c(t("../../Utils/AppUpdater")),d=c(t("../../Utils/ErrorReporter")),y=c(t("../View/LoadingView")),_=cc._decorator,g=_.ccclass,v=_.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelLoading=null,e._loadingQuene=null,e}return r(e,t),e.prototype.start=function(){cc.dynamicAtlasManager.enabled=!1,u.default.instance.init(),f.Statistic.instance.init(),f.Statistic.instance.addLog(f.LogEvent.GAME_START,null,!0),d.default.instance.init(),h.default.checkUpdate(),cc.sys.platform===cc.sys.ANDROID&&SDKBridge.getInstance().setupBugly({version:l.default.VERSION}),this._loadingQuene=new p.default(1),this._loadingQuene.start(),this._loadingQuene.onComplete=this.onComplete.bind(this),this.showLoadingView()},e.prototype.showLoadingView=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,y.default.show(this._loadingQuene)];case 1:return t=e.sent(),cc.isValid(this)?this._loadingView=t:t.finish(),[2]}})})},e.prototype.onComplete=function(){var t=this._loadingView;cc.director.loadScene("GameScene",function(){t&&t.finish()})},i([v(cc.Label)],e.prototype,"labelLoading",void 0),i([g],e)}(cc.Component);n.default=m,cc._RF.pop()},{"../../Gameplay/GameDefine":"GameDefine","../../Module/Audio":"Audio","../../Module/StartSceneLoading":"StartSceneLoading","../../Module/Statistics":"Statistics","../../Utils/AppUpdater":"AppUpdater","../../Utils/ErrorReporter":"ErrorReporter","../View/LoadingView":"LoadingView"}],StateMachine:[function(t,e,n){"use strict";cc._RF.push(e,"3abc3hYypJAcqXQLNN4ZRfo","StateMachine");var o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},r=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};Object.defineProperty(n,"__esModule",{value:!0}),n.StateMachine=n.BaseState=void 0;var i=function(){function t(){}return t.prototype.setContext=function(t){this.context=t},t.prototype.getContext=function(){return this.context},t.prototype.setStateMachine=function(t){this.stateMachine=t},t.prototype.changeState=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];(e=this.stateMachine).changeState.apply(e,r([t],n))},t.prototype.changeStateAsync=function(t){for(var e=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];setTimeout(function(){var o;(o=e.stateMachine).changeState.apply(o,r([t],n))},1)},t}();n.BaseState=i;var a=function(){function t(t){this._context=t,this._statesMap=new Map}return t.prototype.addState=function(t){this._statesMap.has(t.name)&&this._statesMap.get(t.name)!=t||(t.setContext(this._context),t.setStateMachine(this),this._statesMap.set(t.name,t))},t.prototype.addInitState=function(t){this.addState(t),this._initState=t},t.prototype.initState=function(){this.changeState(this._initState.name)},t.prototype.changeState=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(this._statesMap.has(t)&&this.getCurrentStateName()!==t)return this._prevState=this._currState,this._currState&&this._currState.onExit&&this._currState.onExit(),this._currState=this._statesMap.get(t),this._currState.onEnter&&(e=this._currState).onEnter.apply(e,r(n)),this._currState},t.prototype.revertToPreviousState=function(){this._prevState&&this.changeState(this._prevState.name)},t.prototype.getCurrentStateName=function(){var t;return null===(t=this._currState)||void 0===t?void 0:t.name},t.prototype.getState=function(t){return this._statesMap.get(t)},t.prototype.execute=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._currState&&this._currState.execute&&(t=this._currState).execute.apply(t,r(e))},t.prototype.update=function(t){this._currState&&this._currState.update&&this._currState.update(t)},t}();n.StateMachine=a,cc._RF.pop()},{}],Statistics:[function(t,e,n){"use strict";cc._RF.push(e,"406bdkjKbJNzqEh4AINipp3","Statistics");var o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},r=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.Statistic=n.LogEvent=n.AD_RESULT=n.BannerAdType=n.VideoAdType=void 0;var a,s=i(t("../Gameplay/Game")),c=i(t("../Gameplay/GameDefine"));(function(t){t[t.RefreshGuard=1]="RefreshGuard"})(n.VideoAdType||(n.VideoAdType={})),n.BannerAdType||(n.BannerAdType={}),function(t){t[t.USE_PROPAGANDA=1]="USE_PROPAGANDA",t[t.SUCCESS=2]="SUCCESS",t[t.FAILED=3]="FAILED",t[t.CANCEL=4]="CANCEL"}(n.AD_RESULT||(n.AD_RESULT={})),function(t){t[t.GAME_START=1]="GAME_START",t[t.GAME_SHOW=2]="GAME_SHOW",t[t.GAME_HIDE=3]="GAME_HIDE",t[t.LOGIN=4]="LOGIN",t[t.PLAY_TIME=5]="PLAY_TIME",t[t.REGISTER=6]="REGISTER",t[t.APP_LAUNCH=7]="APP_LAUNCH",t[t.GUIDE_STEP=51]="GUIDE_STEP",t[t.WATCH_AD=102]="WATCH_AD",t[t.SHOW_BANNER_AD=103]="SHOW_BANNER_AD",t[t.SHOW_SPLASH_AD=104]="SHOW_SPLASH_AD",t[t.SHOW_INSERT_AD=105]="SHOW_INSERT_AD",t[t.LEAF_CHANGED=151]="LEAF_CHANGED",t[t.STAR_CHANGED=152]="STAR_CHANGED",t[t.PASSAD_CHANGED=153]="PASSAD_CHANGED",t[t.COMMON_PIECE_CHANGED=154]="COMMON_PIECE_CHANGED",t[t.MOON_STONE_CHANGED=155]="MOON_STONE_CHANGED",t[t.GEM_CHANGED=156]="GEM_CHANGED",t[t.GET_ORDER_MANUAL=201]="GET_ORDER_MANUAL",t[t.GET_ORDER_AUTO=202]="GET_ORDER_AUTO",t[t.ORDER_SUCCESS=203]="ORDER_SUCCESS",t[t.SEND_PROPAGANDA=301]="SEND_PROPAGANDA",t[t.DAILY_TASK_GET_REWARD=401]="DAILY_TASK_GET_REWARD",t[t.MAIN_TASK_GET_REWARD=402]="MAIN_TASK_GET_REWARD",t[t.ACHIEVEMENT_GET_REWARD=403]="ACHIEVEMENT_GET_REWARD",t[t.BUTTON_SOCIAL=501]="BUTTON_SOCIAL",t[t.BUTTON_LOGIN_REWARD=502]="BUTTON_LOGIN_REWARD",t[t.COMBINE_SUCCESS=601]="COMBINE_SUCCESS",t[t.COMBINE_FAILED=602]="COMBINE_FAILED",t[t.TIME_RESEARCH=603]="TIME_RESEARCH",t[t.RESEARCH_DRINK_SCORE=604]="RESEARCH_DRINK_SCORE",t[t.CLICK_MAT_PRODUCE=701]="CLICK_MAT_PRODUCE",t[t.CLICK_SPEEDUP_COOK=702]="CLICK_SPEEDUP_COOK",t[t.GET_LOGIN_REWARD=801]="GET_LOGIN_REWARD",t[t.SHARE_ANIMAL=901]="SHARE_ANIMAL",t[t.ADSTORE_WATCHADCHANCE_CHANGED=1001]="ADSTORE_WATCHADCHANCE_CHANGED",t[t.ADSTORE_FREEBOXCHANCE_CHANGED=1002]="ADSTORE_FREEBOXCHANCE_CHANGED",t[t.ADSTORE_GEMBOXCHANCE_CHANGED=1003]="ADSTORE_GEMBOXCHANCE_CHANGED",t[t.TREASUREMAPCHANCE_CHANGED=1004]="TREASUREMAPCHANCE_CHANGED",t[t.CAP_CHANGED=1005]="CAP_CHANGED"}(a=n.LogEvent||(n.LogEvent={}));var l=function(){function t(){this._logs=[],this._eventCacheCountMap=new Map,this._eventCache=new Map,this._eventCacheCountMap.set(a.LEAF_CHANGED,30),this._eventCacheCountMap.set(a.STAR_CHANGED,30),this._eventCacheCountMap.set(a.GET_ORDER_MANUAL,10),this._eventCacheCountMap.set(a.GET_ORDER_AUTO,10),this._eventCacheCountMap.set(a.ORDER_SUCCESS,10),this._eventCacheCountMap.set(a.SEND_PROPAGANDA,10),this._eventCacheCountMap.set(a.COMBINE_FAILED,10),this._eventCacheCountMap.set(a.COMBINE_SUCCESS,2),this._eventCacheCountMap.set(a.SHOW_BANNER_AD,10),this._leafIncomeCache={uid:null,version:c.default.VERSION,ts:0,eventID:a.LEAF_CHANGED,eventCount:0,extraInfo:{count:0}},this._leafOutgoingCache={uid:null,version:c.default.VERSION,ts:0,eventID:a.LEAF_CHANGED,eventCount:0,extraInfo:{count:0}}}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.init=function(){var t=this;cc.game.on(cc.game.EVENT_SHOW,function(){t.addLog(a.GAME_SHOW)},this),cc.game.on(cc.game.EVENT_HIDE,function(){t.addLog(a.GAME_HIDE),t.sendAllLogs()},this),this.delaySendLog()},t.prototype.addLog=function(t,e,n){if(this._eventCacheCountMap.has(t)){var o=this._eventCacheCountMap.get(t);if(t===a.LEAF_CHANGED){var r=e.count;r>0?(this._leafIncomeCache.extraInfo.count+=r,this._leafIncomeCache.eventCount+=1,this._leafIncomeCache.ts=s.default.instance.time()):(this._leafOutgoingCache.extraInfo.count+=r,this._leafOutgoingCache.eventCount+=1,this._leafOutgoingCache.ts=s.default.instance.time()),this._leafIncomeCache.eventCount+this._leafOutgoingCache.eventCount>=o&&(this._leafIncomeCache.eventCount>0&&(this._logs.push(Object.assign({},this._leafIncomeCache)),this._leafIncomeCache.eventCount=0,this._leafIncomeCache.extraInfo={count:0}),this._leafOutgoingCache.eventCount>0&&(this._logs.push(Object.assign({},this._leafOutgoingCache)),this._leafOutgoingCache.eventCount=0,this._leafOutgoingCache.extraInfo={count:0}))}else{if(this._eventCache.has(t)){var i=this._eventCache.get(t);i.eventCount+=1,i.ts=s.default.instance.time(),t===a.STAR_CHANGED&&(i.extraInfo.count+=e.count)}else this._eventCache.set(t,{uid:null,version:c.default.VERSION,eventCount:1,ts:s.default.instance.time(),eventID:t,extraInfo:e});this._eventCache.get(t).eventCount>=o&&(this._logs.push(this._eventCache.get(t)),this._eventCache.delete(t))}}else{var l={uid:null,version:c.default.VERSION,ts:s.default.instance.time(),eventID:t,extraInfo:e};this._logs.push(l)}(n||this._logs.length>=c.default.MAX_STAT_LOG_CACHE)&&this.sendAllLogs()},t.prototype.sendAllLogs=function(){var t=this;this._leafIncomeCache.eventCount>0&&(this._logs.push(Object.assign({},this._leafIncomeCache)),this._leafIncomeCache.eventCount=0,this._leafIncomeCache.extraInfo={count:0}),this._leafOutgoingCache.eventCount>0&&(this._logs.push(Object.assign({},this._leafOutgoingCache)),this._leafOutgoingCache.eventCount=0,this._leafOutgoingCache.extraInfo={count:0}),this._eventCache.forEach(function(e){t._logs.push(e)}),this._eventCache.clear(),this.sendLog()},t.prototype.sendLog=function(){var t,e=this;if(this.delaySendLog(),0!==this._logs.length){for(var n,o=this._logs.splice(0),i=0;i<o.length;i++){var s=o[i];if(s.uid="",s.eventID===a.APP_LAUNCH){n=s,o.splice(i,1);break}}n&&this._send([n],function(t){console.log("[Stats] send launch log: "+t),t||e._logs.push(n)}),(t=this._logs).push.apply(t,r(o))}},t.prototype.delaySendLog=function(){var t=this;this._handle&&(clearTimeout(this._handle),this._handle=null),this._handle=setTimeout(function(){t._handle=null,t.sendLog()},1e3*c.default.STAT_SEND_PERIOD)},t.prototype._send=function(){},t._instance=null,t}();n.Statistic=l,cc._RF.pop()},{"../Gameplay/Game":"Game","../Gameplay/GameDefine":"GameDefine"}],TableViewInterface:[function(t,e,n){"use strict";cc._RF.push(e,"3cdcanb2BZJBooPCRpismVd","TableViewInterface"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],TableViewItem:[function(t,e,n){"use strict";cc._RF.push(e,"5da8a8HJ19Gk7s+/EXA45hV","TableViewItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,a.menu),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){this._tableView=e},e.prototype.onUnuse=function(){},e.prototype.computeSize=function(){return this.node.getContentSize()},e.prototype.onCull=function(){},e.prototype.onHighlight=function(){},i([s,c("TableView/TableViewItem")],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],TableViewLine:[function(t,e,n){"use strict";cc._RF.push(e,"7db7eu5Wk1Hwak9JA+8OUCp","TableViewLine");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("./TableViewItem")),c=cc._decorator,l=c.ccclass,u=c.property,p=c.menu,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.content=null,e.countPerRow=1,e.titleNode=null,e.labelTitle=null,e.btnFolded=null,e._titleTopDist=0,e._contentTopPadding=0,e._spaceX=0,e._spaceY=0,e._mainData=null,e._childrenData=[],e._children=[],e._childrenRequests=[],e._rows=0,e._showRows=0,e._btnFoldedImgNode=null,e}return r(e,t),e.prototype.onLoad=function(){var t=this.content.getBoundingBox();this.content.setAnchorPoint(cc.v2(.5,1)),this.content.setPosition(t.center.x,t.yMax);var e=this.node.height*(1-this.node.anchorY);this._contentTopPadding=e-t.yMax,this.titleNode&&(this._titleTopDist=e-this.titleNode.y)},e.prototype.onDestroy=function(){this.clear()},e.prototype.setSpaceX=function(t){this._spaceX=t},e.prototype.setSpaceY=function(t){this._spaceY=t},e.prototype.setItemPool=function(t){this._itemPool=t},e.prototype.setRequests=function(t,e){this._requestItem=t,this._cancelRequest=e},e.prototype.setItemTempalte=function(t){this._itemTemplate=t;var e=t.node;this._itemSize=e.getContentSize(),this._itemApOffset=cc.v2(e.width*e.anchorX,e.height*(1-e.anchorY))},e.prototype.init=function(e,n){t.prototype.init.call(this,e,n),this._mainData=e,e.title&&(this.labelTitle.string=e.title),this._childrenData=e.data,this._showRows=this._rows=Math.ceil(this._childrenData.length/this.countPerRow);var o=null!=e.isFolded||null!=e.rowsWhenFolded;o&&(e.isFolded=!!e.isFolded,e.rowsWhenFolded=e.rowsWhenFolded>0?e.rowsWhenFolded:1,this._showRows=e.isFolded?Math.min(this._rows,e.rowsWhenFolded):this._rows),this.btnFolded&&(this.btnFolded.node.active=o,this._btnFoldedImgNode||(this._btnFoldedImgNode=this.btnFolded.node.getComponentInChildren(cc.Sprite).node),this.btnFolded.node.targetOff(this),o&&this.btnFolded.node.on("click",this.toggleFold,this),this._btnFoldedImgNode.angle=this._mainData.isFolded?0:-90),this.clear(),this._children.length=this._childrenData.length,this._childrenRequests.length=this._childrenData.length,this.computeLayout(),this.resetSize(),this.computeRowRect(),e.lineData&&this.initWithLineData(e.lineData)},e.prototype.initWithLineData=function(){},e.prototype.fold=function(){this._mainData.isFolded||this.toggleFold()},e.prototype.unfold=function(){this._mainData.isFolded&&this.toggleFold()},e.prototype.toggleFold=function(){this._mainData.isFolded=!this._mainData.isFolded,this._showRows=this._mainData.isFolded?Math.min(this._rows,this._mainData.rowsWhenFolded):this._rows,this._btnFoldedImgNode&&(this._btnFoldedImgNode.angle=this._mainData.isFolded?0:-90),this.resetSize(),this._tableView.reLayout(),this.computeRowRect()},e.prototype.onUnuse=function(){this.clear()},e.prototype.computeSize=function(t){var e=this.node.width,n=Math.ceil(t.data.length/this.countPerRow);(null!=t.isFolded||null!=t.rowsWhenFolded)&&t.isFolded&&(n=Math.min(n,t.rowsWhenFolded));var o=n*this._itemSize.height+(n-1)*this._spaceY+this._contentTopPadding;return cc.size(e,o)},e.prototype.computeLayout=function(){this.computeFirstLinePos();for(var t=this._childrenData.length,e=this._childrenPos.length;e<t;++e){var n=Math.floor(e/this.countPerRow),o=e%this.countPerRow,r=cc.v2(0,-n*(this._spaceY+this._itemSize.height));r.addSelf(this._firstRowPos[o]),this._childrenPos.push(r)}},e.prototype.computeFirstLinePos=function(){if(!this._firstRowPos){this._firstRowPos=[],this._childrenPos=[];for(var t=this._itemSize.width,e=this.countPerRow*t+(this.countPerRow-1)*this._spaceX,n=(this.content.width-e)/2,o=this.content.width*this.content.anchorX,r=0;r<this.countPerRow;++r){var i=cc.v2(n+r*(t+this._spaceX)+this._itemApOffset.x-o,-this._itemApOffset.y);this._firstRowPos.push(i),this._childrenPos.push(i)}}},e.prototype.computeChildPos=function(t){this.computeFirstLinePos();var e=Math.floor(t/this.countPerRow),n=t%this.countPerRow,o=cc.v2(0,-e*(this._spaceY+this._itemSize.height));return o.addSelf(this._firstRowPos[n]),o},e.prototype.computeRowRect=function(){var t=new cc.Mat4;this.content.getLocalMatrix(t);var e=new cc.Mat4;this.node.getLocalMatrix(e),e.mul(t,e);var n=this.content.width,o=this._itemSize.height,r=-n/2;this._rowRectInParent=[];for(var i=0;i<this._rows;++i){var a=-this._itemSize.height*(i+1)-i*this._spaceY,s=cc.rect(r,a,n,o);s.transformMat4(s,e),this._rowRectInParent.push(s)}},e.prototype.resetSize=function(){var t=this._showRows*this._itemSize.height+Math.max(0,this._showRows-1)*this._spaceY;this.node.height=t+this._contentTopPadding,this.content.height=t;var e=this.node.height*(1-this.node.anchorY);this.content.y=e-this._contentTopPadding,this.titleNode&&(this.titleNode.y=e-this._titleTopDist)},e.prototype.onCull=function(t){for(var e=this,n=this._childrenData.length,o=0;o<this._rows;++o)for(var r=this._rowRectInParent[o],i=!(o>=this._showRows)&&r.intersects(t),a=o*this.countPerRow,s=function(t){var o=t+a;if(o>=n)return"break";var r,s=c._children[o];i?s?s.node.active=!0:(r=c._childrenRequests[o])||(c._childrenRequests[o]=c._requestItem(function(t){e._childrenRequests[o]=null,t.node.parent=e.content,t.node.setPosition(e._childrenPos[o]),t.init(e._childrenData[o],e._tableView),e._children[o]=t})):s?(c.unuseChild(s),c._children[o]=null):(r=c._childrenRequests[o])&&c._cancelRequest(r)},c=this,l=0;l<this.countPerRow&&"break"!==s(l);++l);},e.prototype.clear=function(){for(var t=this._children.length-1;t>=0;--t){var e=this._children[t];e&&this.unuseChild(e)}for(this._children.splice(0),t=this._childrenRequests.length-1;t>=0;--t){var n=this._childrenRequests[t];n&&this._cancelRequest(n)}this._childrenRequests.splice(0)},e.prototype.unuseChild=function(t){t&&(t.onUnuse(),this._itemPool.put(t.node))},e.prototype.getChildren=function(){return this._children},i([u(cc.Node)],e.prototype,"content",void 0),i([u],e.prototype,"countPerRow",void 0),i([u(cc.Node)],e.prototype,"titleNode",void 0),i([u(cc.Label)],e.prototype,"labelTitle",void 0),i([u(cc.Button)],e.prototype,"btnFolded",void 0),i([l,p("TableView/TableViewLine")],e)}(s.default);n.default=f,cc._RF.pop()},{"./TableViewItem":"TableViewItem"}],TableView:[function(t,e,n){"use strict";cc._RF.push(e,"6b37dQfVExCWquL2llt11iM","TableView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../../../Debug/Profiler"),u=c(t("../../../Utils/Utils")),p=c(t("./TableViewItem")),f=c(t("./TableViewLine")),h=cc._decorator,d=h.ccclass,y=h.property,_=h.menu,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemPrefab=null,e.linePrefab=null,e.isVertical=!0,e.paddingLeft=0,e.paddingRight=0,e.paddingTop=0,e.paddingBottom=0,e.spaceX=0,e.spaceY=0,e._isInited=!1,e._isItemPoolExternal=!1,e._isLinePoolExternal=!1,e._isLineData=!1,e._children=[],e._childrenPos=[],e._childrenRect=[],e._childrenData=[],e._childrenRequests=[],e._requests=[],e._requestMaxHandle=0,e}return r(e,t),Object.defineProperty(e.prototype,"scroll",{get:function(){return this._scroll},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataCount",{get:function(){return this._childrenData?this._childrenData.length:0},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._scroll=this.getComponent(cc.ScrollView),this._content=this._scroll.content,this._mask=this.getComponentInChildren(cc.Mask).node,this._scroll.vertical=this.isVertical,this._scroll.horizontal=!this.isVertical,this._itemPool=new cc.NodePool,this._linePool=new cc.NodePool,this._isItemPoolExternal=!0,this._isLinePoolExternal=!0,this._itemTemplate=cc.instantiate(this.itemPrefab).getComponent(p.default),this._itemTemplate.node.parent=this.node,this._itemTemplate.node.active=!1,this.linePrefab&&(this._lineTemplate=cc.instantiate(this.linePrefab).getComponent(f.default),this._lineTemplate.node.parent=this.node,this._lineTemplate.node.active=!1,this._initLine(this._lineTemplate)),this._scroll.vertical?this._content.setAnchorPoint(cc.v2(.5,1)):this._content.setAnchorPoint(cc.v2(0,.5)),this._content.on(cc.Node.EventType.POSITION_CHANGED,this.cull,this),this._content.getComponent(cc.Layout)&&(cc.error("[TableView] content should not has 'cc.Layout' component!! node path: "+u.default.getNodePath(this.node)),this._content.removeComponent(cc.Layout))},e.prototype.onDestroy=function(){!this._isItemPoolExternal&&this._itemPool.clear&&this._itemPool.clear(),!this._isLinePoolExternal&&this._linePool.clear&&this._linePool.clear()},e.prototype.cull=function(){var t=this,e=this._mask.getBoundingBox(),n=new cc.Mat4;this._mask.parent.getWorldMatrix(n),e.transformMat4(e,n);var o=new cc.Mat4;this._content.getWorldMatrix(o),o.invert(o),e.transformMat4(e,o),this._lastViewRect=e;for(var r=function(n){var o,r=i._childrenRect[n].intersects(e),a=i._children[n];r?a?(a.node.active=!0,a.onCull(e)):(o=i._childrenRequests[n])||(i._childrenRequests[n]=i._requestChild(function(e){t._childrenRequests[n]=null,e.node.parent=t._content,e.node.setPosition(t._childrenPos[n]),e.init(t._childrenData[n],t),e.onCull(t._lastViewRect),t._children[n]=e})):a?(i._unuseChild(a),i._children[n]=null):(o=i._childrenRequests[n])&&(i._cancelRequest(o),i._childrenRequests[n]=null)},i=this,a=0;a<this._children.length;a++)r(a)},e.prototype.setItemPool=function(t){this._itemPool=t,this._isItemPoolExternal=!0},e.prototype.setLinePool=function(t){this._linePool=t,this._isLinePoolExternal=!0},e.prototype.setItemsData=function(t){this._isLineData=!1,this._childrenData=t,this.clear(),this._children.length=t.length,this._childrenRequests.length=t.length,this.computeLayout(),this.cull(),this._setInited()},e.prototype.setLinesData=function(t){this._isLineData=!0,this._childrenData=t,this.clear(),this._children.length=t.length,this._childrenRequests.length=t.length,this.computeLayout(),this.cull(),this._setInited()},e.prototype.reLayout=function(){this.computeLayout();for(var t=0;t<this._children.length;t++){var e=this._children[t];e&&e.node.setPosition(this._childrenPos[t])}this.cull()},e.prototype.computeLayout=function(){var t,e,n=this._scroll.vertical,o=n?this.paddingTop:this.paddingLeft,r=this._isLineData?this._lineTemplate:this._itemTemplate,i=r.node.getAnchorPoint();this._childrenPos.splice(0),this._childrenRect.splice(0);try{for(var s=a(this._childrenData),c=s.next();!c.done;c=s.next()){var l=c.value,u=r.computeSize(l),p=void 0;n?(p=cc.v2(0,-o-u.height*(1-i.y)),o+=u.height+this.spaceY):(p=cc.v2(o+u.width*i.x,0),o+=u.width+this.spaceX);var f=cc.rect(p.x-u.width*i.x,p.y-u.height*i.y,u.width,u.height);this._childrenPos.push(p),this._childrenRect.push(f)}}catch(h){t={error:h}}finally{try{c&&!c.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}o+=n?this.paddingBottom:this.paddingRight,n?this._content.height=o:this._content.width=o},e.prototype.clear=function(){for(var t=this._isLineData?this._linePool:this._itemPool,e=this._children.length-1;e>=0;--e){var n=this._children[e];n&&(n.onUnuse(),t.put(n.node))}for(this._children.splice(0),e=this._childrenRequests.length-1;e>=0;--e){var o=this._childrenRequests[e];o&&this._cancelRequest(o)}this._childrenRequests.splice(0)},e.prototype.setHighlight=function(t){var e=this._findNodeIndex(t),n=s(e,2),o=n[0],r=n[1],i=this._children[o];if(i)for(var a=null!=r?i:null,c=0;c<a.getChildren().length;c++)a.getChildren()[c].onHighlight(c==r)},e.prototype.showNode=function(t,e,n){var o=this;e<0&&(e=0),this._requireInited(function(){var r=o._findNodeIndex(t);if(null!=r){var i=s(r,2),a=i[0],c=i[1],l=cc.v2(o._childrenPos[a]);if(null!=c&&l.addSelf(o._lineTemplate.computeChildPos(c)),o.isVertical){var u=1- -l.y/o._content.height;o._scroll.scrollToPercentVertical(u,e)}else u=l.x/o._content.width,o._scroll.scrollToPercentHorizontal(u,e);o.scheduleOnce(function(){var t=o._children[a];if(t){var e=null!=c?t:null,r=e?e.getChildren()[c]:t;if(r)n&&n(r.node);else var i=setInterval(function(){var t=e?e.getChildren()[c]:o._children[a];t&&(clearInterval(i),n&&n(t.node))})}},e)}else n&&n(null)})},e.prototype._requireInited=function(t){this._isInited?t&&t():this._onInit?this._onInit.push(t):this._onInit=[t]},e.prototype._setInited=function(){this._isInited||(this._isInited=!0,this._onInit&&(this._onInit.forEach(function(t){return t()}),this._onInit=null))},e.prototype._findNodeIndex=function(t){var e="function"==typeof t;if(this._isLineData){for(var n=0;n<this._childrenData.length;n++)for(var o=this._childrenData[n].data,r=0;r<o.length;++r)if(e&&t(o[r])||!e&&o[r]===t)return[n,r]}else for(n=0;n<this._childrenData.length;n++)if(e&&t(this._childrenData[n])||!e&&this._childrenData[n]===t)return[n,null]},e.prototype._unuseChild=function(t){var e=this._isLineData?this._linePool:this._itemPool;t.onUnuse(),e.put(t.node)},e.prototype._handleRequests=function(){var t,e;if(this._requests.length>0){var n=Date.now();do{var o=this._requests.shift();if(o.isItem){var r=(null!==(t=this._itemPool.get())&&void 0!==t?t:cc.instantiate(this.itemPrefab)).getComponent(p.default);o.callback(r)}else r=(null!==(e=this._linePool.get())&&void 0!==e?e:cc.instantiate(this.linePrefab)).getComponent(f.default),this._initLine(r),o.callback(r)}while(this._requests.length>0&&Date.now()-n<2)}0===this._requests.length&&(this.unschedule(this._requestFunc),this._requestFunc=null)},e.prototype._cancelRequest=function(t){for(var e=0;e<this._requests.length;e++)if(this._requests[e].handle===t){this._requests.splice(e,1);break}},e.prototype._requestChild=function(t){return this._isLineData?this._requestLine(t):this._requestItem(t)},e.prototype._requestItem=function(t){var e=++this._requestMaxHandle;return this._requests.push({isItem:!0,handle:e,callback:t}),this._requestFunc||(this._requestFunc=this._handleRequests.bind(this),this.schedule(this._requestFunc,0)),e},e.prototype._requestLine=function(t){var e=++this._requestMaxHandle;return this._requests.push({isItem:!1,handle:e,callback:t}),this._requestFunc||(this._requestFunc=this._handleRequests.bind(this),this.schedule(this._requestFunc,0)),e},e.prototype._initLine=function(t){t.setSpaceX(this.spaceX),t.setSpaceY(this.spaceY),t.setItemTempalte(this._itemTemplate),t.setItemPool(this._itemPool),t.setRequests(this._requestItem.bind(this),this._cancelRequest.bind(this))},i([y(cc.Prefab)],e.prototype,"itemPrefab",void 0),i([y(cc.Prefab)],e.prototype,"linePrefab",void 0),i([y],e.prototype,"isVertical",void 0),i([y({displayName:"[H] Padding Left"})],e.prototype,"paddingLeft",void 0),i([y({displayName:"[H] Padding Right"})],e.prototype,"paddingRight",void 0),i([y({displayName:"[V] Padding Top"})],e.prototype,"paddingTop",void 0),i([y({displayName:"[V] Padding Bottom"})],e.prototype,"paddingBottom",void 0),i([y({displayName:"Space X"})],e.prototype,"spaceX",void 0),i([y({displayName:"Space Y"})],e.prototype,"spaceY",void 0),i([l.profile("cull")],e.prototype,"cull",null),i([l.profile("request")],e.prototype,"_handleRequests",null),i([d,_("TableView/TableView")],e)}(cc.Component);n.default=g,cc._RF.pop()},{"../../../Debug/Profiler":"Profiler","../../../Utils/Utils":"Utils","./TableViewItem":"TableViewItem","./TableViewLine":"TableViewLine"}],TagType:[function(t,e,n){"use strict";cc._RF.push(e,"cad29wj3+hAKrRO1Q7zl2M5","TagType"),Object.defineProperty(n,"__esModule",{value:!0}),n.TagType=void 0,function(t){t.Player="Player",t.Beast="Beast",t.Guard="Guard",t.Enemy="Enemy",t.Archer="Archer",t.Magic="Magic",t.Melee="Melee"}(n.TagType||(n.TagType={})),cc._RF.pop()},{}],TalkConfig:[function(t,e,n){"use strict";cc._RF.push(e,"33b232U+whMe4FaNta8cyt7","TalkConfig"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],TalkView:[function(t,e,n){"use strict";cc._RF.push(e,"cf77fT2bqROpJ8PVnzg15vj","TalkView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../Module/ConfigManager"),u=c(t("../Module/ViewHandler")),p=c(t("../Utils/Path")),f=c(t("../Utils/Utils")),h=cc._decorator,d=h.ccclass,y=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.left=null,e.right=null,e.textNode=null,e._callback=null,e._textArr=[],e._talkGroupId=null,e._data=null,e._curIndex=0,e}return r(e,t),e.prototype.initiateView=function(t){this._callback=t.cb,this._talkGroupId=t.id,this._data=l.ConfigManager.instance.getTalkConfig(this._talkGroupId),this.initRole(),this.initStrArr(),f.default.localize(this.labelTitle,"ui_shop"),this.onNext()},e.prototype.initRole=function(){return a(this,void 0,void 0,function(){var t,e,n,o;return s(this,function(){return t=this.left.getComponent(cc.Sprite),e=p.default.getAvatar(this._data.left),f.default.loadImg(t,e,100),n=this.right.getComponent(cc.Sprite),o=p.default.getAvatar(this._data.right),f.default.loadImg(n,o,100),[2]})})},e.prototype.initStrArr=function(){for(var t=0;t<this._data.orders.length;t++){var e=this._data.orders[t],n="talk_"+this._talkGroupId+"_"+(t+1),o=l.ConfigManager.instance.getLanConfig(n),r=this.left,i=this.right;2==e&&(i=this.left,r=this.right);var a={highLightNode:r,lowLightNode:i,str:o};this._textArr.push(a)}},e.prototype.onNext=function(){var t=this._textArr[this._curIndex];t?(f.default.gray(t.lowLightNode),f.default.ungray(t.highLightNode),this._curIndex++):this.onConfirm()},e.prototype.onConfirm=function(){this.close(),this._callback()},i([y(cc.Label)],e.prototype,"labelTitle",void 0),i([y(cc.Node)],e.prototype,"left",void 0),i([y(cc.Node)],e.prototype,"right",void 0),i([y(cc.Node)],e.prototype,"textNode",void 0),i([d],e)}(u.default);n.default=_,cc._RF.pop()},{"../Module/ConfigManager":"ConfigManager","../Module/ViewHandler":"ViewHandler","../Utils/Path":"Path","../Utils/Utils":"Utils"}],Terrain:[function(t,e,n){"use strict";cc._RF.push(e,"f4965fWvvRKrZ2gayCNF2Nn","Terrain");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Utils/Utils")),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerPos=null,e.guardSpawnPos=null,e.enemySpawnPos=null,e.guardFrontierPos=null,e}return r(e,t),e.prototype.init=function(){s.default.updateAlignmentRecursively(this.node),this.playerPosition=this.playerPos.getPosition(),this.guardSpawnPosition=this.guardSpawnPos.getPosition(),this.guardFrontierY=this.guardFrontierPos.getPosition().y},e.prototype.getRandEnemyPos=function(){for(var t=[],e=0;e<this.enemySpawnPos.children.length;e++){var n=this.enemySpawnPos.children[e],o=n.getPosition(),r=n.getBoundingBox();t.push({position:o,rect:r})}var i=s.default.shuffle(t)[0],a=i.position,c=s.default.randomRange(i.rect.xMin,i.rect.xMax);return a.add(cc.v2(c,0))},i([u(cc.Node)],e.prototype,"playerPos",void 0),i([u(cc.Node)],e.prototype,"guardSpawnPos",void 0),i([u(cc.Node)],e.prototype,"enemySpawnPos",void 0),i([u(cc.Node)],e.prototype,"guardFrontierPos",void 0),i([l],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../../Utils/Utils":"Utils"}],Timer:[function(t,e,n){"use strict";cc._RF.push(e,"c616dMP3zRClJ/Mu6JKyAxc","Timer");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0}),n.CountdownTimer=n.IntervalTimer=n.Timer=void 0;var i=function(){function t(){this._elapsed=0}return t.prototype.step=function(t){this._elapsed+=t},Object.defineProperty(t.prototype,"elapsed",{get:function(){return this._elapsed},enumerable:!1,configurable:!0}),t}();n.Timer=i;var a=function(t){function e(e,n,o,r){void 0===r&&(r=null);var i=t.call(this)||this;return i._action=e,i._interval=n,i._times=o,i._delay=r,null==r&&(r=n),i._countdown=r,i}return r(e,t),e.prototype.isDone=function(){return this._times<=0},e.prototype.step=function(e){for(t.prototype.step.call(this,e),this._countdown-=e;this._countdown<=0&&this._times>0;)this._countdown+=this._interval,this._action(),this._times-=1},e}(i);n.IntervalTimer=a;var s=function(t){function e(e,n){return t.call(this,e,0,1,n)||this}return r(e,t),e}(a);n.CountdownTimer=s,cc._RF.pop()},{}],ToastView:[function(t,e,n){"use strict";cc._RF.push(e,"5f015hxwaxEyZMz9S3I/Nby","ToastView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},s=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=c(t("../Module/ViewHandler")),u=c(t("../Utils/Utils")),p=cc._decorator,f=p.ccclass,h=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelContent=null,e}return r(e,t),e.prototype.initiateView=function(t){var e=this;this.labelContent.string=u.default.replaceStr.apply(u.default,s([t.fmt],t.args)),cc.tween(this.node).to(2,{y:100}).delay(1).call(function(){e.close()}).start()},i([h(cc.Label)],e.prototype,"labelContent",void 0),i([f],e)}(l.default);n.default=d,cc._RF.pop()},{"../Module/ViewHandler":"ViewHandler","../Utils/Utils":"Utils"}],TweenFX:[function(t,e,n){"use strict";cc._RF.push(e,"2701a/HOcBG6IJoTsbooWgc","TweenFX");var o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},r=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var a,s,c=i(t("./Utils"));(function(t){t[t.Line=0]="Line",t[t.Arc=1]="Arc",t[t.Boom=2]="Boom"})(a||(a={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Up=2]="Up",t[t.Bottom=3]="Bottom",t[t.Random=4]="Random"}(s||(s={}));var l={generateGap:.1,arcSide:s.Random,boomRange:100},u=function(){function t(){}return t.getTopContainer=function(){return this._topContainer||(this._topContainer=cc.find("Canvas/MainCamera/TopUI/FX")),this._topContainer},t.getGlobalContainer=function(){return this._globalContainer||(this._globalContainer=cc.find("Canvas/MainCamera/FX")),this._globalContainer},t.collect=function(t){var e,n,i,u,p,f,h,d=this;if(t){var y=t.template,_=t.destroyHandler,g=t.count,v=t.fromWorldPos,m=t.toWorldPos,b=t.moveType,w=t.duration,S=t.speed,C=t.scale,A=t.container,M=t.onFinish;if(Array.isArray(y)||(y=[y]),Array.isArray(g)||(g=[g]),y.length===g.length){if(null==w){if(null==S)return void console.warn("[TweenFX] collect, lack of 'speed' or 'duration' in config!");w=cc.Vec2.distance(v,m)/S}A||(cc.isValid(this._container,!0)||(this._container=this.getTopContainer()),A=this._container);var P=A.convertToNodeSpaceAR(v),E=A.convertToNodeSpaceAR(m);if(b===a.Line){for(var O=null!==(i=t.generateGap)&&void 0!==i?i:l.generateGap,R=0;R<y.length;++R)for(var T=y[R],I=g[R],N=function(t){var e=D.instantiate(T);e.parent=A,e.setPosition(P),cc.tween(e).hide().delay(t*O).show().to(w,{position:cc.v3(E),scale:null!=C?C:e.scale},{easing:"quadIn"}).call(function(){return d.destroy(e,_)}).start()},D=this,x=0;x<I;++x)N(x);if(M){var B=Math.max.apply(Math,r(g))*O+w;setTimeout(M,1e3*B)}}else if(b===a.Arc){O=null!==(u=t.generateGap)&&void 0!==u?u:l.generateGap;var L=null!==(p=t.arcSide)&&void 0!==p?p:l.arcSide,k=cc.Vec2.lerp(cc.v2(),P,E,.3),U=cc.Vec2.lerp(cc.v2(),P,E,.7),G=cc.Vec2.distance(P,E)/5,j=E.sub(P).rotate(Math.PI/2).normalizeSelf().mulSelf(G),V=j.mul(-1),F=E.x<P.x,H=k.add(j),W=U.add(j),z=k.add(V),q=U.add(V),Y=!0;L===s.Left?Y=!0:L===s.Right?Y=!1:L===s.Up?Y=!F:L===s.Bottom?Y=F:L===s.Random&&(Y=Math.random()<.5);var K=Y?H:z,J=Y?W:q;for(R=0;R<y.length;++R){T=y[R],I=g[R];var X=function(t){var e=Q.instantiate(T);e.parent=A,e.setPosition(P),e.runAction(cc.sequence(cc.hide(),cc.delayTime(t*O),cc.show(),cc.spawn(cc.bezierTo(w,[K,J,E]).easing(cc.easeQuadraticActionIn()),cc.scaleTo(w,null!=C?C:e.scale)),cc.callFunc(function(){return d.destroy(e,_)})))},Q=this;for(x=0;x<I;++x)X(x)}M&&(B=Math.max.apply(Math,r(g))*O+w,setTimeout(M,1e3*B))}else if(b===a.Boom){var Z=[];for(R=0;R<y.length;++R)for(T=y[R],I=g[R],x=0;x<I;++x){var $=this.instantiate(T);$.parent=A,$.setPosition(P),Z.push($)}O=null!==(f=t.generateGap)&&void 0!==f?f:l.generateGap,c.default.shuffle(Z);var tt=c.default.randomRange(0,360),et=360/Z.length,nt=null!==(h=t.boomRange)&&void 0!==h?h:l.boomRange,ot=void 0,rt=void 0;nt instanceof Array?(e=o(nt,2),ot=e[0],rt=e[1]):(n=o([0,nt],2),ot=n[0],rt=n[1]);var it=function(t){var e=Z[t],n=(tt+et*t)%360,o=c.default.randomRange(ot,rt),r=P.add(cc.Vec2.RIGHT.rotate(n/2/Math.PI).mul(o));e.runAction(cc.sequence(cc.hide(),cc.delayTime(O*t),cc.show(),cc.spawn(cc.bezierTo(w,[r,r,E]),cc.scaleTo(w,null!=C?C:e.scale)),cc.callFunc(function(){return d.destroy(e,_)})))};for(R=0;R<Z.length;++R)it(R);M&&(B=w,setTimeout(M,1e3*B))}}else console.warn("[TweenFx] collect, template.length ("+y.length+") != count.length ("+g.length+")!")}},t.instantiate=function(t){return t instanceof Function?t():cc.instantiate(t)},t.destroy=function(t,e){e?e(t):t.destroy()},t.MoveType=a,t.ArcSide=s,t}();n.default=u,cc._RF.pop()},{"./Utils":"Utils"}],UniqueView:[function(t,e,n){"use strict";cc._RF.push(e,"9e96fGfK2ZAbI1npKHhaMuY","UniqueView"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t){this._views=t}return t.prototype.show=function(t){for(var e=0;e<this._views.length;e++){var n=this._views[e];n.active=n===t}},t}();n.default=o,cc._RF.pop()},{}],UpCard:[function(t,e,n){"use strict";cc._RF.push(e,"30b86BIBG5FN6xa5zu3+3gN","UpCard");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../Module/ConfigManager"),u=c(t("../Utils/Path")),p=c(t("../Utils/Utils")),f=c(t("../Module/Loader")),h=cc._decorator,d=h.ccclass,y=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showCaseNode=null,e.resultNode=null,e.symbol1=null,e.symbol2=null,e.symbolEqual=null,e.lineNode=null,e.labelTrans=null,e._destroyUids=[],e._guardId=null,e._config=null,e._entityManager=null,e.cb=null,e}return r(e,t),e.prototype.init=function(t,e,n){this._entityManager=t,this.cb=n,this._destroyUids=e.destroyUids||[],this._guardId=e.guardId,this._config=l.ConfigManager.instance.getGuardConfig(this._guardId);var o=this._destroyUids.length;0==o?(this.symbol1.active=!1,this.symbol2.active=!1,this.symbolEqual.active=!1,this.resultNode.x=-55):1==o?(this.symbol1.active=!1,this.symbol2.active=!1,this.symbolEqual.x=-145,p.default.localize(this.labelTrans,"ui_evolution")):2==o?(this.symbol2.active=!1,this.symbol1.x=-290,p.default.localize(this.labelTrans,"ui_sacrifice")):3==o&&(this.symbol2.x=-340,this.symbol1.x=-230,this.symbolEqual.x=-90,p.default.localize(this.labelTrans,"ui_sacrifice"));for(var r=0;r<o;r++){var i=this._destroyUids[r];this.showGuard(i)}this.showGuard(null)},e.prototype.showGuard=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a,c;return s(this,function(s){switch(s.label){case 0:return e=this._config,n=this.resultNode,t&&(o=this._entityManager.getGuard(t),e=o.config,n=this.showCaseNode),r=u.default.getEntityPath(e.asset),[4,f.default.loadResAsync(r,cc.Prefab,null)];case 1:return i=s.sent(),(a=cc.instantiate(i)).parent=n,c=a.getChildByName("labelName").getComponent(cc.Label),p.default.localize(c,"guard_"+e.id+"_name"),[2]}})})},e.prototype.onChoose=function(){this.cb&&this.cb()},i([y(cc.Node)],e.prototype,"showCaseNode",void 0),i([y(cc.Node)],e.prototype,"resultNode",void 0),i([y(cc.Node)],e.prototype,"symbol1",void 0),i([y(cc.Node)],e.prototype,"symbol2",void 0),i([y(cc.Node)],e.prototype,"symbolEqual",void 0),i([y(cc.Node)],e.prototype,"lineNode",void 0),i([y(cc.Label)],e.prototype,"labelTrans",void 0),i([d],e)}(cc.Component);n.default=_,cc._RF.pop()},{"../Module/ConfigManager":"ConfigManager","../Module/Loader":"Loader","../Utils/Path":"Path","../Utils/Utils":"Utils"}],UpgradeCard:[function(t,e,n){"use strict";cc._RF.push(e,"95657FjVj5BJ6MAMHVoUTVp","UpgradeCard");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../Module/ConfigManager"),c=a(t("../Utils/Path")),l=a(t("../Utils/Utils")),u=cc._decorator,p=u.ccclass,f=u.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelName=null,e.showCaseNode=null,e.guardImg=null,e.guardQuality=null,e._destroyUids=[],e._guardId=null,e._config=null,e._entityManager=null,e.cb=null,e}return r(e,t),e.prototype.init=function(t,e,n){this._entityManager=t,this.cb=n,this._destroyUids=e.destroyUids||[],this._guardId=e.guardId,this._config=s.ConfigManager.instance.getGuardConfig(this._guardId),this.showCaseNode.active=this._destroyUids.length>0;for(var o=0;o<this.showCaseNode.children.length;o++)this.showCaseNode.children[o].active=!1;for(o=0;o<this._destroyUids.length;o++){this.showCaseNode.children[o].active=!0;var r=this._destroyUids[o],i=this.showCaseNode.children[o].getChildByName("imgSlaveAvatar").getComponent(cc.Sprite);this.showGuardImg(r,i)}this.showCardInfo()},e.prototype.showCardInfo=function(){var t=this._config,e="guard_"+this._guardId+"_name";l.default.localize(this.labelName,e);var n=c.default.getAvatar(t.avatarAsset);l.default.loadImg(this.guardImg,n,100);var o=c.default.getGuardQualityPath(this._config.quality);l.default.loadImg(this.guardQuality,o)},e.prototype.showGuardImg=function(t,e){var n=t,o=this._entityManager.getGuard(n),r=c.default.getAvatar(o.config.avatarAsset);l.default.loadImg(e,r,60)},e.prototype.onClick=function(){this.cb&&this.cb()},i([f(cc.Label)],e.prototype,"labelName",void 0),i([f(cc.Node)],e.prototype,"showCaseNode",void 0),i([f(cc.Sprite)],e.prototype,"guardImg",void 0),i([f(cc.Sprite)],e.prototype,"guardQuality",void 0),i([p],e)}(cc.Component);n.default=h,cc._RF.pop()},{"../Module/ConfigManager":"ConfigManager","../Utils/Path":"Path","../Utils/Utils":"Utils"}],UpgradeConfig:[function(t,e,n){"use strict";cc._RF.push(e,"e0f71sHNBZLIaPTV0HDJW7x","UpgradeConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.UpgradeType=void 0,function(t){t[t.SummonGuard=0]="SummonGuard",t[t.UpgradeGuard=1]="UpgradeGuard"}(n.UpgradeType||(n.UpgradeType={})),cc._RF.pop()},{}],UpgradeView:[function(t,e,n){"use strict";cc._RF.push(e,"e8fcemmwG9P7KW4QiDKJxxj","UpgradeView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../Interface/Config/UpgradeConfig"),u=c(t("../Module/ViewHandler")),p=c(t("../Utils/Utils")),f=t("../Gameplay/System/AdSystem"),h=t("../Module/Statistics"),d=t("../Enum/WatchAdStatus"),y=c(t("../Module/ViewModule")),_=c(t("./UpCard")),g=cc._decorator,v=g.ccclass,m=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.card=null,e.cardNode=null,e.btnRefresh=null,e.labelRefresh=null,e._entityManager=null,e._onClose=null,e._battle=null,e}return r(e,t),e.prototype.initiateView=function(t){var e=t.battle,n=t.upgradeConfig,o=t.onClose;this._battle=e,this._entityManager=this._battle.entityManager,this._onClose=o,p.default.localize(this.labelRefresh,"ui_refresh"),this.initCard(n.upgradeOptions)},e.prototype.initCard=function(t){var e=this;this.cardNode.removeAllChildren();for(var n=function(n){var r=cc.instantiate(o.card);r.parent=o.cardNode;var i=r.getComponent(_.default),a=t[n];i.init(o._entityManager,a,function(){e.selectOption(a,e._entityManager)})},o=this,r=0;r<t.length;r++)n(r)},e.prototype.onRefresh=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,f.AdSystem.instance.showVideoAd(h.VideoAdType.RefreshGuard)];case 1:return e.sent()===d.WatchAdStatus.Success?(t=this._battle.randomUpgradeOptions().upgradeOptions,t=p.default.shuffle(t),this.initCard(t)):y.default.instance.toast("toast_ad_failed"),[2]}})})},e.prototype.selectOption=function(t,e){switch(t.type){case l.UpgradeType.SummonGuard:e.createGuard(t.guardId,{pos:this._battle.getGuardSpawnPos()});break;case l.UpgradeType.UpgradeGuard:e.upgradeGuard(t.guardId,t.destroyUids)}this.close(),this._onClose()},i([m(cc.Prefab)],e.prototype,"card",void 0),i([m(cc.Node)],e.prototype,"cardNode",void 0),i([m(cc.Button)],e.prototype,"btnRefresh",void 0),i([m(cc.Label)],e.prototype,"labelRefresh",void 0),i([v],e)}(u.default);n.default=b,cc._RF.pop()},{"../Enum/WatchAdStatus":"WatchAdStatus","../Gameplay/System/AdSystem":"AdSystem","../Interface/Config/UpgradeConfig":"UpgradeConfig","../Module/Statistics":"Statistics","../Module/ViewHandler":"ViewHandler","../Module/ViewModule":"ViewModule","../Utils/Utils":"Utils","./UpCard":"UpCard"}],UserData:[function(t,e,n){"use strict";cc._RF.push(e,"2b8ebip709J477JZp9H0q9b","UserData"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],Utils:[function(t,e,n){"use strict";cc._RF.push(e,"ef620FmdiBJCZjynGPOJQB0","Utils");var o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../Module/Audio")),c=t("../Module/ConfigManager"),l=a(t("../Module/Loader")),u=a(t("./CryptoJsMini")),p=a(t("lodash")),f=a(t("./Path")),h=a(t("chinese-calendar")),d=function(){function t(){}return t.ensureStringLength=function(t,e,n){if(t.length>e)return t.slice(0,e);if(t.length<e){for(n=n||"A";t.length<e;)t+=n;return t.length>e?t.slice(0,e):t}return t},t.getAesString=function(t,e,n){e=this.ensureStringLength(e,32,"A"),n=this.ensureStringLength(n,16,"B");var o=u.default.enc.Utf8.parse(e),r=u.default.enc.Utf8.parse(n);return u.default.AES.encrypt(t,o,{iv:r,mode:u.default.mode.CBC,padding:u.default.pad.Pkcs7}).toString()},t.getDAesString=function(t,e,n){e=this.ensureStringLength(e,32,"A"),n=this.ensureStringLength(n,16,"B");var o=u.default.enc.Utf8.parse(e),r=u.default.enc.Utf8.parse(n);return u.default.AES.decrypt(t,o,{iv:r,mode:u.default.mode.CBC,padding:u.default.pad.Pkcs7}).toString(u.default.enc.Utf8)},t.getRandomCodeKey=function(t){for(var e="",n="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",o=n.length,r=0;r<(t||8);r++)e+=n.charAt(Math.floor(Math.random()*o));return e},t.encodeShareQuery=function(t){var e=[];for(var n in t)e.push(n+"="+t[n]);var o=e.join("&");return this.getAesString(o,"SDoisdfh21DGskdjFosdfIU2DFfs234d","126s7o8SdcDg8Rk9")},t.decodeShareQuery=function(t){for(var e={},n=this.getDAesString(t,"SDoisdfh21DGskdjFosdfIU2DFfs234d","126s7o8SdcDg8Rk9").split("&"),r=0;r<n.length;++r)try{var i=o(n[r].split("="),2),a=i[0],s=i[1];e[a]=s}catch(c){}return e},t.encode=function(t){return this.getAesString(t,"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA","1234567812345678")},t.decode=function(t){return this.getDAesString(t,"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA","1234567812345678")},t.encodeObject=function(e){var n={};for(var o in e){var r=e[o];n[o]=t.encode(JSON.stringify(r))}return n},t.decodeObject=function(e){var n={};for(var o in e){var r=e[o];if(null!=r){var i=t.decode(r);n[o]=""!=i?JSON.parse(i):null}else n[o]=null}return n},t.directionToAngle=function(t){return cc.misc.radiansToDegrees(cc.Vec2.RIGHT.signAngle(t))},t.isInRate=function(t){return Math.random()<t},t.randomRangeInt=function(t,e){return Math.floor(Math.random()*(e-t))+t},t.randomRange=function(t,e){return Math.random()*(e-t)+t},t.randomColor=function(){var t=this.randomRangeInt(0,256),e=this.randomRangeInt(0,256),n=this.randomRangeInt(0,256);return new cc.Color(t,e,n,255)},t.randomPointInRect=function(t){return cc.v2(this.randomRange(t.xMin,t.xMax),this.randomRange(t.yMin,t.yMax))},t.randomPointInCircle=function(t,e){var n=this.randomRange(0,2*Math.PI),o=Math.cos(n)*e,r=Math.sin(n)*e;return cc.v2(o,r).add(t)},t.freeze=function(e,n){if(void 0===n&&(n=!0),Object.freeze(e),n)for(var o in e){var r=e[o];"object"==typeof r&&t.freeze(r,n)}},t.arrayRemove=function(t,e){var n=t.indexOf(e);n>=0&&t.splice(n,1)},t.shuffle=function(t){for(var e,n=t.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1));e=o([t[r],t[n]],2),t[n]=e[0],t[r]=e[1]}return t},t.randomSelect=function(t){return 0===t.length?null:t[this.randomRangeInt(0,t.length)]},t.arrayEquals=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0},t.sliceArray=function(t,e){if(0===t.length)return[];for(var n=[],o=Math.ceil(t.length/e),r=0;r<o;++r)n.push(t.slice(r*e,(r+1)*e));return n},t.sortArray=function(t,e){if(0!==t.length){for(var n=[],o=0;o<t.length;++o){var r=t[o],i=e(r);n.push({element:r,key:i})}return n.sort(function(t,e){return t.key-e.key}),n.map(function(t){return t.element})}},t.randomByWeight=function(t){for(var e=t.reduce(function(t,e){return t+e},0),n=Math.ceil(Math.random()*e),o=0,r=0;r<t.length;r++)if(n<=(o+=t[r]))return r+1},t.isIntersect=function(t,e){for(var n=0;n<t.length;++n)for(var o=0;o<e.length;++o)if(t[n]===e[o])return!0;return!1},t.findMax=function(t,e){if(0===t.length)return null;for(var n=t[0],o=e(n),r=1;r<t.length;++r){var i=e(t[r]);i>o&&(n=t[r],o=i)}return n},t.findMin=function(t,e){if(0===t.length)return null;for(var n=t[0],o=e(n),r=1;r<t.length;++r){var i=e(t[r]);i<o&&(n=t[r],o=i)}return n},t.createMultiMap=function(t,e){var n=new Map;return t.forEach(function(t){var r=o(e(t),2),i=r[0],a=r[1];n.has(i)?n.get(i).push(a):n.set(i,[a])}),n},t.createMap=function(t,e){return new Map(t.map(function(t){return e(t)}))},t.loadImg=function(e,n,o){l.default.loadRes(n,cc.SpriteFrame,function(n){e.spriteFrame=n,null!=o&&t.scaleImg(e.node,n,o)},e)},t.scaleImg=function(t,e,n){var o=n/e.getRect().width,r=n/e.getRect().height,i=Math.min(o,r);t.scale=i;var a=e.getRect().width,s=e.getRect().height;t.width=a,t.height=s},t.gray=function(t,e){var n,o;void 0===e&&(e=!0);var i=t.getComponent(cc.RenderComponent);if(i){var a=cc.Material.getBuiltinMaterial("2d-gray-sprite");i[this.RAW_MAT_PROP]||(i[this.RAW_MAT_PROP]=i.getMaterial(0)),i.setMaterial(0,a)}if(e)try{for(var s=r(t.children),c=s.next();!c.done;c=s.next()){var l=c.value;this.gray(l,!0)}}catch(u){n={error:u}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},t.ungray=function(t,e){var n,o;void 0===e&&(e=!0);var i=t.getComponent(cc.RenderComponent);if(i){var a=i[this.RAW_MAT_PROP];a&&(i.setMaterial(0,a),delete i[this.RAW_MAT_PROP])}if(e)try{for(var s=r(t.children),c=s.next();!c.done;c=s.next()){var l=c.value;this.ungray(l,!0)}}catch(u){n={error:u}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},t.drawRect=function(t,e,n,o,r){void 0===o&&(o=cc.Vec2.ZERO),void 0===r&&(r=0),r%=360;var i=cc.v2(e/2,n/2),a=cc.v2(-e/2,n/2),s=cc.v2(-e/2,-n/2),c=cc.v2(e/2,-n/2);if(0!==r){var l=cc.misc.degreesToRadians(r);i.rotateSelf(l),a.rotateSelf(l),s.rotateSelf(l),c.rotateSelf(l)}0===o.x&&0===o.y||(i.addSelf(o),a.addSelf(o),s.addSelf(o),c.addSelf(o)),t.moveTo(i.x,i.y),t.lineTo(a.x,a.y),t.lineTo(s.x,s.y),t.lineTo(c.x,c.y),t.close(),t.stroke()},t.drawCircle=function(t,e,n){void 0===n&&(n=cc.Vec2.ZERO),t.circle(n.x,n.y,e),t.stroke()},t.drawFan=function(t,e,n,o,r){void 0===r&&(r=cc.Vec2.ZERO);var i=cc.misc.degreesToRadians(n),a=n+o,s=cc.misc.degreesToRadians(a),c=cc.v2(Math.cos(i)*e,Math.sin(i)*e);t.moveTo(r.x,r.y),t.lineTo(c.x+r.x,c.y+r.y),t.arc(r.x,r.y,e,i,s,!0),t.close(),t.stroke()},t.drawPolygon=function(t,e,n,o){if(void 0===n&&(n=cc.Vec2.ZERO),void 0===o&&(o=0),0!==e.length){if(e=p.default.cloneDeep(e),0!==o){var r=cc.misc.degreesToRadians(o);e.forEach(function(t){return t.rotateSelf(r)})}e.forEach(function(t){return t.addSelf(n)}),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;++i)t.lineTo(e[i].x,e[i].y);t.close(),t.stroke()}},t.drawBoundingBox=function(t,e){var n=e.getBoundingBoxToWorld();n=this.transformRectTo(t.node,n),this.drawRect(t,n.width,n.height,n.center)},t.drawCollider=function(t,e){var n=this.getOrAddComponent(t.node,cc.Graphics);if(n.strokeColor=null!=e?e:cc.Color.RED,n.lineWidth=5,n.clear(),t instanceof cc.BoxCollider){var o=t;this.drawRect(n,o.size.width,o.size.height,o.offset)}else if(t instanceof cc.CircleCollider){var r=t;this.drawCircle(n,r.radius,r.offset)}else if(t instanceof cc.PolygonCollider){var i=t;this.drawPolygon(n,i.points,i.offset)}},t.setCircleCollider=function(t,e,n){var o=this.getOrAddComponent(t,cc.CircleCollider);return o.radius=e,o.offset=null!=n?n:cc.Vec2.ZERO,o},t.setBoxCollider=function(t,e,n){var o=this.getOrAddComponent(t,cc.BoxCollider);return o.size=e,o.offset=null!=n?n:cc.Vec2.ZERO,o},t.getLabelColor=function(t){return new cc.Color(255,255,255),t<50?new cc.Color(79,171,96):t>=50&&t<75?new cc.Color(79,125,171):t>=75&&t<90?new cc.Color(132,79,171):new cc.Color(246,41,61)},t.setFanCollider=function(t,e,n,o,r,i){void 0===r&&(r=30);var a=this.getOrAddComponent(t,cc.PolygonCollider),s=Math.ceil(o/r),c=[];c.push(cc.Vec2.ZERO);for(var l=0;l<=s;++l){var u=n+l*(o/s),p=Math.cos(cc.misc.degreesToRadians(u))*e,f=Math.sin(cc.misc.degreesToRadians(u))*e;c.push(cc.v2(p,f))}return a.points=c,a.offset=null!=i?i:cc.Vec2.ZERO,a},t.updateLabelSize=function(t){t._forceUpdateRenderData()},t.localize=function(t,e){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if(t){var r=c.ConfigManager.instance.getLanConfig(e);t.string=this.formatStr.apply(this,i([r],n))}},t.formatStr=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.length?t.replace(/{(\d+)}/g,function(t,n){return void 0!==e[n]?e[n]:t}):t},t.replaceStr=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=c.ConfigManager.instance.getLanConfig(t);return e.length?o.replace(/{(\d+)}/g,function(t,n){return void 0!==e[n]?e[n]:t}):o},t.shortName=function(t,e){return t.length>e&&(t=t.substring(0,e)+"..."),t},t.compareVersion=function(t,e){for(var n=t.split("."),o=e.split("."),r=0;r<n.length;++r){var i=parseInt(n[r]),a=parseInt(o[r]||"0");if(i!==a)return i-a}return o.length>n.length?-1:0},t.clickSound=function(t){t instanceof cc.Button&&(t=t.node),t.on("click",function(){s.default.instance.playEffect(f.default.effectPath("click"))})},t.switchParent=function(t,e){var n=t.convertToWorldSpaceAR(cc.Vec2.ZERO);e&&(n=e.convertToNodeSpaceAR(n)),t.parent=e,t.setPosition(n)},t.getOrAddComponent=function(t,e){var n=t.getComponent(e);return n||(n=t.addComponent(e)),n},t.getComponentInChildren=function(t,e){var n,o,i=t.getComponent(e);if(!i)try{for(var a=r(t.children),s=a.next();!s.done;s=a.next()){var c=s.value;if(i=this.getComponentInChildren(c,e))break}}catch(l){n={error:l}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return i},t.getNodePath=function(t){for(var e=[t.name];t.parent;)e.push(t.parent.name),t=t.parent;return e.reverse(),e.join("/")},t.isAncestorOf=function(t,e){for(;e.parent;){if(e.parent===t)return!0;e=e.parent}return!1},t.updateAlignmentRecursively=function(t){var e,n,o;null===(o=t.getComponent(cc.Widget))||void 0===o||o.updateAlignment();try{for(var i=r(t.children),a=i.next();!a.done;a=i.next()){var s=a.value;this.updateAlignmentRecursively(s)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.transformRectTo=function(t,e){var n=new cc.Mat4;return t.getWorldMatrix(n),n.invert(n),e.transformMat4(e,n),e},t.transformRectFrom=function(t,e){var n=new cc.Mat4;return t.getWorldMatrix(n),e.transformMat4(e,n),e},t.getBoundingBoxToNode=function(t,e){var n=t.getBoundingBox();return t.parent&&(n=this.transformRectFrom(t.parent,n)),this.transformRectTo(e,n)},t.convertNodePositionToNode=function(t,e,n){if(cc.isValid(n)&&cc.isValid(t))return n.convertToNodeSpaceAR(t.convertToWorldSpaceAR(e))},t.getWorldPosition=function(t){return t.convertToWorldSpaceAR(cc.Vec2.ZERO)},t.setWorldPosition=function(t,e){t.parent?t.setPosition(t.parent.convertToNodeSpaceAR(e)):t.setPosition(e)},t.getEventTouchWorldPosition=function(t){return cc.v2(cc.Camera.main.getScreenToWorldPoint(t.getLocation()))},t.anchorPosToAbsPos=function(t,e){return cc.v2(e.x+t.width*t.anchorX,e.y+t.height*t.anchorY)},t.absPosToAnchorPos=function(t,e){return cc.v2(e.x-t.width*t.anchorX,e.y-t.height*t.anchorY)},t.toggleRenderer=function(t,e){var n=t.getComponent(cc.RenderComponent);n&&(n.enabled=e);for(var o=0;o<t.childrenCount;++o)this.toggleRenderer(t.children[o],e)},t.unionRects=function(t){if(!t.length)return null;for(var e=t[0],n=1;n<t.length;++n)e.union(e,t[n]);return e},t.playAnim=function(t,e,n,o,r){var i=this;if(r){var a=n;this.playAnim(t,e,1,function(){--a>0?setTimeout(function(){i.playAnim(t,e,a,o,r)},1e3*r):o&&o()})}else t.play(e).repeatCount=n,t.targetOff(this),t.once(cc.Animation.EventType.FINISHED,function(){t.targetOff(i),o&&o()},this)},t.playAnims=function(t,e,n){var o=this;0===e.length?n&&n():(t.play(e.shift()).repeatCount=1,t.targetOff(this),t.once(cc.Animation.EventType.FINISHED,function(){o.playAnims(t,e,n)},this))},t.playAnimsWithRepeats=function(t,e,n){var o=this;if(0===e.length)n&&n();else{var r=e.shift(),i=r.name,a=r.repeat;t.play(i).repeatCount=null!=a?a:1,t.targetOff(this),t.once(cc.Animation.EventType.FINISHED,function(){o.playAnimsWithRepeats(t,e,n)},this)}},t.findClip=function(t,e){return t.getClips().find(e)},t.prefixZero=function(t,e){return(Array(e).join("0")+t).slice(-e)},t.formatDate=function(t){var e=new Date(t),n=e.getFullYear(),o=e.getMonth()+1,r=o<10?"0"+o:o,i=e.getDate();return n+"-"+r+"-"+(i<10?"0"+i:i)},t.formatTimeText=function(t){var e=c.ConfigManager.instance,n=this.formatTime(t),o="";return n[0]>0&&(o+=n[0]+e.getLanConfig("ui_day")),n[1]>0&&(o+=n[1]+e.getLanConfig("ui_hour")),n[2]>0&&(o+=n[2]+e.getLanConfig("ui_minute")),n[3]>=0&&(o+=n[3]+e.getLanConfig("ui_second")),o},t.formatSimpleTimeText=function(t){var e=this.formatTime(t),n=e.findIndex(function(t){return t>0});n<0&&(n=3);for(var o=""+e[n],r=n+1;r<=3;++r)o+=":"+this.prefixZero(e[r],2);return o},t.formatMinutesText=function(t){var e=c.ConfigManager.instance,n=this.formatTime(t),o="";return n[0]>0&&(o+=n[0]+e.getLanConfig("ui_day")),n[1]>0&&(o+=n[1]+e.getLanConfig("ui_hour")),n[2]>0&&(o+=n[2]+e.getLanConfig("ui_minute")),o},t.formatTime=function(t){t=Math.floor(.001*t);var e=[],n=Math.floor(t/86400);e.push(n),t-=86400*n;var o=Math.floor(t/3600);e.push(o),t-=3600*o;var r=Math.floor(t/60);return e.push(r),t-=60*r,e.push(t),e},t.formatNumberString=function(t){var e=Math.floor(t).toString();return e.length<=5?e:e.length<=8?(t-t%100)/1e4+"\u4e07":(t-t%1e4)/1e8+"\u4ebf"},t.getAge=function(t,e){if(e<=t)return 0;var n=e.getFullYear()-t.getFullYear();return(e.getMonth()<t.getMonth()||e.getMonth()===t.getMonth()&&e.getDate()<t.getDate())&&(n-=1),n},t.isInAntiAddictionTime=function(t){var e=new Date(t),n=e.getDay(),o=e.getFullYear()+"-"+this.prefixZero(e.getMonth()+1,2)+"-"+this.prefixZero(e.getDate(),2);return!h.default.isHoliday(o)&&5!==n&&6!==n&&0!==n||20!==e.getHours()},t.getEntryInfoDesc=function(e){var n,o,i,a,s="entry_"+c.ConfigManager.instance.getEntryConfig(e.id).type,l=c.ConfigManager.instance.getEntryConfig(e.id),u="";if(l.applyTags&&l.applyTags.length)try{for(var p=r(l.applyTags),f=p.next();!f.done;f=p.next()){var h="tag_"+f.value;u+="["+c.ConfigManager.instance.getLanConfig(h)+"]"}}catch(_){n={error:_}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}if(e.influenceGuardIds&&e.influenceGuardIds.length)try{for(var d=r(e.influenceGuardIds),y=d.next();!y.done;y=d.next())h="guard_"+y.value+"_name",u+="["+c.ConfigManager.instance.getLanConfig(h)+"]"}catch(g){i={error:g}}finally{try{y&&!y.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}return""!=u?t.replaceStr(s,u,e.num):t.replaceStr(s,e.num)},t.RAW_MAT_PROP="__raw_mat_before_gray",t}();n.default=d,cc._RF.pop()},{"../Module/Audio":"Audio","../Module/ConfigManager":"ConfigManager","../Module/Loader":"Loader","./CryptoJsMini":"CryptoJsMini","./Path":"Path","chinese-calendar":3,lodash:13}],ViewHandler:[function(t,e,n){"use strict";cc._RF.push(e,"1c349gomttE/IFM/eGZiW9V","ViewHandler");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("./ViewModule")),c=a(t("./FFComponent")),l=a(t("../Enum/ViewType")),u=cc._decorator,p=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewID="",e.viewName="",e.viewType=l.default.Normal,e._clawHandles=[],e}return r(e,t),e.prototype.start=function(){},e.prototype.onDisable=function(){this.hideGuides()},e.prototype.onAnimateFinish=function(){},e.prototype.open=function(t){this.initiateView(t)},e.prototype.close=function(){s.default.instance.popView(this)},e.prototype.message=function(){},e.prototype.hideGuides=function(){this._clawHandles},e.prototype.showGuide=function(t,e,n){void 0===n&&(n=!1)},i([p],e)}(c.default));n.default=f,cc._RF.pop()},{"../Enum/ViewType":"ViewType","./FFComponent":"FFComponent","./ViewModule":"ViewModule"}],ViewMessage:[function(t,e,n){"use strict";cc._RF.push(e,"c37dchY+ppKT5DyjpPNkc0f","ViewMessage"),Object.defineProperty(n,"__esModule",{value:!0}),n.ViewMessage=void 0,n.ViewMessage||(n.ViewMessage={}),cc._RF.pop()},{}],ViewModule:[function(t,e,n){"use strict";cc._RF.push(e,"5ed43pn/D5IboXBM/v61rW+","ViewModule");var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var i=r(t("./Loader")),a=r(t("../Utils/IDGenerator")),s=r(t("./ViewHandler")),c=r(t("../Utils/Path")),l=r(t("./AutoRelease")),u=r(t("../Enum/ViewType")),p=r(t("../Component/View/BusyView/BusyView")),f=r(t("../Component/Scene/Viewport")),h=t("../Gameplay/System/AdSystem"),d=t("../Utils/ReactProperty"),y=function(){function t(){this._activeViews=null,this._keepViews=null,this._loadingMap=null,this._uiRoot=new d.CacheNode("Canvas/MainCamera/UIRoot"),this._viewRootMap=null,this._activeViews=cc.js.createMap(!0),this._keepViews=cc.js.createMap(!0),this._loadingMap={},this._idGenerator=new a.default,this._viewRootMap=new Map,this.createViewRoot(u.default.BaseView),this.createViewRoot(u.default.LowerUI),this.createViewRoot(u.default.Normal),this.createViewRoot(u.default.TopUI)}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.createViewRoot=function(t){var e=new cc.Node(u.default[t]);e.parent=this._uiRoot.value;var n=e.addComponent(cc.Widget);n.alignMode=cc.Widget.AlignMode.ON_WINDOW_RESIZE,n.isAlignTop=n.isAlignBottom=n.isAlignLeft=n.isAlignRight=!0,n.top=n.bottom=n.left=n.right=0,e.zIndex=t,this._viewRootMap.set(t,e)},t.prototype._clearAd=function(){h.AdSystem.instance.hideCustomAd(),h.AdSystem.instance.hideBannerAd()},t.prototype.getViewRoot=function(t){return this._viewRootMap.get(t)},t.prototype.translateView=function(t,e,n){this._clearActiveViews(),this._clearAd(),(n=this._handleOptions(n)).animate=!1,this.pushView(t,e,n)},t.prototype.pushView=function(t,e,n){n=this._handleOptions(n);var o=this._activeViews[t];if(o)n.onLoaded&&n.onLoaded(o.getComponent(s.default));else if(!n.only||!this._loadingMap[t])if(this._loadingMap[t])this._loadingMap[t].push(e);else if(this._loadingMap[t]=[e],o=this._keepViews[t]){var r=o.getComponent(l.default).prefab;this._loadPrefabSuccess(t,n,r)}else this.loadView(t,n)},t.prototype.loadView=function(t,e){var n=this,o=c.default.viewPath(t);e.bundle&&(o=c.default.getBundlePath(o,e.bundle)),this.showBusy(),i.default.loadRes(o,cc.Prefab,function(o){n.hideBusy(),o&&n._loadPrefabSuccess(t,e,o)},null)},t.prototype.showBusy=function(){p.default.show()},t.prototype.hideBusy=function(){p.default.hide()},t.prototype.popView=function(t,e){var n=t.viewID,o=t.viewName,r=this._activeViews[n];delete this._activeViews[n],r&&cc.isValid(r,!0)&&(o in this._keepViews?(r.active=!1,r.removeFromParent()):this._release(t)),e||this._clearAd()},t.prototype.popViewsByName=function(t){var e,n,r=[];for(var i in this._activeViews)(c=this._activeViews[i])&&c.name==t&&r.push(c);try{for(var a=o(r),s=a.next();!s.done;s=a.next()){var c,l=(c=s.value).getComponent(t);this.popView(l)}}catch(u){e={error:u}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}},t.prototype.popViewsByType=function(t,e){var n,r,i=[];for(var a in this._activeViews)(u=this._activeViews[a].getComponent(s.default))&&u.viewType==t&&(e&&e.includes(u.viewName)||i.push(u));try{for(var c=o(i),l=c.next();!l.done;l=c.next()){var u=l.value;this.popView(u)}}catch(p){n={error:p}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}},t.prototype.popInvalidViews=function(){var t,e;try{for(var n=o(Object.keys(this._activeViews)),r=n.next();!r.done;r=n.next()){var i=r.value,a=this._activeViews[i];a&&cc.isValid(a,!0)||delete this._activeViews[i]}}catch(s){t={error:s}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.activeView=function(t){return this._activeViews[t]?this._activeViews[t]:null},t.prototype.getActiveViews=function(){return this._activeViews},t.prototype.activeViewsByName=function(t){var e=[];for(var n in this._activeViews){var o=this._activeViews[n];t==o.getComponent(s.default).viewName&&e.push(o)}return e.length<1&&(e=null),e},t.prototype.isWorkingByName=function(t){return!!(this._loadingMap[t]&&this._loadingMap[t].length>0)||!!this.activeView(t)},t.prototype.clear=function(){this._clearActiveViews(),this._clearCacheViews()},t.prototype.worldRoot=function(){return cc.find("Canvas/World")},t.prototype.loadingRoot=function(){return cc.find("Canvas/MainCamera/Loading")},t.prototype.guideRoot=function(){return cc.find("Canvas/MainCamera/GuideLayer")},t.prototype.toast=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.pushView("ToastView",{fmt:t,args:e},{keep:!0,only:!0,bundle:c.default.MAIN_BUNDLE,zIndex:1})},t.prototype.sendMessage=function(t,e){for(var n in this._activeViews){var o=this._activeViews[n];o&&""!=o.name&&o.getComponent(s.default).message(t,e)}},t.prototype._clearActiveViews=function(){for(var t in this._activeViews)if("CommonLoadingView"!=t){var e=this._activeViews[t];if(e&&cc.isValid(e,!0)){var n=e.getComponent(s.default);this._release(n),delete this._activeViews[t]}}},t.prototype._clearCacheViews=function(){for(var t in this._keepViews){var e=this._keepViews[t];if(e&&cc.isValid(e,!0)){var n=e.getComponentInChildren(s.default);this._release(n)}}this._keepViews=cc.js.createMap(!0)},t.prototype._release=function(t){cc.isValid(t,!0)&&t.node.destroy()},t.prototype._loadPrefabSuccess=function(t,e,n){e.keep&&!this._keepViews[t]&&(this._keepViews[t]=i.default.instantiate(n));for(var o=this._loadingMap[t],r=0;r<o.length;++r){var a=o[r],s=i.default.instantiate(n);s.zIndex=e.zIndex;var c=t;e.only||(c=t+this._idGenerator.getNewId()),this._activeViews[c]=s;var l=s.getComponent(t);if(l||(l=s.addComponent(t)),l.viewID=c,l.viewName=t,s.name=t,s.active=!0,"CommonLoadingView"==s.name)s.parent=this.loadingRoot();else if("GuideTalkView"==s.name)s.parent=this.guideRoot();else if(l.viewType===u.default.World){var p=this.worldRoot(),h=p.getChildByName("Viewport"),d=p.getChildByName("content");s.parent=d,d.setContentSize(s.getContentSize()),d.setAnchorPoint(s.getAnchorPoint()),h.setContentSize(s.getContentSize()),h.setAnchorPoint(s.getAnchorPoint()),h.getComponent(f.default).refreshRange()}else s.parent=this._viewRootMap.get(l.viewType);l.open(a);var y=s.getChildByName("view");if(y){var _=cc.view.getVisibleSizeInPixel(),g=_.width/_.height>=.74,v=l.viewType===u.default.Normal;g&&v&&(y.scale=.5)}if(e.animate)if(y){var m=y.scale,b=1.05*m;y.scale=.2*m,cc.tween(y).to(.2,{scale:b}).delay(.05).to(.1,{scale:m}).call(l.onAnimateFinish.bind(l)).start()}else l.onAnimateFinish();else l.onAnimateFinish();e.onLoaded&&e.onLoaded(l)}delete this._loadingMap[t]},t.prototype._loadViewFail=function(t,e){console.warn(t+" load fial, err: ",e)},t.prototype._handleOptions=function(t){return t||(t={}),t.zIndex=t.zIndex?t.zIndex:0,t.keep=!!t.keep,"animate"in t||(t.animate=!0),t.only=!("only"in t&&!t.only),t},t._instance=null,t}();n.default=y,cc._RF.pop()},{"../Component/Scene/Viewport":"Viewport","../Component/View/BusyView/BusyView":"BusyView","../Enum/ViewType":"ViewType","../Gameplay/System/AdSystem":"AdSystem","../Utils/IDGenerator":"IDGenerator","../Utils/Path":"Path","../Utils/ReactProperty":"ReactProperty","./AutoRelease":"AutoRelease","./Loader":"Loader","./ViewHandler":"ViewHandler"}],ViewType:[function(t,e,n){"use strict";var o;cc._RF.push(e,"9d3a20UkXNP7q7Q1CVDXIqb","ViewType"),Object.defineProperty(n,"__esModule",{value:!0}),function(t){t[t.World=0]="World",t[t.BaseView=100]="BaseView",t[t.LowerUI=200]="LowerUI",t[t.Normal=300]="Normal",t[t.TopUI=400]="TopUI"}(o||(o={})),n.default=o,cc._RF.pop()},{}],Viewport:[function(t,e,n){"use strict";cc._RF.push(e,"fcb8340FNFOmYHC5J0uJjjn","Viewport");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s,c=t("../../Enum/SceneType"),l=a(t("../../Utils/Utils")),u=cc._decorator,p=u.ccclass,f=u.property;(function(t){t[t.None=0]="None",t[t.Vertical=1]="Vertical",t[t.Horizontal=2]="Horizontal"})(s||(s={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.content=null,e._cameraNode=null,e._startMove=!1,e._scrollEnabled=!0,e._screenRange=[-1,1],e._screenIndex=0,e._scrollDirection=s.None,e._indexSceneMap=new Map,e}return r(e,t),e.prototype.onLoad=function(){this._indexSceneMap.set(0,c.SceneType.HomeScene),this._cameraNode=cc.find("Canvas/MainCamera")},e.prototype.start=function(){this._initSwitchButtons(),this._registerTouch()},e.prototype._initSwitchButtons=function(){this._refreshSwitchButtons(),this.node.on("screen_switch",this._refreshSwitchButtons,this)},e.prototype._refreshSwitchButtons=function(){},e.prototype.whichScene=function(){return this._indexSceneMap.get(this._screenIndex)},e.prototype.switchScreen=function(t){this._moveToScreen(this._screenIndex+t)},e.prototype.isCurrentScreenLeftBound=function(){return this._screenIndex===this._screenRange[0]},e.prototype.isCurrentScreenRightBound=function(){return this._screenIndex===this._screenRange[1]},e.prototype.refreshRange=function(){var t=this.node.getContentSize(),e=this._cameraNode,n=e.getContentSize(),o=t.height,r=cc.v2(this._getScreenX(this._screenRange[0])-n.width/2,0),i=cc.v2(this._getScreenX(this._screenRange[1])+n.width/2,o);r=l.default.convertNodePositionToNode(this.content,r,e.parent),i=l.default.convertNodePositionToNode(this.content,i,e.parent),r.addSelf(cc.v2(n.width*e.anchorX,n.height*e.anchorY)),i.subSelf(cc.v2(n.width*(1-e.anchorX),n.height*(1-e.anchorY))),this._moveRange=cc.Rect.fromMinMax(r,i),this._jumpToScreen(0)},e.prototype.setScrollEnabled=function(t){this._scrollEnabled=t},e.prototype.isScrollEnabled=function(){return this._scrollEnabled},e.prototype.scrollTo=function(t,e,n){var o=this;if(void 0===n&&(n=!1),this._scrollEnabled||n){var r=this._getScreenIndex(t.x);t.x=this._getScreenX(r);var i=l.default.convertNodePositionToNode(this.node.parent,t,this._cameraNode.parent);this._validateCameraPos(i),this._cameraNode.stopAllActions(),e>0?cc.tween(this._cameraNode).to(e,{position:cc.v3(i)}).call(function(){r!=o._screenIndex&&(o._screenIndex=r,o.node.emit("screen_switch",r))}).start():(this._cameraNode.setPosition(i),r!=this._screenIndex&&(this._screenIndex=r,this.node.emit("screen_switch",r)))}},e.prototype.scrollToTop=function(t,e){void 0===e&&(e=!1),(this._scrollEnabled||e)&&(t>0?cc.tween(this._cameraNode).to(t,{y:this._moveRange.yMax}).start():this._cameraNode.y=this._moveRange.yMax)},e.prototype.scrollToBottom=function(t,e){void 0===e&&(e=!1),(this._scrollEnabled||e)&&(t>0?cc.tween(this._cameraNode).to(t,{y:this._moveRange.yMin}).start():this._cameraNode.y=this._moveRange.yMin)},e.prototype._registerTouch=function(){var t=this,e=this.node;e.on(cc.Node.EventType.TOUCH_START,function(e){t._scrollEnabled&&(t._startMove=!1,t._scrollDirection=s.None,t._cameraOriginPos=t._cameraNode.getPosition(),t._touchStartPos=e.getLocation(),t._touchStartTs=Date.now(),t._cameraNode.stopAllActions())},null),e.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(t._scrollEnabled){var n=e.getLocation(),o=t._touchStartPos.sub(n);if(!t._startMove)if(Math.abs(o.y)>=50)t._scrollDirection=s.Vertical,t._startMove=!0;else{if(!(Math.abs(o.x)>=70))return;t._scrollDirection=s.Horizontal,t._startMove=!0}return t._scrollDirection===s.Vertical?t._cameraNode.y=t._cameraOriginPos.y+o.y:t._cameraNode.x=t._cameraOriginPos.x+o.x,t._checkEdge(),!0}},null),e.on(cc.Node.EventType.TOUCH_CANCEL,function(){t._scrollEnabled&&t._startMove&&t._correctScreen()},null),e.on(cc.Node.EventType.TOUCH_END,function(){t._scrollEnabled&&t._startMove&&t._inertialScroll()},null)},e.prototype._checkEdge=function(){var t=this._cameraNode.getPosition();this._validateCameraPos(t),this._cameraNode.setPosition(t)},e.prototype._validateCameraPos=function(t){t.x=cc.misc.clampf(t.x,this._moveRange.xMin,this._moveRange.xMax),t.y=cc.misc.clampf(t.y,this._moveRange.yMin,this._moveRange.yMax)},e.prototype._correctScreen=function(){var t=this._cameraNode.x/this._cameraNode.width;this._moveToScreen(t)},e.prototype._moveToScreen=function(t){var e=Math.round(cc.misc.clampf(t,this._screenRange[0],this._screenRange[1])),n=this._getScreenX(e);if(this._cameraNode.x!==n){var o=.5*Math.abs(this._cameraNode.x-n)/this._cameraNode.width;cc.tween(this._cameraNode).to(o,{x:n}).start()}this._screenIndex=e,this.node.emit("screen_switch",e)},e.prototype._jumpToScreen=function(t){var e=Math.round(cc.misc.clampf(t,this._screenRange[0],this._screenRange[1])),n=this._getScreenX(e);this._cameraNode.x=n,this._screenIndex=e,this.node.emit("screen_switch",e)},e.prototype._getScreenX=function(t){return t*(this._cameraNode.width+100)},e.prototype._getScreenIndex=function(t){var e,n=this._cameraNode.width+100;return e=t>=0?Math.floor((t+n/2)/n):Math.ceil((t-n/2)/n),cc.misc.clampf(e,this._screenRange[0],this._screenRange[1])},e.prototype._inertialScroll=function(){if(this._scrollDirection===s.Vertical){var t=Date.now()-this._touchStartTs,e=.5*(i=this._cameraNode.y-this._cameraOriginPos.y),n=this._cameraNode.y+e;if(0!==(n=cc.misc.clampf(n,this._moveRange.yMin,this._moveRange.yMax))){var o=.6*t;o>1&&(o=1),cc.tween(this._cameraNode).to(o,{y:n},{easing:"quadOut"}).start()}}else{var r=this._cameraNode.width,i=this._cameraNode.x-this._cameraOriginPos.x;if(Math.abs(i)>=.3*r){var a=Math.sign(i),c=this._screenIndex+a;this._moveToScreen(c)}else this._correctScreen()}},e.prototype.reset=function(){this._startMove=!1,this._scrollEnabled=!0,this._touchStartPos=cc.Vec2.ZERO,this._cameraOriginPos=cc.Vec2.ZERO,this._scrollDirection=s.None},e.prototype.onTouchBack=function(){var t=this;this._scrollEnabled=!1,cc.tween(this._cameraNode).to(.2,{position:cc.v3(this._cameraOriginPos)}).call(function(){t._startMove=!1,t._scrollEnabled=!0,t._touchStartPos=cc.Vec2.ZERO,t._cameraOriginPos=cc.Vec2.ZERO}).start()},i([f(cc.Node)],e.prototype,"content",void 0),i([f(cc.Button)],e.prototype,"_cameraNode",void 0),i([p],e)}(cc.Component);n.default=h,cc._RF.pop()},{"../../Enum/SceneType":"SceneType","../../Utils/Utils":"Utils"}],VmDataBinding:[function(t,e,n){"use strict";cc._RF.push(e,"ab8d1bb9jpKdLs4OSeeEVmg","VmDataBinding");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.vbind=n.vfor=n.vsearch=n.vshow=n.vclick=n.vm=n.reactive=n.PropertyType=n.hasChanged=void 0;var a=function(t){return null!==t&&"object"==typeof t};n.hasChanged=function(t,e){return!Object.is(t,e)};var s,c=new WeakMap;(function(t){t.V_BIND="vbind",t.V_FOR="vfor",t.V_SHOW="vshow"})(s=n.PropertyType||(n.PropertyType={})),n.reactive=function(t){var e=this;return new Proxy(t,{get:function(t,o){var r=Reflect.get(t,o);if(a(r)&&Reflect.isExtensible(r)){var i=e.rawMap.get(r)||o;e.rawMap.set(r,i)}return a(r)?n.reactive.call(e,r):r},set:function(t,n,o){var r={oldValue:t[n],newValue:o},i=Reflect.set(t,n,o);return u.call(e,t,n,r),i},deleteProperty:function(t,n){var o=Reflect.deleteProperty(t,n);return u.call(e,t,n,{}),o}})};var l={vbind:function(t){var e=this,n=(t.type,t.property),o=t.key,r=t.handle,i=function(t,e,n){var o=!1;if(Reflect.has(t,e))t[e]=n,o=!0;else if(Reflect.has(t,"node")){var r=t.node;if(Reflect.has(r,e))r[e]=n,o=!0;else if(-1!=e.indexOf(".")){var i="cc."+(s=e.split("."))[0],a=s[1];(c=r.getComponent(i))||(c=r.addComponent(i)),Reflect.has(c,a)&&(c[a]=n,c instanceof cc.Widget&&c.updateAlignment(),o=!0)}else o=!1}else if(-1!=e.indexOf(".")){var s,c;r=t,i="cc."+(s=e.split("."))[0],a=s[1],(c=r.getComponent(i))||(c=r.addComponent(i)),Reflect.has(c,a)&&(c[a]=n,c instanceof cc.Widget&&c.updateAlignment(),o=!0)}else o=!1;return o};if("string"==typeof r){var a=m[o];a||(a=y),a(this,r).then(function(t){0==i(e[n],o,t)&&cc.error(n+" -> "+o+" not find")}).catch(function(t){cc.log(t)})}else if("function"==typeof r){var s=r.call(this,this);0==i(this[n],o,s)&&cc.error(n+" -> "+o+" not find")}else s=r,0==i(this[n],o,s)&&cc.error(n+" -> "+o+" not find")},vfor:function(t){t.type;var e=t.property;t.key,g(this,e,t.handle).then(function(){}).catch(function(t){cc.log(t)})},vshow:function(t){t.type;var e=t.property;t.key,_(this,e,t.handle).then(function(){}).catch(function(t){cc.log(t)})}},u=function(t,e,o){var r=null==o?void 0:o.newValue,i=null==o?void 0:o.oldValue;if(!i||n.hasChanged(r,i)){var s=this.rawMap.get(t);if(a(r)&&Reflect.isExtensible(r)){var c=s||e;this.rawMap.set(r,c)}s&&(e=s);for(var u=this.targetMap[e]||[],p=0;p<u.length;p++){var f=u[p],h=f.type;f.property,f.key,f.handle,l[h].call(this,f)}}},p=function(t,e){var n=e.shift();if(t)return 0==e.length?t[n]:p(t[n],e)},f=function(t,e){for(var n=[],o=0;o<e.length;o++){var r=new String(e[o]),i=(r=r.replace("?","")).split("."),a=p(t,i);n.push(a)}return n},h=[function(t,e){var n,o,r,a=e.vsearch||[];if(0!=a.length){var s=new Map;v(this.node,s);try{for(var c=i(a),l=c.next();!l.done;l=c.next()){var u=l.value,p=u.className,f=u.tag||u.name,h=s.get(f);"cc.Node"!=p.prototype.__classname__&&(h=null!==(r=null==h?void 0:h.getComponent(p))&&void 0!==r?r:null),null!=h?this[u.name]=h:cc.error("\u6ca1\u6709\u627e\u5230\u5c5e\u6027 "+t+"->"+f)}}catch(d){n={error:d}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}s=null}},function(t,e){var n,o,r=this,a=e.vclick||[],s=function(t){var e,n,o=t.tag,i=t.name,a=t.handler,s=null;if(!(s="string"==typeof a?c[a]:a))return cc.error("\u6ca1\u6709\u627e\u5230function "+a),"continue";(e=c[i],n=null,(n=e instanceof cc.Node?e:e.node).getComponent(cc.Button)||n.addComponent(cc.Button),n).on("click",function(t){s.call(r,t,o)},c)},c=this;try{for(var l=i(a),u=l.next();!u.done;u=l.next())s(u.value)}catch(p){n={error:p}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}}];function d(t,e){var n=function(t){for(var e=[],n=[],o=0;o<t.length;o++){var r=t[o];if("{"==r)n.push(o+1);else if("}"==r){var i=n.pop(),a=o-i,s=t.substr(i,a);e.push(s)}}return e},o=function(t,e,n){for(var o=new String(t),r=0;r<e.length;r++){var i=e[r],a=n[r];o=o.replace("${"+i+"}",a)}return o};return new Promise(function(r,i){try{var a=n(e);if(0==a.length)r(f(t.data,[e])[0]);else if(1==a.length&&"${"+a[0]+"}"==e)r(f(t.data,a)[0]);else{var s=f(t.data,a);r(o(e,a,s).valueOf())}}catch(c){i("\u5931\u8d25")}})}function y(t,e){return d(t,e)}function _(t,e,n){var i=this;return new Promise(function(a,s){return o(i,void 0,void 0,function(){var o,i;return r(this,function(){try{o=t[e],i=o instanceof cc.Node?o:o.node,"string"==typeof n?y(t,n).then(function(t){i.active=t}).catch(function(t){cc.log(t)}):i.active="function"==typeof n?n.call(t,t):n,a(1)}catch(r){s(r)}return[2]})})})}function g(t,e,n){var i=this;return new Promise(function(a,s){return o(i,void 0,void 0,function(){var o,i,c,l,u,p,f,h,d;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),o=n.component,i=n.prefab,c=n.data,[4,y(t,c)];case 1:for(l=r.sent(),(u=t[e]).removeAllChildren(),p=function(e){var n=l[e],r=cc.instantiate(t[i]),a=r.getComponent(o),s=a.onLoad;a.onLoad=function(){null==s||s.call(a),a.setData(n)},u.addChild(r)},f=0,h=l.length;f<h;f++)p(f);return a(1),[3,3];case 2:return d=r.sent(),s(d),[3,3];case 3:return[2]}})})})}function v(t,e){e.set(t.name,t);var n=t.children;for(var o in n)cc.isValid(n[o])&&v(n[o],e)}n.vm=function(t){var e=t.prototype.onLoad;t.prototype.onLoad=function(){var n,o,r=cc.js.getClassName(t),a=c.get(t.prototype)||{};try{for(var s=i(h),l=s.next();!l.done;l=s.next())l.value.call(this,r,a)}catch(u){n={error:u}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}null==e||e.call(this)}},n.vclick=function(t,e){return function(n,o){var r=c.get(n)||{},i=r.vclick||[];i.push({tag:e,name:o,handler:t}),r.vclick=i,c.set(n,r)}},n.vshow=function(t){return function(e,n){var o=c.get(e)||{},r=o.property||[];r.push({type:s.V_SHOW,propertyKey:n,handler:t}),o.property=r,c.set(e,o)}},n.vsearch=function(t,e){return function(n,o){var r=c.get(n)||{},i=r.vsearch||[];i.push({tag:e,name:o,className:t}),r.vsearch=i,c.set(n,r)}},n.vfor=function(t){return function(e,n){var o=c.get(e)||{},r=o.property||[];r.push({type:s.V_FOR,propertyKey:n,handler:t}),o.property=r,c.set(e,o)}},n.vbind=function(t){return function(e,n){var o=c.get(e)||{},r=o.property||[];r.push({type:s.V_BIND,propertyKey:n,handler:t}),o.property=r,c.set(e,o)}};var m={common:y,string:d,spriteFrame:function(t,e){var n=this;return new Promise(function(i,a){return o(n,void 0,void 0,function(){var n;return r(this,function(o){switch(o.label){case 0:return[4,d(t,e)];case 1:return(n=o.sent()).startsWith("http")?cc.assetManager.loadRemote(n,{ext:".png"},function(t,e){if(cc.error)a(n+"\u52a0\u8f7d\u5931\u8d25\uff01");else{var o=new cc.SpriteFrame(e);i(o)}}):cc.resources.load(n+"/spriteFrame",cc.SpriteFrame,function(t,e){t?a(n+"\u52a0\u8f7d\u5931\u8d25\uff01"):i(e)}),[2]}})})})}};cc._RF.pop()},{}],WarningView:[function(t,e,n){"use strict";cc._RF.push(e,"827f49LurNPm7TFxUjyiY8B","WarningView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../Module/ViewHandler")),c=a(t("../Utils/Utils")),l=cc._decorator,u=l.ccclass,p=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.labelConfrim=null,e.labelCancel=null,e.labelContent=null,e.cb=null,e}return r(e,t),e.prototype.initiateView=function(t){this.cb=t.cb,c.default.localize(this.labelTitle,"ui_warning"),c.default.localize(this.labelConfrim,"ui_confirm"),c.default.localize(this.labelCancel,"ui_cancel"),c.default.localize(this.labelContent,t.strKey)},e.prototype.onConfirm=function(){this.close(),this.cb(!0)},e.prototype.onCancle=function(){this.close(),this.cb(!1)},i([p(cc.Label)],e.prototype,"labelTitle",void 0),i([p(cc.Label)],e.prototype,"labelConfrim",void 0),i([p(cc.Label)],e.prototype,"labelCancel",void 0),i([p(cc.Label)],e.prototype,"labelContent",void 0),i([u],e)}(s.default);n.default=f,cc._RF.pop()},{"../Module/ViewHandler":"ViewHandler","../Utils/Utils":"Utils"}],WashEntryView:[function(t,e,n){"use strict";cc._RF.push(e,"3f830ZDAWhOM4YXoHvwgtp9","WashEntryView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../Gameplay/System/WeaponSystem"),c=a(t("../Module/ViewHandler")),l=a(t("../Module/ViewModule")),u=a(t("../Utils/Path")),p=a(t("../Utils/Utils")),f=cc._decorator,h=f.ccclass,d=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.labelConfirm=null,e.labelGiveUp=null,e.labelGemName=null,e.labelWarn=null,e.oriEntryNode=null,e.newEntryNode=null,e.labelNode=null,e.gemLight=null,e.gemImg=null,e._callback=null,e._gem=null,e._newEntryArr=null,e}return r(e,t),e.prototype.initiateView=function(t){var e=this;this._callback=t.cb,this._gem=t.gem,p.default.localize(this.labelConfirm,"ui_washEntry"),p.default.localize(this.labelGiveUp,"ui_replace"),p.default.localize(this.labelTitle,"ui_washEntry"),p.default.localize(this.labelWarn,"warn_noEntry"),p.default.localize(this.labelGemName,"gem_"+this._gem.index+"_name");var n=u.default.getItemLightPath(this._gem.quality);p.default.loadImg(this.gemLight,n,200);var o=u.default.getGemPath(this._gem.id);p.default.loadImg(this.gemImg,o,80),s.WeaponSystem.instance.targetOff(this),s.WeaponSystem.instance.on(s.WeaponSystem.Events.UpdateGemEntry,function(t){e._gem=t,e.newEntryNode.removeAllChildren(),e.oriEntryNode.removeAllChildren(),e.labelWarn.node.active=!0,e.initEntry()},this),this.initEntry()},e.prototype.initEntry=function(){for(var t=0;t<this._gem.entryInfo.length;t++){var e=this._gem.entryInfo[t],n=cc.instantiate(this.labelNode);n.parent=this.oriEntryNode,this.updateInfo(n,e)}},e.prototype.updateInfo=function(t,e){t.getChildByName("labelContent").getComponent(cc.Label).string=p.default.getEntryInfoDesc(e),t.getChildByName("labelStar").getComponent(cc.Label).string=""+e.quality;var n=t.getChildByName("labelProgress").getComponent(cc.Label),o=Math.round(100*e.progress);n.node.color=p.default.getLabelColor(o),n.string=o+"%"},e.prototype.onRefresh=function(){this.labelWarn.node.active&&(this.labelWarn.node.active=!1),this.newEntryNode.removeAllChildren();var t=s.WeaponSystem.instance.getRandomEntryArr(this._gem.id,this._gem.quality);this._newEntryArr=t;for(var e=0;e<t.length;e++){var n=t[e],o=cc.instantiate(this.labelNode);o.parent=this.newEntryNode,this.updateInfo(o,n)}},e.prototype.onConfirm=function(){this._newEntryArr?(console.log(this._gem.tag),this._callback(!0,this._gem.tag,this._newEntryArr)):l.default.instance.toast("toast_haveNoNewEntry")},e.prototype.onClose=function(){this.close(),this._callback(!1)},i([d(cc.Label)],e.prototype,"labelTitle",void 0),i([d(cc.Label)],e.prototype,"labelConfirm",void 0),i([d(cc.Label)],e.prototype,"labelGiveUp",void 0),i([d(cc.Label)],e.prototype,"labelGemName",void 0),i([d(cc.Label)],e.prototype,"labelWarn",void 0),i([d(cc.Node)],e.prototype,"oriEntryNode",void 0),i([d(cc.Node)],e.prototype,"newEntryNode",void 0),i([d(cc.Prefab)],e.prototype,"labelNode",void 0),i([d(cc.Sprite)],e.prototype,"gemLight",void 0),i([d(cc.Sprite)],e.prototype,"gemImg",void 0),i([h],e)}(c.default);n.default=y,cc._RF.pop()},{"../Gameplay/System/WeaponSystem":"WeaponSystem","../Module/ViewHandler":"ViewHandler","../Module/ViewModule":"ViewModule","../Utils/Path":"Path","../Utils/Utils":"Utils"}],WatchAdStatus:[function(t,e,n){"use strict";cc._RF.push(e,"e5017rTF0RAwJkTA+EmQdjB","WatchAdStatus"),Object.defineProperty(n,"__esModule",{value:!0}),n.WatchAdStatus=void 0,function(t){t[t.Success=0]="Success",t[t.Cancel=1]="Cancel",t[t.Failed=2]="Failed",t[t.NotSupported=3]="NotSupported",t[t.TooFreq=4]="TooFreq",t[t.NetworkError=5]="NetworkError"}(n.WatchAdStatus||(n.WatchAdStatus={})),cc._RF.pop()},{}],WeaponConfig:[function(t,e,n){"use strict";cc._RF.push(e,"d2ef3d51ERHr54/CkhSZyzj","WeaponConfig"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],WeaponData:[function(t,e,n){"use strict";cc._RF.push(e,"25e3545p3ZHr5ukrQS1XB1M","WeaponData"),Object.defineProperty(n,"__esModule",{value:!0}),n.ISlotStatus=n.IWeaponStatus=n.ICardStatus=void 0,function(t){t[t.Lock=0]="Lock",t[t.Unlock=1]="Unlock"}(n.ICardStatus||(n.ICardStatus={})),function(t){t[t.Lock=0]="Lock",t[t.Unlock=1]="Unlock",t[t.Equipt=2]="Equipt"}(n.IWeaponStatus||(n.IWeaponStatus={})),function(t){t[t.Lock=0]="Lock",t[t.Unlock=1]="Unlock"}(n.ISlotStatus||(n.ISlotStatus={})),cc._RF.pop()},{}],WeaponItem:[function(t,e,n){"use strict";cc._RF.push(e,"14377RpRHlKPaPhhP3HnI2o","WeaponItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=a(t("../../Component/Utils/TableView/TableViewItem")),c=t("../../Gameplay/System/BagSystem"),l=t("../../Gameplay/System/WeaponSystem"),u=a(t("../../Utils/Path")),p=a(t("../../Utils/Utils")),f=cc._decorator,h=f.ccclass,d=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.img=null,e.outline=null,e.focus=null,e.curWeapon=null,e._bagView=null,e._data=null,e._itemTableView=null,e}return r(e,t),e.prototype.init=function(t,e){var n=this;this._bagView=t.manager,this._itemTableView=e,this._data=t;var o=u.default.getWeaponImg(t.id),r=u.default.getItemOutlinePath(t.quality);l.WeaponSystem.instance.targetOff(this),l.WeaponSystem.instance.on(l.WeaponSystem.Events.EquiptWeapon,function(t){var e=n._data.id==t;n.onEuipt(e)},this),p.default.loadImg(this.img,o,60),p.default.loadImg(this.outline,r),this.img.node.opacity=t.isUnlock?255:50,t.isUnlock?p.default.ungray(this.img.node):p.default.gray(this.img.node),this._data.id==l.WeaponSystem.instance.getCurWeaponId()&&(this.onHighlight(!0),this.onEuipt(!0))},e.prototype.onSelect=function(){var t=this;if(this._data.isUnlock)this._bagView.onChangeSelectId(this._data),this._itemTableView.setHighlight(this._data);else{var e=l.WeaponSystem.instance.getUnlockWeaponCondition(this._data.id);c.BagSystem.instance.showConditionView(e,"condition_unlock_weapon",function(e){e&&l.WeaponSystem.instance.unlockWeapon(t._data.id,function(){t._data.isUnlock=!0,t.img.node.opacity=255,p.default.ungray(t.img.node)})})}},e.prototype.onHighlight=function(t){this.focus.active=t},e.prototype.onEuipt=function(t){this.curWeapon.active=t},i([d(cc.Sprite)],e.prototype,"img",void 0),i([d(cc.Sprite)],e.prototype,"outline",void 0),i([d(cc.Node)],e.prototype,"focus",void 0),i([d(cc.Node)],e.prototype,"curWeapon",void 0),i([h],e)}(s.default);n.default=y,cc._RF.pop()},{"../../Component/Utils/TableView/TableViewItem":"TableViewItem","../../Gameplay/System/BagSystem":"BagSystem","../../Gameplay/System/WeaponSystem":"WeaponSystem","../../Utils/Path":"Path","../../Utils/Utils":"Utils"}],WeaponSystem:[function(t,e,n){"use strict";cc._RF.push(e,"6ca02U3HLFHWrgD2wn1RuA/","WeaponSystem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},c=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.WeaponSystem=n.UpdateLineup=void 0;var u,p=t("../../Interface/SaveData/WeaponData"),f=t("../../Module/ConfigManager"),h=l(t("../../Module/Database/Db")),d=l(t("../../Module/ViewModule")),y=l(t("../../Utils/Utils")),_=l(t("../Game")),g=l(t("../GameDefine")),v=t("./Common/DataSaver"),m=t("./HomeSystem"),b=l(t("lodash")),w={EquiptWeapon:"EquiptWeapon",UnlockWeapon:"UnlockWeapon",UpdateSlot:"UpdateSlot",UpdateGemEntry:"UpdateGemEntry",SelectCardGroup:"SelectCardGroup",HandbookGuard:"HandbookGuard",HandbookEnemy:"HandbookEnemy",CardInfo:"CardInfo",AddCardGroupToLineup:"AddCardGroupToLineup",RemoveCardGroupFromLineup:"RemoveCardGroupFromLineup"},S={1:[90,10],2:[85,15],3:[80,19,1],4:[40,50,10],5:[30,60,10],6:[20,70,20]};(function(t){t.add="add",t.remove="remove"})(u=n.UpdateLineup||(n.UpdateLineup={}));var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="WeaponSystem",e._data=null,e._saver=new v.DataSaver,e}return r(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.init=function(){return i(this,void 0,void 0,function(){var t,e,n,o,r,i,s,c,l,u,d;return a(this,function(){if(this._data=h.default.instance.getData("weapon"),!this._data){for(t={version:1,magic:1,curWeaponId:1,curLineupIndex:1,lineups:{},weapons:{},cards:{},slots:{}},this._data=t,e=g.default.MaxLineupNum,u=1;u<=e;u++)this._data.lineups[u]=[];this.setDirty()}for(i in n=f.ConfigManager.instance.getConfig("Weapon"))this._data.weapons[i]||(o={id:+i,status:p.IWeaponStatus.Lock},1==+i&&(o.status=p.IWeaponStatus.Equipt),this._data.weapons[i]=o);for(i in r=f.ConfigManager.instance.getConfig("CardGroup"))this._data.cards[i]||(s=r[i],c={id:+i,status:p.ICardStatus.Lock,guards:s.guards},1==+i&&(c.status=p.ICardStatus.Unlock),this._data.cards[i]=c);for(l=n[1].slotNum,u=0;u<g.default.GemMaxNum;u++)this._data.slots[u]||((d={index:null,status:p.ISlotStatus.Unlock,gem:null}).index=u,this._data.slots[u]=d,u>=l&&(this._data.slots[u].status=p.ISlotStatus.Lock));return this._saver.init("weapon",this._data),[2]})})},e.prototype.setDirty=function(){this._saver.setDirty()},e.prototype.destroy=function(){this._saver.save()},e.prototype.logicUpdate=function(){},e.prototype.getCurLineup=function(){var t=this._data.curLineupIndex;return this._data.lineups[t]},e.prototype.getAnyLineup=function(t){return this._data.lineups[t]},e.prototype.getWhichLineup=function(t){var e=this._data.lineups;for(var n in e)if(e[n].includes(t))return n;return 0},e.prototype.getAllLineups=function(){return this._data.lineups},e.prototype.getCurLineupIndex=function(){return this._data.curLineupIndex},e.prototype.updateLineup=function(t,e,n){if(n==u.add)this._data.lineups[t].push(e),this.emit(w.AddCardGroupToLineup,t);else{var o=this._data.lineups[t],r=o.indexOf(e);r>=0&&(o.splice(r,1),this.emit(w.RemoveCardGroupFromLineup,t))}this.setDirty()},e.prototype.unlockCards=function(t){var e=this._data.cards[t];e.status==p.ICardStatus.Lock&&(e.status=p.ICardStatus.Unlock,this.setDirty(),d.default.instance.pushView("RewardCardView",e))},e.prototype.getEquipedGuardIds=function(){var t=[],e=f.ConfigManager.instance.getCardGroupConfig(g.default.BaseCardGroupId);return t.push.apply(t,c(e.guards)),t.push.apply(t,c(this.getCurLineup())),b.default.uniq(t)},e.prototype.getCurWeaponId=function(){return this._data.curWeaponId},e.prototype.getCurWeapon=function(){var t=this._data.curWeaponId;return this._data.weapons[t]},e.prototype.getAllCards=function(){return this._data.cards},e.prototype.getAllWeapon=function(){return this._data.weapons},e.prototype.getSlots=function(){return this._data.slots},e.prototype.getSlotByIndex=function(t){return this._data.slots[t]},e.prototype.setSlotData=function(t){var e=t.index;this._data.slots[e]?(this._data.slots[e]=t,this.setDirty()):console.log("this partindex dont have any info:",e)},e.prototype.getUnlockWeaponCondition=function(t){return f.ConfigManager.instance.getWeaponConfig(t).condition},e.prototype.compareTwoGems=function(t,e){return t.score<=e.score},e.prototype.getEntryScore=function(t){var e=50*t.quality,n=f.ConfigManager.instance.getEntryConfig(t.id),o="range"+t.quality;return e+=t.num/n[o][1]*100,e+=n.baseScore,1==n.maxNumOnOne&&(e+=100),e},e.prototype.getGemScore=function(t,e){for(var n=100*t,o=0;o<e.length;o++){var r=e[o];n+=this.getEntryScore(r)}return Math.floor(n)},e.prototype.getRandomEntryQuality=function(){return y.default.randomByWeight([80,10,9,.9,.1])},e.prototype.createEntry=function(t){var e=f.ConfigManager.instance.getEntryConfig(t),n=this.getRandomEntryQuality(),o=e["range"+n],r=y.default.randomRangeInt(o[0],o[1]+1);0==e.round&&(r=+y.default.randomRange(o[0],o[1]).toFixed(2));var i=r/o[1],a=[];if(e.candidateGuardIds&&e.candidateGuardIds.length){var s=y.default.randomSelect(e.candidateGuardIds);a.push(s)}return{id:e.id,uuid:_.default.instance.time(),num:r,progress:i,quality:n,influenceGuardIds:a}},e.prototype.getRandomEntry=function(t){for(var e=f.ConfigManager.instance.getGemConfig(t.id),n=b.default.cloneDeep(e.entryArr),o=0;o<t.entryInfo.length;o++){var r=t.entryInfo[o];if(1==f.ConfigManager.instance.getEntryConfig(r.id).maxNumOnOne)for(var i=0;i<n.length;i++)n[i]==r.id&&n.splice(i,1)}return n=y.default.shuffle(n),this.createEntry(n[0])},e.prototype.getRandomEntryArr=function(t,e){var n=f.ConfigManager.instance.getGemConfig(t),o=S[e],r=y.default.randomByWeight(o);r=Math.min(r,g.default.MaxEntryNum);for(var i=[],a=0;a<n.entryArr.length;a++){var s=n.entryArr[a],c=f.ConfigManager.instance.getEntryConfig(s);i.push(c)}var l=(i=y.default.shuffle(i)).splice(0,r),u=[];for(a=0;a<l.length;a++){var p=l[a];c=this.createEntry(p.id),u.push(c)}return u},e.prototype.updateGemEntry=function(t,e){var n=this._data.slots,o=null;for(var r in n){var i=n[r].gem;i&&i.tag==t&&(i.entryInfo=e,o=i)}this.emit(w.UpdateGemEntry,o),this.setDirty()},e.prototype.updateSlots=function(){var t=this.getSlots(),e=this.getWeaponSlotNum();for(var n in t){t[n].status=+n>=e?p.ISlotStatus.Lock:p.ISlotStatus.Unlock}this.emit(w.UpdateSlot),this.setDirty()},e.prototype.unlockWeapon=function(t,e){var n=this._data.weapons[t];n.status==p.IWeaponStatus.Lock&&(n.status=p.IWeaponStatus.Unlock),this.setDirty(),this.emit(w.UnlockWeapon,t),e&&e()},e.prototype.EquiptWeapon=function(t,e){var n=this,o=this.getCurWeaponId();if(o!=t){var r=function(){var r=n._data.weapons;r[o].status=p.IWeaponStatus.Unlock,r[t].status=p.IWeaponStatus.Equipt,n._data.curWeaponId=t,n.updateSlots(),n.emit(w.EquiptWeapon,t),e&&e(!0)};f.ConfigManager.instance.getWeaponConfig(o).slotNum>f.ConfigManager.instance.getWeaponConfig(t).slotNum?d.default.instance.pushView("WarningView",{strKey:"warn_lessSlots",cb:function(t){t?r():(d.default.instance.toast("toast_user_cancel"),e&&e(!1))}}):r()}},e.prototype.getWeaponSlotNum=function(){return f.ConfigManager.instance.getWeaponConfig(this.getCurWeaponId()).slotNum},e.prototype.randomGem=function(t){var e=m.HomeSystem.instance.getCurStage(),n=f.ConfigManager.instance.getStageConfig(e).randomArr,o=y.default.randomByWeight(n),r=this.getWeaponSlotNum(),i=y.default.randomRangeInt(0,r),a=f.ConfigManager.instance.getPartGemConfig(i),s=y.default.shuffle(a)[0],c=this.getRandomEntryArr(s.id,o),l=this.getGemScore(o,c),u={id:s.id,tag:_.default.instance.time(),index:i,quality:o,entryInfo:c,score:l};t&&t({index:i,gem:u})},e.prototype.getCurrentAllEntryInfo=function(){var t=[];for(var e in this._data.slots){var n=this._data.slots[e];if(n.status==p.ISlotStatus.Unlock){var o=n.gem;null!=o&&null!=o.entryInfo&&t.push.apply(t,c(o.entryInfo))}}return t},e.prototype.sendMessage=function(t,e){this.emit(t,e)},e._instance=null,e.Events=w,e}(cc.EventTarget);n.WeaponSystem=C,cc._RF.pop()},{"../../Interface/SaveData/WeaponData":"WeaponData","../../Module/ConfigManager":"ConfigManager","../../Module/Database/Db":"Db","../../Module/ViewModule":"ViewModule","../../Utils/Utils":"Utils","../Game":"Game","../GameDefine":"GameDefine","./Common/DataSaver":"DataSaver","./HomeSystem":"HomeSystem",lodash:13}],eEdit:[function(t,e,n){"use strict";cc._RF.push(e,"a68b7IarHZBIbmX/Y49IFLI","eEdit");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.eEdit=void 0;var a=cc._decorator,s=a.ccclass,c=a.property,l=new cc.Color,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.BgSprite=null,e.SideSprite=null,e.NameLable=null,e.editbox=null,e.BgColor=new cc.Color(40,40,40,255),e.SideColor=new cc.Color(0,130,180,255),e.pressStrenth=.75,e}return r(e,t),Object.defineProperty(e.prototype,"MenuItemBgColor",{get:function(){return this.BgColor},set:function(t){this.BgColor=t,this.onNormal()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MenuItemSideColor",{get:function(){return this.SideColor},set:function(t){this.SideColor=t,this.onNormal()},enumerable:!1,configurable:!0}),e.prototype.init=function(t,e,n){this.node.name=t,this.NameLable.string=t,this.editbox.string=e,n&&(this.callback=n)},e.prototype.onEnable=function(){this.onNormal(),cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.node.on(cc.Node.EventType.MOUSE_ENTER,this.onPress,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.onNormal,this))},e.prototype.onDisable=function(){cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.node.off(cc.Node.EventType.MOUSE_ENTER,this.onPress,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.onNormal,this))},e.prototype.setProgress=function(t){var e=cc.clamp(Number(t)||0,0,1);this.editbox.string=""+e},e.prototype.onEditDidEnded=function(t){var e=t.string;this.callback&&this.callback(e)},e.prototype.changeColor=function(t){this.BgSprite.node.color=cc.Color.set(l,this.BgColor.r*t,this.BgColor.g*t,this.BgColor.b*t)},e.prototype.onPress=function(){this.changeColor(this.pressStrenth)},e.prototype.onNormal=function(){this.changeColor(1)},i([c(cc.Sprite)],e.prototype,"BgSprite",void 0),i([c(cc.Sprite)],e.prototype,"SideSprite",void 0),i([c(cc.Label)],e.prototype,"NameLable",void 0),i([c(cc.EditBox)],e.prototype,"editbox",void 0),i([c(cc.Color)],e.prototype,"MenuItemBgColor",null),i([c(cc.Color)],e.prototype,"MenuItemSideColor",null),i([c({visible:!1})],e.prototype,"BgColor",void 0),i([c({visible:!1})],e.prototype,"SideColor",void 0),i([s],e)}(cc.Component);n.eEdit=u,cc._RF.pop()},{}],eGraph:[function(t,e,n){"use strict";cc._RF.push(e,"8402dhduE5Ov50TfvBqb+zA","eGraph");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.eGraph=void 0;var a=cc._decorator,s=a.ccclass,c=a.property,l=new cc.Color,u=(new cc.Vec3,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.BgSprite=null,e.SideSprite=null,e.NameLable=null,e.LineGraph=null,e.BgColor=new cc.Color(40,40,40,255),e.SideColor=new cc.Color(0,130,180,255),e.pressStrenth=.75,e.positions=[],e._x=100,e._y=18,e._points=10,e._limit=60,e}return r(e,t),Object.defineProperty(e.prototype,"MenuItemBgColor",{get:function(){return this.BgColor},set:function(t){this.BgColor=t,this.onNormal()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MenuItemSideColor",{get:function(){return this.SideColor},set:function(t){this.SideColor=t,this.onNormal()},enumerable:!1,configurable:!0}),e.prototype.updateData=function(t){this.positions.length>=this._points&&this.positions.shift(),this.positions.push(t),this.drawLine()},e.prototype.init=function(t,e,n,o){void 0===n&&(n=60),void 0===o&&(o=10),this.node.name=t,this.NameLable.string=t,e&&(this.callback=e);var r=this.LineGraph.node.getContentSize();this._x=r.width,this._y=.85*r.height,this._limit=n,this._points=Math.max(Math.floor(o),3)},e.prototype.drawLine=function(){var t=this.positions.length;if(!(t<2)){this.LineGraph.clear();for(var e=.5*this._x,n=.5*this._y,o=this._y,r=this._x/(this._points-1),i=0;i<t;i++){var a=o*Math.min(this.positions[i]/this._limit,1.05)-n,s=i*r-e;0==i?this.LineGraph.moveTo(s,a):this.LineGraph.lineTo(s,a)}this.LineGraph.stroke()}},e.prototype.onEnable=function(){this.onNormal(),this.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this),cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.node.on(cc.Node.EventType.MOUSE_ENTER,this.onPress,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.onNormal,this))},e.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this),cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.node.off(cc.Node.EventType.MOUSE_ENTER,this.onPress,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.onNormal,this))},e.prototype.changeColor=function(t){this.BgSprite.node.color=cc.Color.set(l,this.BgColor.r*t,this.BgColor.g*t,this.BgColor.b*t)},e.prototype.onPress=function(){this.changeColor(this.pressStrenth)},e.prototype.onNormal=function(){this.changeColor(1)},e.prototype.onClick=function(){if(this.callback){var t=this.callback();t&&(this.NameLable.string=String(t)||this.NameLable.string)}},i([c(cc.Sprite)],e.prototype,"BgSprite",void 0),i([c(cc.Sprite)],e.prototype,"SideSprite",void 0),i([c(cc.Label)],e.prototype,"NameLable",void 0),i([c(cc.Graphics)],e.prototype,"LineGraph",void 0),i([c(cc.Color)],e.prototype,"MenuItemBgColor",null),i([c(cc.Color)],e.prototype,"MenuItemSideColor",null),i([c({visible:!1})],e.prototype,"BgColor",void 0),i([c({visible:!1})],e.prototype,"SideColor",void 0),i([s],e)}(cc.Component));n.eGraph=u,cc._RF.pop()},{}],eGroup:[function(t,e,n){"use strict";cc._RF.push(e,"f6ba3QH8TJGU6L91bCnmd0p","eGroup");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.eGroup=void 0;var a=t("./eItem"),s=t("./eSlider"),c=t("./eToggle"),l=t("./eEdit"),u=t("./eList"),p=t("./eGraph"),f=cc._decorator,h=f.ccclass,d=f.property,y=(new cc.Quat,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.arrow=null,e.tittle=null,e.menuItem=null,e.sliderItem=null,e.toggleItem=null,e.groupItem=null,e.editItem=null,e.listItem=null,e.graphItem=null,e.nameLabel=null,e._size=new cc.Size(200,30),e._item=null,e._isVisible=!0,e._groupName="",e._time=0,e}var n;return r(e,t),n=e,Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t,this.setMenuNode()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"groupName",{set:function(t){this._groupName=t,this.nameLabel.string=t},enumerable:!1,configurable:!0}),e.prototype.getParent=function(){return this.parentComp},e.prototype.onEnable=function(){this.tittle.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.tittle.on(cc.Node.EventType.TOUCH_END,this.changeVisible,this),this.tittle.on(cc.Node.EventType.TOUCH_MOVE,this.dragPos,this)},e.prototype.onDisable=function(){this.tittle.off(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.tittle.on(cc.Node.EventType.TOUCH_MOVE,this.dragPos,this),this.tittle.off(cc.Node.EventType.TOUCH_END,this.changeVisible,this)},e.prototype.touchStart=function(){this._time=cc.director.getTotalTime()},e.prototype.dragPos=function(t){if(!(cc.director.getTotalTime()-this._time<90)){var e=this.node.parent,n=t.touch.getLocation();e.parent?e.setPosition(e.parent.convertToNodeSpaceAR(n)):e.setPosition(n.x,n.y)}},e.prototype.addGroup=function(t){var e=cc.instantiate(this.groupItem),o=e.getComponent(n);return o.size=this.size,e.parent=this.node,e.active=this._isVisible,t&&(o.groupName=t),o.parentComp=this.getParent(),o},e.prototype.addSlider=function(t,e,n,o,r){var i=cc.instantiate(this.sliderItem);i.setContentSize(this._size),i.parent=this.node,i.active=this._isVisible;var a=i.getComponent(s.eSlider);return a.slider.progress=n,a.editbox.string=""+n,a&&a.init(t,e,o),r&&(r=a),this},e.prototype.addEdit=function(t,e,n){var o=cc.instantiate(this.editItem);o.setContentSize(this._size),o.parent=this.node,o.active=this._isVisible;var r=o.getComponent(l.eEdit);return r&&r.init(t,e,n),this},e.prototype.addGraph=function(t,e,n,o){void 0===n&&(n=60),void 0===o&&(o=10);var r=cc.instantiate(this.graphItem);r.setContentSize(this._size),r.parent=this.node,r.active=this._isVisible;var i=r.getComponent(p.eGraph);return i&&i.init(t,e,n,o),this},e.prototype.addItem=function(t,e){var n=cc.instantiate(this.menuItem);n.setContentSize(this._size),n.parent=this.node,n.active=this._isVisible;var o=n.getComponent(a.eItem);return o&&o.init(t,e),this},e.prototype.addList=function(t,e){var n=cc.instantiate(this.listItem);n.setContentSize(cc.size(this._size.width,n.getContentSize().height)),n.parent=this.node,n.active=this._isVisible;var o=n.getComponent(u.eList);return o&&o.init(t,e),this},e.prototype.addToggle=function(t,e,n){void 0===n&&(n=!0);var o=cc.instantiate(this.toggleItem);o.setContentSize(this._size),o.parent=this.node,o.active=this._isVisible;var r=o.getComponent(c.eToggle);return r.toggle.isChecked=n,r&&r.init(t,e),this},e.prototype.setMenuNode=function(){var t=this;this.resetSize(this.node);var e=this.node.children;e.length>0&&e.forEach(function(e){t.resetSize(e)})},e.prototype.resetSize=function(t){t.setContentSize(this._size)},e.prototype.resetItem=function(t){this._item!=t&&this._item&&this._item.onNormal(),this._item=t},e.prototype.changeVisible=function(){this.setVisible(!this._isVisible)},e.prototype.setVisible=function(t){this._isVisible=t;var e=this.node.children;this.arrow.angle=this._isVisible?-90:0;for(var n=1;n<e.length;n++)e[n].active=this._isVisible;return this},i([d(cc.Node)],e.prototype,"arrow",void 0),i([d(cc.Node)],e.prototype,"tittle",void 0),i([d(cc.Prefab)],e.prototype,"menuItem",void 0),i([d(cc.Prefab)],e.prototype,"sliderItem",void 0),i([d(cc.Prefab)],e.prototype,"toggleItem",void 0),i([d(cc.Prefab)],e.prototype,"groupItem",void 0),i([d(cc.Prefab)],e.prototype,"editItem",void 0),i([d(cc.Prefab)],e.prototype,"listItem",void 0),i([d(cc.Prefab)],e.prototype,"graphItem",void 0),i([d(cc.Label)],e.prototype,"nameLabel",void 0),n=i([h],e)}(cc.Component));n.eGroup=y,cc._RF.pop()},{"./eEdit":"eEdit","./eGraph":"eGraph","./eItem":"eItem","./eList":"eList","./eSlider":"eSlider","./eToggle":"eToggle"}],eItem:[function(t,e,n){"use strict";cc._RF.push(e,"25493LQs4pHSqAzfHZVO6iA","eItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.eItem=void 0;var a=cc._decorator,s=a.ccclass,c=a.property,l=new cc.Color,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.BgSprite=null,e.SideSprite=null,e.NameLable=null,e.BgColor=new cc.Color(40,40,40,255),e.SideColor=new cc.Color(0,130,180,255),e.pressStrenth=.75,e}return r(e,t),Object.defineProperty(e.prototype,"MenuItemBgColor",{get:function(){return this.BgColor},set:function(t){this.BgColor=t,this.onNormal()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MenuItemSideColor",{get:function(){return this.SideColor},set:function(t){this.SideColor=t,this.onNormal()},enumerable:!1,configurable:!0}),e.prototype.init=function(t,e){this.node.name=t,this.NameLable.string=t,e&&(this.callback=e)},e.prototype.onEnable=function(){this.onNormal(),this.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this),cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.node.on(cc.Node.EventType.MOUSE_ENTER,this.onPress,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.onNormal,this))},e.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this),cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.node.off(cc.Node.EventType.MOUSE_ENTER,this.onPress,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.onNormal,this))},e.prototype.changeColor=function(t){this.BgSprite.node.color=cc.Color.set(l,this.BgColor.r*t,this.BgColor.g*t,this.BgColor.b*t)},e.prototype.onPress=function(){this.changeColor(this.pressStrenth)},e.prototype.onNormal=function(){this.changeColor(1)},e.prototype.onClick=function(){if(this.callback){var t=this.callback();t&&(this.NameLable.string=String(t)||this.NameLable.string)}},i([c(cc.Sprite)],e.prototype,"BgSprite",void 0),i([c(cc.Sprite)],e.prototype,"SideSprite",void 0),i([c(cc.Label)],e.prototype,"NameLable",void 0),i([c(cc.Color)],e.prototype,"MenuItemBgColor",null),i([c(cc.Color)],e.prototype,"MenuItemSideColor",null),i([c({visible:!1})],e.prototype,"BgColor",void 0),i([c({visible:!1})],e.prototype,"SideColor",void 0),i([s],e)}(cc.Component);n.eItem=u,cc._RF.pop()},{}],eList:[function(t,e,n){"use strict";cc._RF.push(e,"07308iMMmFGWa0m3+/sDKOp","eList");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.eList=void 0;var a=cc._decorator,s=a.ccclass,c=a.property,l=new cc.Color,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.TouchArea=null,e.BgSprite=null,e.SideSprite=null,e.NameLable=null,e.ListLabel=null,e.BgColor=new cc.Color(40,40,40,255),e.SideColor=new cc.Color(0,130,180,255),e.pressStrenth=.75,e}return r(e,t),Object.defineProperty(e.prototype,"MenuItemBgColor",{get:function(){return this.BgColor},set:function(t){this.BgColor=t,this.onNormal()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MenuItemSideColor",{get:function(){return this.SideColor},set:function(t){this.SideColor=t,this.onNormal()},enumerable:!1,configurable:!0}),e.prototype.init=function(t,e){this.node.name=t,this.NameLable.string=t,e&&(this.callback=e)},e.prototype.onEnable=function(){this.onNormal(),this.TouchArea.on(cc.Node.EventType.TOUCH_END,this.onClick,this),cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.node.on(cc.Node.EventType.MOUSE_ENTER,this.onPress,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.onNormal,this))},e.prototype.onDisable=function(){this.TouchArea.off(cc.Node.EventType.TOUCH_END,this.onClick,this),cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.node.off(cc.Node.EventType.MOUSE_ENTER,this.onPress,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.onNormal,this))},e.prototype.changeColor=function(t){this.BgSprite.node.color=cc.Color.set(l,this.BgColor.r*t,this.BgColor.g*t,this.BgColor.b*t)},e.prototype.onPress=function(){this.changeColor(this.pressStrenth)},e.prototype.onNormal=function(){this.changeColor(1)},e.prototype.onClick=function(){if(this.callback){var t=this.callback();t&&(this.ListLabel.string=String(t)||this.ListLabel.string)}},i([c(cc.Node)],e.prototype,"TouchArea",void 0),i([c(cc.Sprite)],e.prototype,"BgSprite",void 0),i([c(cc.Sprite)],e.prototype,"SideSprite",void 0),i([c(cc.Label)],e.prototype,"NameLable",void 0),i([c(cc.Label)],e.prototype,"ListLabel",void 0),i([c(cc.Color)],e.prototype,"MenuItemBgColor",null),i([c(cc.Color)],e.prototype,"MenuItemSideColor",null),i([c({visible:!1})],e.prototype,"BgColor",void 0),i([c({visible:!1})],e.prototype,"SideColor",void 0),i([s],e)}(cc.Component);n.eList=u,cc._RF.pop()},{}],eMenu:[function(t,e,n){"use strict";cc._RF.push(e,"85cb9IBtahOTa27eSlpIePB","eMenu");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.eMenu=void 0;var a=t("./eGroup"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.GroupPrefab=null,e._size=new cc.Size(200,30),e._groups=new Map,e._isVisible=!0,e}return r(e,t),Object.defineProperty(e.prototype,"MenuItemSize",{get:function(){return this._size},set:function(t){this._size=t},enumerable:!1,configurable:!0}),e.prototype.addGroup=function(t){var e=cc.instantiate(this.GroupPrefab),n=e.getComponent(a.eGroup);return t&&(n.groupName=t,this._groups.set(t,e)),n.parentComp=this,n.size=this._size,e.parent=this.node,n},e.prototype.getGroup=function(t){return this._groups.get(t)||null},e.prototype.deleteGroup=function(t){var e=this.getGroup(t);e&&(this._groups.delete(t),e.removeFromParent(),e.destroy())},e.prototype.resetSize=function(t){t.setContentSize(this.MenuItemSize)},i([l(cc.Size)],e.prototype,"MenuItemSize",null),i([l(cc.Prefab)],e.prototype,"GroupPrefab",void 0),i([l({visible:!1})],e.prototype,"_size",void 0),i([c],e)}(cc.Component);n.eMenu=u,cc._RF.pop()},{"./eGroup":"eGroup"}],eSlider:[function(t,e,n){"use strict";cc._RF.push(e,"b79efkp/cJCiL0dI9mTYc6U","eSlider");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.eSlider=void 0;var a=cc._decorator,s=a.ccclass,c=a.property,l=new cc.Color,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.BgSprite=null,e.SideSprite=null,e.NameLable=null,e.slider=null,e.editbox=null,e.BgColor=new cc.Color(40,40,40,255),e.SideColor=new cc.Color(0,130,180,255),e.pressStrenth=.75,e._scale=1,e}return r(e,t),Object.defineProperty(e.prototype,"MenuItemBgColor",{get:function(){return this.BgColor},set:function(t){this.BgColor=t,this.onNormal()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MenuItemSideColor",{get:function(){return this.SideColor},set:function(t){this.SideColor=t,this.onNormal()},enumerable:!1,configurable:!0}),e.prototype.init=function(t,e,n){this.node.name=t,this.NameLable.string=t,e&&(this.callback=e),n&&(this._scale=n)},e.prototype.onEnable=function(){this.onNormal(),cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.node.on(cc.Node.EventType.MOUSE_ENTER,this.onPress,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.onNormal,this))},e.prototype.onDisable=function(){cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.node.off(cc.Node.EventType.MOUSE_ENTER,this.onPress,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.onNormal,this))},e.prototype.setProgress=function(t){var e=cc.clamp(Number(t)||0,0,this._scale);this.slider.progress=e/this._scale,this.editbox.string=""+e},e.prototype.onSliderCallback=function(t){var e=t.progress*this._scale;this.editbox.string=""+e,this.callback&&this.callback(e)},e.prototype.onEditDidEnded=function(t){var e=cc.clamp(Number(t.string)||0,0,this._scale);this.callback&&this.callback(e),this.slider.progress=e/this._scale},e.prototype.changeColor=function(t){this.BgSprite.node.color=cc.Color.set(l,this.BgColor.r*t,this.BgColor.g*t,this.BgColor.b*t)},e.prototype.onPress=function(){this.changeColor(this.pressStrenth)},e.prototype.onNormal=function(){this.changeColor(1)},e.prototype.onClick=function(){this.callback&&this.callback(this.slider.progress)},i([c(cc.Sprite)],e.prototype,"BgSprite",void 0),i([c(cc.Sprite)],e.prototype,"SideSprite",void 0),i([c(cc.Label)],e.prototype,"NameLable",void 0),i([c(cc.Slider)],e.prototype,"slider",void 0),i([c(cc.EditBox)],e.prototype,"editbox",void 0),i([c(cc.Color)],e.prototype,"MenuItemBgColor",null),i([c(cc.Color)],e.prototype,"MenuItemSideColor",null),i([c({visible:!1})],e.prototype,"BgColor",void 0),i([c({visible:!1})],e.prototype,"SideColor",void 0),i([s],e)}(cc.Component);n.eSlider=u,cc._RF.pop()},{}],eToggle:[function(t,e,n){"use strict";cc._RF.push(e,"4a275KyfYtI+aBzBrwqJDOW","eToggle");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.eToggle=void 0;var a=cc._decorator,s=a.ccclass,c=a.property,l=new cc.Color,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.BgSprite=null,e.SideSprite=null,e.NameLable=null,e.toggle=null,e.BgColor=new cc.Color(40,40,40,255),e.SideColor=new cc.Color(0,130,180,255),e.pressStrenth=.75,e}return r(e,t),Object.defineProperty(e.prototype,"MenuItemBgColor",{get:function(){return this.BgColor},set:function(t){this.BgColor=t,this.onNormal()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MenuItemSideColor",{get:function(){return this.SideColor},set:function(t){this.SideColor=t,this.onNormal()},enumerable:!1,configurable:!0}),e.prototype.init=function(t,e){this.node.name=t,this.NameLable.string=t,e&&(this.callback=e)},e.prototype.onEnable=function(){this.onNormal(),cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.node.on(cc.Node.EventType.MOUSE_ENTER,this.onPress,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.onNormal,this))},e.prototype.onDisable=function(){cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.node.off(cc.Node.EventType.MOUSE_ENTER,this.onPress,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.onNormal,this))},e.prototype.onToggleCallback=function(t){this.callback&&this.callback(t.isChecked)},e.prototype.changeColor=function(t){this.BgSprite.node.color=cc.Color.set(l,this.BgColor.r*t,this.BgColor.g*t,this.BgColor.b*t)},e.prototype.onPress=function(){this.changeColor(this.pressStrenth)},e.prototype.onNormal=function(){this.changeColor(1)},i([c(cc.Sprite)],e.prototype,"BgSprite",void 0),i([c(cc.Sprite)],e.prototype,"SideSprite",void 0),i([c(cc.Label)],e.prototype,"NameLable",void 0),i([c(cc.Toggle)],e.prototype,"toggle",void 0),i([c(cc.Color)],e.prototype,"MenuItemBgColor",null),i([c(cc.Color)],e.prototype,"MenuItemSideColor",null),i([c({visible:!1})],e.prototype,"BgColor",void 0),i([c({visible:!1})],e.prototype,"SideColor",void 0),i([s],e)}(cc.Component);n.eToggle=u,cc._RF.pop()},{}]},{},["CollisionWrapper","EntityCollector","EntityTag","GuideMask","GameScene","StartScene","Viewport","Terrain","Animator","ButtonEffect","ColorAssembler2D","Drag","FlexLabel","GenCollider","TableView","TableViewInterface","TableViewItem","TableViewLine","BattleView","BusyCircle","BusyView","ConfirmCommonView","HomeWorld","LoadingView","DebugPad","eEdit","eGraph","eGroup","eItem","eList","eMenu","eSlider","eToggle","Profiler","Decorators","VmDataBinding","AchievementStatus","AdType","ClawGuideType","EntryType","ErrorType","GemType","ItemType","SceneType","TagType","ViewMessage","ViewType","WatchAdStatus","Battle","PlayerData","BattleFlow","BattleStats","BattleHelper","EnemyStateMachine","GuardStateMachine","Ability","AvatarEntity","BaseEntity","BattleEntity","BattleProperty","Buff","Bullet","Enemy","EntityManager","Guard","IEntityContext","Player","Game","GameDefine","IBattleContext","AdSystem","BagSystem","BaseSystem","BattleSystem","DataSaver","HomeSystem","ISystem","WeaponSystem","Common","AbilityConfig","BuffConfig","BulletConfig","CardConfig","EnemyConfig","EntryConfig","GemConfig","GuardConfig","LanConfig","LevelConfig","PlayerConfig","StageConfig","TalkConfig","UpgradeConfig","WeaponConfig","AdData","BagData","BattleData","GuideData","HomeData","IBaseData","LocalData","SettingData","UserData","WeaponData","Audio","AutoRelease","ConfigManager","ConfigParser","Db","DbMap","LocalStorage","RemoteStorage","FFComponent","ISerializable","Loader","Loading","CmdClient","Http","NetTest","Network","SDKBridge","StartSceneLoading","Statistics","ViewHandler","ViewModule","ColliderTest","FanTest","GraphicsTest","MoveTest","RotateTest","ScaleTest","AutoDecomposeView","BagCompareView","BagView","GemItem","WeaponItem","BattleEndView","BattleUI","CardInfoNode","CardNode","CollectGuardItem","CollectView","RewardCardNode","ChatNode","CompareView","ConditionView","GemPropView","EnemyItem","GuardItem","HandbookView","HomeBottomUI","HomeTopUI","LineupCardItem","LineupView","PauseEndView","PauseView","RewardCardView","SettingView","ShopView","TalkView","ToastView","UpCard","UpgradeCard","UpgradeView","WarningView","WashEntryView","Action","AppUpdater","CryptoJsMini","ErrorReporter","FrameExecutor","Heap","IDGenerator","NodePool","Path","Platform","PseudoRandom","Queue","ReactProperty","RemoteImgLoader","RetryPolicy","StateMachine","Timer","TweenFX","UniqueView","Utils"]);